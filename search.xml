<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Log</title>
      <link href="/2022/04/26/Log/"/>
      <url>/2022/04/26/Log/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Slf4jæ¥è¾“å‡ºæ—¥å¿—"><a href="#ä½¿ç”¨Slf4jæ¥è¾“å‡ºæ—¥å¿—" class="headerlink" title="ä½¿ç”¨Slf4jæ¥è¾“å‡ºæ—¥å¿—"></a>ä½¿ç”¨Slf4jæ¥è¾“å‡ºæ—¥å¿—</h1><p>å¯¼å…¥ä¾èµ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.18.10&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.7.25&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯springboot å°±ä¸éœ€è¦åœ¨pomæ·»åŠ ä¾èµ–ï¼Œå®ƒé»˜è®¤é›†æˆäº†log4j2å’Œlogbackæ¡†æ¶ã€‚</p><h3 id="logback-xmlæ”¾åœ¨resourceç›®å½•ä¸‹ï¼Œå…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š"><a href="#logback-xmlæ”¾åœ¨resourceç›®å½•ä¸‹ï¼Œå…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š" class="headerlink" title="logback.xmlæ”¾åœ¨resourceç›®å½•ä¸‹ï¼Œå…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š"></a>logback.xmlæ”¾åœ¨resourceç›®å½•ä¸‹ï¼Œå…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!--configurationæ ¹èŠ‚ç‚¹--&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;appender &gt;</span><br><span class="line">        &lt;!--å…¶ä»–é…ç½®çœç•¥--&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;logger&gt;</span><br><span class="line">        &lt;!--å…¶ä»–é…ç½®çœç•¥--&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line">    &lt;root&gt;</span><br><span class="line">        &lt;!--å…¶ä»–é…ç½®çœç•¥--&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><p><strong>appender:</strong> ä¸»è¦è´Ÿè´£æ—¥å¿—ä¿¡æ¯çš„è¾“å‡º(æ‰“å°)å·¥ä½œ<br><strong>logger:</strong> ä¸»è¦è´Ÿè´£æ—¥å¿—ä¿¡æ¯çš„çš„æ¥å—ï¼Œè¿‡æ»¤ä»¥åŠå§”æ‰˜appenderè¿›è¡Œè¾“å‡ºå·¥ä½œ<code>rootä¸ºå…¶çˆ¶ç±»</code><br><strong>root:</strong> ä¸»è¦è´Ÿè´£æ—¥å¿—ä¿¡æ¯çš„çš„æ¥å—ï¼Œè¿‡æ»¤ä»¥åŠå§”æ‰˜appenderè¿›è¡Œè¾“å‡ºå·¥ä½œ<code>loggerä¸ºå…¶å­ç±»</code></p><p>&lt;**cnfiguration**&gt;æ ¹èŠ‚ç‚¹çš„å±æ€§é…ç½®<br><strong>scan</strong>: å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚<br><strong>scanPeriod</strong>: è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚<br><strong>debug</strong>: å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ ${} çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œå°†å˜é‡å¼•å…¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¸­å»ã€‚å¦‚æœæœ‰å¤šå¤„ä½¿ç”¨ç›¸åŒçš„å†…å®¹ï¼Œä¾¿å¯ä½¿ç”¨å±æ€§å˜é‡çš„æ–¹å¼è¿›è¡Œç»Ÿä¸€ï¼Œå‡å°‘å¾ˆå¤šä¸å¿…è¦çš„ä»£ç ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;property name=&quot;pattern&quot; value=&quot;asd&quot; &gt;&lt;/property&gt;</span><br></pre></td></tr></table></figure><p> åœ¨åé¢${name}å¼•ç”¨</p><p>&lt;<strong>appender&gt;å­æ ‡ç­¾çš„å±æ€§é…ç½®</strong><br><strong>name(<code>å¿…è¦</code>)ï¼š</strong>ä¸º<code>&lt;appender&gt;</code>èŠ‚ç‚¹çš„åç§°<br><strong>class(<code>å¿…è¦</code>)ï¼š</strong>ä¸º<code>&lt;appender&gt;</code>çš„å…¨é™å®šç±»åï¼Œä¹Ÿå°±æ˜¯æ—¥å¿—è¾“å‡ºç›®çš„åœ°çš„å¤„ç†ç±»</p><p>&lt;**logger**&gt;å­èŠ‚ç‚¹<br>è¯¦ç»†è§£é‡Šï¼š<br>ç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ã€ä»¥åŠæŒ‡å®šappenderã€‚loggerä»…æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±æ€§ã€‚<br>å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªappender-refå…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªloger</p><p><strong>name</strong>(å¿…è¦): ç”¨æ¥æŒ‡å®šå—æ­¤logerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚<br><strong>level</strong>ï¼ˆå¯é€‰ï¼‰: ç”¨æ¥è®¾ç½®é—¨é™çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERRORè¿˜æœ‰ä¸€ä¸ªç‰¹ä¿—å€¼INHERITEDæˆ–è€…åŒä¹‰è¯NULLï¼Œä»£è¡¨å¼ºåˆ¶æ‰§è¡Œä¸Šçº§çš„çº§åˆ«ã€‚ å¦‚æœæœªè®¾ç½®æ­¤å±æ€§ï¼Œé‚£ä¹ˆå½“å‰logerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚<br><strong>addtivity</strong>: æ˜¯å¦å‘ä¸Šçº§logerä¼ é€’æ‰“å°ä¿¡æ¯ã€‚é»˜è®¤æ˜¯trueã€‚åŒä¸€æ ·ï¼Œå¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªlogerã€‚</p><p>&lt;**root**&gt;å­æ ‡ç­¾ï¼Œå®ƒä¹Ÿæ˜¯logerå…ƒç´ ï¼Œä½†æ˜¯å®ƒæ˜¯æ ¹loger,æ˜¯æ‰€æœ‰logerçš„ä¸Šçº§ã€‚åªæœ‰ä¸€ä¸ªlevelå±æ€§ï¼Œå› ä¸ºnameå·²ç»è¢«å‘½åä¸ºâ€rootâ€,ä¸”å·²ç»æ˜¯æœ€ä¸Šçº§äº†ã€‚</p><p>è¯¦ç»†ä»‹ç»appender æ ‡ç­¾çš„å†…éƒ¨ç»“æ„<br>1.å…³äºæ§åˆ¶å°çš„appenderï¼ˆConsoleAppenderï¼‰</p> <appender name="consoleLog" class="ch.qos.logback.core.ConsoleAppender">        <!--name:ä¸»è¦ç”¨æ¥åŒºåˆ†ä¸åŒçš„appender         class:       æŒ‡å®šè¾“å‡ºï¼ˆæ‰“å°ï¼‰æ—¥å¿—ä¿¡æ¯çš„å…¨é™å®šç±»å         ch.qos.logback.core.ConsoleAppender  //å¯¹åº”æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°çš„appender         -->     <layout class="ch.qos.logback.classic.PatternLayout">      <!--     Layout:  è´Ÿè´£æŠŠäº‹ä»¶è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–çš„æ—¥å¿—ä¿¡æ¯çš„è¾“å‡º(è¿™ç§æ–¹å¼å·²ç»ä¸è¢«å®˜æ–¹æ¨è)     class     :å…¨é™å®šç±»å          -->            <pattern>         <!--          %dè¡¨ç¤ºæ—¥æœŸ,æ ¼å¼ä¸ºï¼šyyyy-MM-dd HH:mm:ss.SSS ;        %msg:æ—¥å¿—æ¶ˆæ¯;        %n:æ¢è¡Œ-->                %d-%msg%n            </pattern>        </layout>    </appender><p>å½“ä½¿ç”¨é»˜è®¤çš„logback.xmlæ—¶ï¼Œè¾“å‡ºæ ¼å¼å¦‚ä¸‹<br>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<br>%d{HH: mm:ss.SSS}â€”â€”æ—¥å¿—è¾“å‡ºæ—¶é—´ %threadâ€”â€”è¾“å‡ºæ—¥å¿—çš„è¿›ç¨‹åå­—ï¼Œè¿™åœ¨Webåº”ç”¨ä»¥åŠå¼‚æ­¥ä»»åŠ¡å¤„ç†ä¸­å¾ˆæœ‰ç”¨ %-5levelâ€”â€”æ—¥å¿—çº§åˆ«ï¼Œå¹¶ä¸”ä½¿ç”¨5ä¸ªå­—ç¬¦é å·¦å¯¹é½ %logger{36}â€”â€”æ—¥å¿—è¾“å‡ºè€…çš„åå­— %msgâ€”â€”æ—¥å¿—æ¶ˆæ¯ %nâ€”â€”å¹³å°çš„æ¢è¡Œç¬¦</p><p>2.æŠŠæ—¥å¿—æ·»åŠ åˆ°æ–‡ä»¶çš„appenderï¼ˆFileAppenderï¼‰</p><p><file>ï¼šè¢«å†™å…¥çš„æ–‡ä»¶åï¼Œå¯ä»¥æ˜¯ç›¸å¯¹ç›®å½•ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹ç›®å½•ï¼Œå¦‚æœä¸Šçº§ç›®å½•ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œæ²¡æœ‰é»˜è®¤å€¼ã€‚<br><append>ï¼šå¦‚æœæ˜¯ trueï¼Œæ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯ falseï¼Œæ¸…ç©ºç°å­˜æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯trueã€‚<br><encoder>ï¼šå¯¹è®°å½•äº‹ä»¶è¿›è¡Œæ ¼å¼åŒ–ã€‚<br><prudent>ï¼šå¦‚æœæ˜¯ trueï¼Œæ—¥å¿—ä¼šè¢«å®‰å…¨çš„å†™å…¥æ–‡ä»¶ï¼Œå³ä½¿å…¶ä»–çš„FileAppenderä¹Ÿåœ¨å‘æ­¤æ–‡ä»¶åšå†™å…¥æ“ä½œï¼Œæ•ˆç‡ä½ï¼Œé»˜è®¤æ˜¯ falseã€‚<br>ä¾‹ï¼š</prudent></encoder></append></file></p><appender name="FILE" class="ch.qos.logback.core.FileAppender"> ã€€ã€€ã€€ã€€<file>testFile.log</file> ã€€ã€€ã€€ã€€<append>true</append> ã€€ã€€ã€€ã€€<encoder> ã€€ã€€ã€€ã€€ã€€ã€€<pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern> ã€€ã€€ã€€ã€€</encoder> ã€€ã€€</appender> <p>3.æ»šåŠ¨è®°å½•æ–‡ä»¶ï¼ˆRollingFileAppenderï¼‰{é¢å¤–æ³¨è§£ï¼šæ»šåŠ¨è®°å½•æ–‡ä»¶ï¼Œå…ˆå°†æ—¥å¿—è®°å½•åˆ°æŒ‡å®šæ–‡ä»¶ï¼Œå½“ç¬¦åˆæŸä¸ªæ¡ä»¶æ—¶ï¼Œå°†æ—¥å¿—è®°å½•åˆ°å…¶ä»–æ–‡ä»¶ã€‚}</p><appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">    <file>e:/log.out</file>    <!--æ—¥å¿—å­˜å‚¨ä½ç½®-->    <append>true</append>     <prudent>false</prudent>    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">    <!--æ—¶é—´æ»šåŠ¨ç­–ç•¥ï¼Œæ¯å¤©ç”Ÿæˆä¸€ä¸ª.logæ–‡ä»¶-->        <fileNamePattern>testLog-%d{yyyy-MM-dd}.log</fileNamePattern>        <!--.logæ–‡ä»¶åç§°è®¾ç½®,ä¾‹ï¼štestLog-2019-7-30.log-->        <maxHistory>30</maxHistory>        <!--è®¾ç½®æœ€å¤§ä¿å­˜æ—¶é—´-->    </rollingPolicy>    <!--ä¸‹é¢è®¾ç½®è¾“å‡ºæ ¼å¼-->    <encoder>        <pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>    </encoder></appender><p><rollingPolicy>æ»šåŠ¨ç­–ç•¥<br>æ—¥å¿—æ–‡ä»¶çš„æ»šåŠ¨ç­–ç•¥ï¼Œä¸RollingFileAppenderæ­é…ä½¿ç”¨ï¼Œå½“æ—¥å¿—æ–‡ä»¶å‘ç”Ÿå˜åŠ¨æ—¶å†³å®šRollingFileAppenderçš„è¡Œä¸ºï¼›</rollingPolicy></p><p>classå±æ€§å–å€¼ï¼šTimeBasedRollingPolicyã€FixedWindowRollingPolicyï¼›</p><p>ç¬¬ä¸€ç§ï¼šTimeBasedRollingPolicy<br>ch.qos.logback.core.rolling.TimeBasedRollingPolicyè¡¨ç¤ºæ ¹æ®æ—¶é—´åˆ¶å®šæ—¥å¿—æ–‡ä»¶çš„æ»šåŠ¨ç­–ç•¥ï¼›</p><p>ä¾‹ï¼š</p><rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">    <fileNamePattern>testLog-%d{yyyy-MM-dd}.log</fileNamePattern>    <!--å¯ä»¥ç›´æ¥æŒ‡å®šæ–‡ä»¶å­˜å‚¨ä½ç½®     ä¾‹ï¼šD:\Documents\Desktop\æ—¥å¿—æ–‡ä»¶å¤¹\info.%d{yyyy-MM-dd}.log   -->    <maxHistory>30</maxHistory>    <!--ä¿å­˜30å¤©--></rollingPolicy><p>ç¬¬äºŒç§ï¼šFixedWindowRollingPolicy<br>ch.qos.logback.core.rolling.FixedWindowRollingPolicyè¡¨ç¤ºå¦‚æœæ—¥å¿—æ–‡ä»¶å¤§å°è¶…è¿‡æŒ‡å®šèŒƒå›´æ—¶ï¼Œä¼šæ ¹æ®æ–‡ä»¶åæ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼›</p><p>ä¾‹ï¼š</p><rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">    <fileNamePattern>tests.%i.log.zip</fileNamePattern>    <!--%iå³æ˜¯ä¸‹æ ‡å€¼ï¼Œä¸‹é¢ä¸¤ä¸ªé…ç½®æŒ‡å®šä¸‹æ ‡èŒƒå›´1~3-->   <minIndex>1</minIndex>    <maxIndex>3</maxIndex>  </rollingPolicy>  <triggeringPolicy>æ—¥å¿—è§¦å‘å™¨ç­–ç•¥ï¼Œå¸¸ç”¨çš„æ˜¯æ—¥å¿—çš„å¤§å°çš„æ§åˆ¶ï¼Œå½“æ—¥å¿—è¾¾åˆ°å¯¹åº”çš„å¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘ã€‚ç”Ÿæˆæ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚æ—¥å¿—å¤§å°çš„æ§åˆ¶é…åˆrollingPlicyä½¿ç”¨çš„æ—¶å€™ï¼Œä¸åŒçš„rollingPolicyä¼šæœ‰æ‰€ä¸åŒã€‚<p>ch.qos.logback.core.rolling.SizeBasedTriggeringPolicyè¡¨ç¤ºæ ¹æ®æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œè¶…è¿‡åˆ¶å®šå¤§å°ä¼šè§¦å‘æ—¥å¿—æ»šåŠ¨ï¼›<br>ä¾‹</p><appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"> ã€€ã€€ã€€ã€€ã€€ã€€<file>test.log</file> <p>ã€€ã€€ã€€ã€€ã€€ã€€<rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy"><br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<fileNamePattern>tests.%i.log.zip</fileNamePattern><br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<minIndex>1</minIndex><br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<maxIndex>3</maxIndex><br>ã€€ã€€ã€€ã€€ã€€ã€€</rollingPolicy> </p><p>ã€€ã€€ã€€ã€€ã€€ã€€<triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"><br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<maxFileSize>5MB</maxFileSize><br>ã€€ã€€ã€€ã€€ã€€ã€€</triggeringPolicy><br>ã€€ã€€ã€€ã€€ã€€ã€€<encoder><br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern><br>ã€€ã€€ã€€ã€€ã€€ã€€</encoder><br>ã€€ã€€ã€€</p></appender> <p></p><p>4.å¼‚æ­¥è®°å½•æ—¥å¿—<br>è¡¥å……ææ–™ï¼š</p><p>å¼‚æ­¥è®°å½•æ—¥å¿—ï¼Œå†…éƒ¨é€šè¿‡ä½¿ç”¨ç¼“å­˜çš„æ–¹å¼æ¥å®ç°å¼‚æ­¥æ‰“å°ï¼Œå°†æ—¥å¿—æ‰“å°äº‹ä»¶eventæ”¾å…¥ç¼“å­˜ä¸­ã€‚å…·ä½“æ•°æ®ç»“æ„ä¸ºBlockingQueueï¼›</p><p>ä¾‹å­ï¼š<br><appender name="FILE" class="ch.qos.logback.core.FileAppender"><br>    <file>e:/log.out</file><br>    <append>true</append><br>    <prudent>false</prudent><br>    <encoder><br>        <pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern><br>    </encoder><br></appender><br><appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender"><br>    <discardingThreshold>0</discardingThreshold><br>    <queueSize>512</queueSize><br>    <appender-ref ref="FILE"><br></appender-ref></appender>  </p><p>å­èŠ‚ç‚¹&lt;**queueSize**&gt;ï¼šæŒ‡çš„æ˜¯BlockingQueueçš„é˜Ÿåˆ—å®¹é‡å¤§å°ï¼Œé»˜è®¤ä¸º256ä¸ªï¼›<br>å­èŠ‚ç‚¹&lt;**discardingThreshold**&gt;ï¼šå¦‚æœBlockingQueueä¸­è¿˜å‰©ä½™20%çš„å®¹é‡ï¼Œé‚£ä¹ˆç¨‹åºä¼šä¸¢å¼ƒTRACEã€DEBUGå’ŒINFOçº§åˆ«çš„æ—¥å¿—æ‰“å°äº‹ä»¶eventï¼Œåªä¿ç•™WARNå’ŒERRORçº§åˆ«çš„ã€‚ä¸ºäº†ä¿ç•™æ‰€æœ‰çš„æ—¥å¿—æ‰“å°äº‹ä»¶ï¼Œå¯ä»¥å°†è¯¥å€¼è®¾ç½®ä¸º0ã€‚</p><p>5.&lt;**encoder**&gt;</p><p>æ—¥å¿—æ ¼å¼åŒ–èŠ‚ç‚¹ï¼Œè´Ÿè´£æ ¼å¼åŒ–æ—¥å¿—ä¿¡æ¯ã€‚åªè´Ÿè´£äº†ä¸¤ä»¶äº‹æƒ…ï¼Œç¬¬ä¸€è´Ÿè´£å°†æ—¥å¿—ä¿¡æ¯è½¬æ¢æˆå­—èŠ‚æ•°ç»„ï¼Œç¬¬äºŒå°†å­—èŠ‚æ•°ç»„å†™åˆ°è¾“å‡ºæµå½“ä¸­å»ï¼›</p><p>%loggerï¼šè¡¨ç¤ºè¾“å‡ºloggeråç§°ï¼Œåé¢è·Ÿä¸€ä¸ª{0}è¡¨ç¤ºï¼šåªè¾“å‡ºloggeræœ€å³è¾¹ç‚¹ç¬¦å·ä¹‹åçš„å­—ç¬¦ä¸²ï¼›ä¾‹å¦‚ï¼šcom.jiaboyan.test â€”&gt; test;</p><p>%d{HH:mm:ss.SSS}ï¼šè¡¨ç¤ºæ ¼å¼åŒ–æ—¥æœŸè¾“å‡ºï¼Œ14:06:49.812ï¼›</p><p>%line:è¾“å‡ºæ‰§è¡Œæ—¥å¿—è¯·æ±‚çš„è¡Œå·ã€‚</p><p>%threadï¼šè¡¨ç¤ºäº§ç”Ÿæ—¥å¿—çš„çº¿ç¨‹åï¼›</p><p>%level:è¾“å‡ºæ—¥å¿—çº§åˆ«ï¼›</p><p>%method:è¾“å‡ºæ‰§è¡Œæ—¥å¿—è¯·æ±‚çš„æ–¹æ³•å;</p><p>%class:è¾“å‡ºæ—¥å¿—æ‰“å°ç±»çš„å…¨é™å®šåï¼Œåé¢è·Ÿ{0}è¡¨ç¤ºï¼Œå«ä¹‰ä¸ºå…¨é™å®šç±»åæœ€å³è¾¹ç‚¹ç¬¦å·ä¹‹åçš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼šcom.jiaboyan.test â€”&gt; test;</p><p>%-4relativeå«ä¹‰ï¼šç¬¦å·å‡å·â€œ-â€æ˜¯å·¦å¯¹é½ æ ‡å¿—ï¼Œæ¥ç€æ˜¯å¯é€‰çš„æœ€å°å®½åº¦ ä¿®é¥°ç¬¦ï¼Œç”¨åè¿›åˆ¶æ•°è¡¨ç¤ºã€‚relativeæ˜¯è¾“å‡ºä»ç¨‹åºå¯åŠ¨åˆ°åˆ›å»ºæ—¥å¿—è®°å½•çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’;</p><p>%msgï¼šè¡¨ç¤ºåº”ç”¨ç¨‹åºæä¾›éœ€è¦æ‰“å°çš„æ—¥å¿—ä¿¡æ¯ï¼›</p><p>%nï¼šè¡¨ç¤ºæ¢è¡Œç¬¦ï¼›</p><h1 id="Spring-Bootä¹‹logging"><a href="#Spring-Bootä¹‹logging" class="headerlink" title="Spring Bootä¹‹logging"></a>Spring Bootä¹‹logging</h1><p>SpringBootå†…éƒ¨ä½¿ç”¨Commons Loggingä½œä¸ºæ—¥å¿—è®°å½•é—¨é¢ï¼Œä½†æ˜¯å½“ä½¿ç”¨SpringBootåœºæ™¯å¯åŠ¨å™¨æ—¶é»˜è®¤æ˜¯ä½¿ç”¨çš„<a href="https://blog.csdn.net/xintonghanchuang/article/details/91348467">SLF4J</a>+<a href="https://blog.csdn.net/xintonghanchuang/article/details/91348257">Logback</a>è¿›è¡Œæ—¥å¿—è®°å½•ã€‚ä¸Šæ–‡å°±æ˜¯æ‰‹å†™ï¼Œè¿™é‡Œæ˜¯Springä»£åŠ³ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹å…¶æºç è‡ªå®šä¹‰æ•ˆæœ</p><p>spring-boot-starter-loggingï¼Œä½†SpringBootä¸­æ‰€æœ‰starteréƒ½ç»§æ‰¿äº†spring-boot-startersï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªSpringBooté¡¹ç›®å°±è‡ªå¸¦loggingï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚</p><p>ç›´æ¥åœ¨é…ç½®æ–‡ä»¶é…ç½®æ—¥å¿—ç›¸å…³çš„å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">logging:</span><br><span class="line">  level:</span><br><span class="line">    root: info //é…ç½®æ ¹ç›®å½•æ—¥å¿—è¾“å‡ºçº§åˆ«</span><br><span class="line">  file:</span><br><span class="line">    name: service.log   //æŒ‡å®šç”Ÿæˆçš„æ—¥å¿—æ–‡ä»¶å</span><br><span class="line">  logback:</span><br><span class="line">    rollingpolicy:</span><br><span class="line">      file-name-pattern: service.%d.%i.log</span><br><span class="line">      max-file-size: 4KB</span><br></pre></td></tr></table></figure></triggeringPolicy>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>essays</title>
      <link href="/2022/04/22/essays/"/>
      <url>/2022/04/22/essays/</url>
      
        <content type="html"><![CDATA[<h1 id="éšä¾¿å†™å†™çš„çŸ¥è¯†ç‚¹"><a href="#éšä¾¿å†™å†™çš„çŸ¥è¯†ç‚¹" class="headerlink" title="éšä¾¿å†™å†™çš„çŸ¥è¯†ç‚¹"></a>éšä¾¿å†™å†™çš„çŸ¥è¯†ç‚¹</h1><h1 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h1><p>æ³¨ï¼šswaggeræ˜¯ä¸€ç§APIè§„èŒƒï¼Œspringfoxæ˜¯å…¶è§„èŒƒçš„ä¸€ç§å®ç°ï¼Œè¦æ³¨æ„Spring bootç‰ˆæœ¬å’Œswagger-spring-boot-starterç‰ˆæœ¬çš„å…¼å®¹</p><h3 id="1-å¼•å…¥swaggerä¾èµ–"><a href="#1-å¼•å…¥swaggerä¾èµ–" class="headerlink" title="1.å¼•å…¥swaggerä¾èµ–"></a>1.å¼•å…¥swaggerä¾èµ–</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.spring4all&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;swagger-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.9.0.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.9.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p><code>swagger-spring-boot-starter</code> æ˜¯ä¸€æ¬¾å»ºç«‹åœ¨<code>swagger</code>åŸºç¡€ä¹‹ä¸Šçš„å·¥å…·åŒ…ï¼Œåˆ©ç”¨SpringBootè‡ªåŠ¨è£…é…çš„ç‰¹æ€§ï¼Œç®€åŒ–äº†ä¼ ç»Ÿ<code>swagger</code>çš„ç¹çé…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.spring4all&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;swagger-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.9.0.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="2-ç¼–å†™é…ç½®ç±»"><a href="#2-ç¼–å†™é…ç½®ç±»" class="headerlink" title="2.ç¼–å†™é…ç½®ç±»"></a>2.ç¼–å†™é…ç½®ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">api</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()   .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.åŒ…å.controller&quot;</span>)) </span><br><span class="line">            <span class="comment">//æ‰«æç”ŸæˆAPIçš„ControlleråŒ…åï¼Œå°†ä¼šä¸ºè¯¥åŒ…ä¸‹çš„controllerç”Ÿæˆç›¸å…³æ–‡æ¡£</span></span><br><span class="line">                .paths(PathSelectors.any())  <span class="comment">//å…è®¸æ‚¨æ ¹æ®è·¯å¾„æ˜ å°„å®šä¹‰åº”åŒ…å«å“ªä¸ªæ§åˆ¶å™¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬ç°åœ¨åŒ…æ‹¬æ‰€æœ‰è¿™äº›ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç­‰é™åˆ¶å®ƒã€‚</span></span><br><span class="line">                                             <span class="comment">// ä¸Šé¢çš„ä»£ç .paths(PathSelectors.any())æ˜¯ä»£è¡¨åŒ¹é…æ‰€æœ‰URL</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> ApiInfo <span class="title function_">apiInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class="line">                .title(<span class="string">&quot;ç³»çµ±APIæ–‡æ¡£&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;ä¼—æ‰€å‘¨çŸ¥çš„APIæ–‡æ¡£&quot;</span>)</span><br><span class="line">                .termsOfServiceUrl(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                .contact(<span class="string">&quot;zzw&quot;</span>)</span><br><span class="line">                .version(<span class="string">&quot;2.0&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-ç¼–å†™apiæ³¨è§£"><a href="#3-ç¼–å†™apiæ³¨è§£" class="headerlink" title="3.ç¼–å†™apiæ³¨è§£"></a>3.ç¼–å†™apiæ³¨è§£</h3><p>åŠ åœ¨ç±»ä¸Š<br> **@ApiModel(tags = â€œè¯´æ˜è¯¥ç±»çš„ä½œç”¨ï¼Œå¯ä»¥åœ¨UIç•Œé¢ä¸Šçœ‹åˆ°çš„æ³¨è§£â€)**ç”¨äºç±» ï¼›è¡¨ç¤ºå¯¹ç±»è¿›è¡Œè¯´æ˜ï¼Œç”¨äºå‚æ•°ç”¨å®ä½“ç±»æ¥æ”¶ è¿™ä¸ªç±»æ˜¯swaggerçš„èµ„æº<br> åŠ åœ¨æ–¹æ³•ä¸Š<br> **@ApiModel(value = â€œæ–¹æ³•æè¿°â€,notes = â€œæç¤ºå†…å®¹â€)**ç”¨äºç±» ï¼›è¡¨ç¤ºå¯¹ç±»è¿›è¡Œè¯´æ˜ï¼Œç”¨äºå‚æ•°ç”¨å®ä½“ç±»æ¥æ”¶()   è¡¨ç¤ºä¸€ä¸ªhttpè¯·æ±‚çš„æ“ä½œ<br> **@ApiModel(name = â€œå‚æ•°åâ€,value = â€œå‚æ•°è¯´æ˜â€,required = true)**ç”¨äºç±» ï¼›è¡¨ç¤ºå¯¹ç±»è¿›è¡Œè¯´æ˜ï¼Œç”¨äºå‚æ•°ç”¨å®ä½“ç±»æ¥æ”¶</p><p>å½“æœ‰å¤šä¸ªå‚æ•°æ—¶ç”¨@ApiImplicitParams</p><p>å½“å‚æ•°æ˜¯ä¸ªå¯¹è±¡æ—¶ï¼Œå‚æ•°å‰åŠ å…¥ï¼Œ@RequestBodyï¼Œè¿™æ ·æ‰èƒ½å°†å¯¹è±¡çš„å±æ€§ç»™åˆ°swagger</p><p>**@ApiModel(value=â€å¯¹è±¡åâ€ï¼Œdescription=â€æè¿°â€)**ç”¨äºç±» ï¼›è¡¨ç¤ºå¯¹ç±»è¿›è¡Œè¯´æ˜ï¼Œç”¨äºå‚æ•°ç”¨å®ä½“ç±»æ¥æ”¶</p><p>è®¿é—®è·¯å¾„ï¼šåº”ç”¨åœ°å€+ç«¯å£+swagger-ui.html ä¾‹å¦‚<a href="http://localhost:8800/swagger-ui.html">http://localhost:8800/swagger-ui.html</a></p><h4 id="4-éƒ¨åˆ†æŠ¥é”™"><a href="#4-éƒ¨åˆ†æŠ¥é”™" class="headerlink" title="4.éƒ¨åˆ†æŠ¥é”™"></a>4.éƒ¨åˆ†æŠ¥é”™</h4><p>æŠ¥é”™ï¼š<strong>Failed to start bean â€˜documentationPluginsBootstrapperâ€™</strong></p><p>springbootçš„ç‰ˆæœ¬æ›´æ–°ï¼Œå¯¼è‡´çš„swagger2çš„å¼‚å¸¸</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  mvc:</span><br><span class="line">    pathch:</span><br><span class="line">      matching-strategy: ant_path_matcher</span><br></pre></td></tr></table></figure><p>springboot2.6.0ä¸­å°†SpringMVC é»˜è®¤è·¯å¾„åŒ¹é…ç­–ç•¥ä»AntPathMatcher æ›´æ”¹ä¸ºPathPatternParserï¼Œå¯¼è‡´å‡ºé”™ï¼Œè§£å†³åŠæ³•æ˜¯åˆ‡æ¢å›åŸå…ˆçš„AntPathMatcher</p><h1 id="run-å’Œstart-çš„åŒºåˆ«"><a href="#run-å’Œstart-çš„åŒºåˆ«" class="headerlink" title="run()å’Œstart()çš„åŒºåˆ«"></a>run()å’Œstart()çš„åŒºåˆ«</h1><p>start()æ–¹æ³•ï¼š</p><p>é€šè¿‡è¯¥æ–¹æ³•å¯åŠ¨çº¿ç¨‹çš„åŒæ—¶ä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹ã€‚æ— éœ€ç­‰å¾…run()æ–¹æ³•ä¸­çš„ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå°±å¯ä»¥æ¥ç€æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚æ­¤æ—¶start()çš„è¿™ä¸ªçº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå½“å¾—åˆ°CPUçš„æ—¶é—´ç‰‡åå°±ä¼šæ‰§è¡Œå…¶ä¸­çš„run()æ–¹æ³•ã€‚è¿™ä¸ªrun()æ–¹æ³•åŒ…å«äº†è¦æ‰§è¡Œçš„è¿™ä¸ªçº¿ç¨‹çš„å†…å®¹ï¼Œrun()æ–¹æ³•è¿è¡Œç»“æŸï¼Œæ­¤çº¿ç¨‹ä¹Ÿå°±ç»ˆæ­¢äº†ã€‚</p><p>run()æ–¹æ³•ï¼š</p><p>é€šè¿‡runæ–¹æ³•å¯åŠ¨çº¿ç¨‹å…¶å®å°±æ˜¯è°ƒç”¨ä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•ï¼Œå½“ä½œæ™®é€šçš„æ–¹æ³•çš„æ–¹å¼è°ƒç”¨ã€‚å¹¶æ²¡æœ‰åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç¨‹åºä¸­ä¾æ—§åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œå¿…é¡»ç­‰åˆ°run()æ–¹æ³•é‡Œé¢çš„ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œè¿™æ ·å°±æ²¡æœ‰è¾¾åˆ°å†™çº¿ç¨‹çš„ç›®çš„ã€‚<br>è€Œrunæ–¹æ³•æ˜¯ä¸šåŠ¡é€»è¾‘å®ç°çš„åœ°æ–¹ï¼Œæœ¬è´¨ä¸Šå’Œä»»æ„ä¸€ä¸ªç±»çš„ä»»æ„ä¸€ä¸ªæˆå‘˜æ–¹æ³•å¹¶æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå¯ä»¥é‡å¤æ‰§è¡Œ,è¢«ä¸€ä¸ªçº¿ç¨‹åå¤è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¢«å•ç‹¬è°ƒç”¨</p><p>start()æ–¹æ³•è¢«ç”¨æ¥å¯åŠ¨æ–°åˆ›å»ºçš„çº¿ç¨‹ï¼Œè€Œä¸”start()å†…éƒ¨è°ƒç”¨äº†run()æ–¹æ³•ï¼Œè¿™å’Œç›´æ¥è°ƒç”¨run()æ–¹æ³•çš„æ•ˆæœä¸ä¸€æ ·ã€‚å½“ä½ è°ƒç”¨run()æ–¹æ³•çš„æ—¶å€™ï¼Œåªä¼šæ˜¯åœ¨åŸæ¥çš„çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œæ²¡æœ‰æ–°çš„çº¿ç¨‹å¯åŠ¨ï¼Œstart()æ–¹æ³•æ‰ä¼šå¯åŠ¨æ–°çº¿ç¨‹ã€‚</p><h3 id="åŒºåˆ«ï¼š"><a href="#åŒºåˆ«ï¼š" class="headerlink" title="åŒºåˆ«ï¼š"></a>åŒºåˆ«ï¼š</h3><ul><li>start() å¯ä»¥å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œrun()ä¸èƒ½</li><li>start()ä¸èƒ½è¢«é‡å¤è°ƒç”¨ï¼Œrun()å¯ä»¥</li><li>start()ä¸­çš„runä»£ç å¯ä»¥ä¸æ‰§è¡Œå®Œå°±ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå³è¿›è¡Œäº†çº¿ç¨‹åˆ‡æ¢ã€‚ç›´æ¥è°ƒç”¨runæ–¹æ³•å¿…é¡»ç­‰å¾…å…¶ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚</li><li>start() å®ç°äº†å¤šçº¿ç¨‹ï¼Œrun()æ²¡æœ‰å®ç°å¤šçº¿ç¨‹ã€‚</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux</title>
      <link href="/2022/04/14/Linux/"/>
      <url>/2022/04/14/Linux/</url>
      
        <content type="html"><![CDATA[<p>ğŸ§ç”»å¾—ä¸å¤Ÿå½¢è±¡ï¼Œè«å¾—çµé­‚</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/u=1090189516,820941418&fm=253&fmt=auto&app=138&f=JPEG.webp"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>regularExpressions</title>
      <link href="/2022/04/13/regularExpressions/"/>
      <url>/2022/04/13/regularExpressions/</url>
      
        <content type="html"><![CDATA[<h1 id="å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼"><a href="#å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼"></a>å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼</h1><ul><li>éªŒè¯å¯†ç é•¿åº¦ï¼š\d{6,18}$</li><li>éªŒè¯å¯†ç ä¸èƒ½ä½¿ç”¨çº¯å­—æ¯æˆ–æ•°å­—ï¼š[A-Za-z]+[0-9]</li><li>éªŒè¯8åˆ°16ä½ã€å¿…é¡»æœ‰å°å†™å­—æ¯+å¤§å†™å­—æ¯+ç‰¹æ®Šå­—ç¬¦+æ•°å­—ç»„æˆçš„å¯†ç ï¼š(?=^.{8,16}$)(?=.<em>\d)(?=.<em>\W+)(?=.</em>[a-z])(?=.</em>[A-Z])(?!.<em>\n).</em>$</li><li>éªŒè¯ç”±æ•°å­—ã€26ä¸ªè‹±æ–‡å­—æ¯æˆ–ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^\w+$</li><li>éªŒè¯é‚®ç¼–ï¼š[1-9]\d{5}</li><li>éªŒè¯ç”µè¯å·ç ï¼š(\d{3,4}-)?\d{6,8}$</li><li>éªŒè¯æ‰‹æœºå·ï¼š[1][3-5]\d{9}$</li><li>éªŒè¯èº«ä»½è¯å·ï¼š(\d{18}$)|(^\d{15}$)</li><li>éªŒè¯ä¸€å¹´çš„12ä¸ªæœˆä»½ï¼š(0?[[1-9]|1[0-2]]$</li><li>éªŒè¯ä¸€ä¸ªæœˆçš„31å¤©ï¼š((0?[1-9])|((1|2)[0-9])|30|31)$</li><li>éªŒè¯æ—¥æœŸï¼ˆyyyy-mm-ddï¼‰ï¼š^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$</li><li>éªŒè¯æ—¥æœŸ(å¹´-æœˆ-æ—¥)ï¼š(\d{4}|\d{2})-((1[0-2])|(0?[1-9]))-(([12][0-9])|(3[01])|(0?[1-9]))</li><li>éªŒè¯æ—¥æœŸ(æœˆ/æ—¥/å¹´) ï¼š[1-9]))/(([12][0-9])|(3[01])|(0?[1-9]))/(\d{4}|\d{2})</li><li>éªŒè¯æ—¶é—´(å°æ—¶:åˆ†é’Ÿ, 24å°æ—¶åˆ¶)ï¼š((1|0?)[0-9]|2[0-3]):([0-5][0-9])</li><li>éªŒè¯æ•°å­—è¾“å…¥ï¼š [0-9]*$</li><li>éªŒè¯éé›¶çš„æ­£æ•´æ•°ï¼š+?[1-9][0-9]*$</li><li>éªŒè¯éé›¶çš„è´Ÿæ•´æ•°ï¼š-[1-9][0-9]*$</li><li>éªŒè¯å°æ•°ï¼š(-?\d+)(.\d+)?</li><li>éªŒè¯ä¸¤ä½å°æ•°ï¼š[0-9]+.[0-9]{2}$</li><li>éªŒè¯é‡‘é¢ï¼ˆç²¾ç¡®åˆ°2ä½å°æ•°ï¼‰ï¼š^[0-9]+(.[0-9]{2})?$</li><li>éªŒè¯å¤§å†™å­—æ¯ï¼š[A-Z]+$</li><li>éªŒè¯å°å†™å­—æ¯ï¼š[a-z]+$</li><li>éªŒè¯å­—æ¯ï¼š[A-Za-z]+$</li><li>éªŒè¯ä¸­æ–‡æ±‰å­—ï¼š^[\u4e00-\u9fa5]{0,}$</li><li>éªŒè¯E-mailï¼š[\w!#$%&amp;â€™<em>+/=?^_<code>&#123;|&#125;~-]+(?:\\.[\\w!#$%&amp;&#39;*+/=?^_</code>{|}~-]+)</em>@(?:<a href="?:%5B%5Cw-%5D*%5B%5Cw%5D">\w</a>?\.)+<a href="?:%5B%5Cw-%5D*%5B%5Cw%5D">\w</a>?</li><li>éªŒè¯IPåœ°å€ï¼š((2[0-4]\d|25[0-5]|[01]?\d\d?).){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)</li><li>éªŒè¯URLï¼šhttp(s)?://([\w-]+.)+[\w-]+(/[\w- ./?%&amp;=]*)?</li><li>éªŒè¯QQå·ç ï¼š[1-9]\d{4,}</li><li>åŒ¹é…HTMLæ ‡ç­¾ï¼š&lt;\/?\w+((\s+\w+(\s*=\s*(?:â€.<em>?â€|â€™.*?â€™|[\^â€™â€&gt;\s]+))?)+\s</em>|\s*)\/?&gt;</li><li>æŸ¥æ‰¾CSSå±æ€§ï¼š^\s*[a-zA-Z\-]+\s*[:]{1}\s[a-zA-Z0-9\s.#]+[;]{1}</li><li>æå–é¡µé¢è¶…é“¾æ¥ï¼š(\s*(?!.<em>\brel=)[^&gt;]</em>)(href=â€https?:\/\/)((?!(?:(?:www\.)?â€™.implode(â€˜|(?:www\.)?â€™, $follow_list).â€™))[^â€]+)â€((?!.<em>\brel=)[^&gt;]</em>)(?:[^&gt;]*)&gt;</li><li>æå–ç½‘é¡µå›¾ç‰‡ï¼š\&lt; <em>[img][^\&gt;]</em>[src] *= <em>[\â€œ\â€˜]{0,1}([^\â€œ\â€˜\ &gt;]</em>)</li><li>æå–URLé“¾æ¥ï¼š^(f|ht){1}(tp|tps):\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&amp;=]*)?</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Centos7 å®‰è£…docker</title>
      <link href="/2022/04/08/Centos7InstallDocker/"/>
      <url>/2022/04/08/Centos7InstallDocker/</url>
      
        <content type="html"><![CDATA[<h1 id="0-å®‰è£…Docker"><a href="#0-å®‰è£…Docker" class="headerlink" title="0.å®‰è£…Docker"></a>0.å®‰è£…Docker</h1><p>Docker åˆ†ä¸º CE å’Œ EE ä¸¤å¤§ç‰ˆæœ¬ã€‚CE å³ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼Œæ”¯æŒå‘¨æœŸ 7 ä¸ªæœˆï¼‰ï¼ŒEE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ï¼Œæ”¯æŒå‘¨æœŸ 24 ä¸ªæœˆã€‚</p><p>Docker CE åˆ†ä¸º <code>stable</code> <code>test</code> å’Œ <code>nightly</code> ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚</p><p>å®˜æ–¹ç½‘ç«™ä¸Šæœ‰å„ç§ç¯å¢ƒä¸‹çš„ <a href="https://docs.docker.com/install/">å®‰è£…æŒ‡å—</a>ï¼Œè¿™é‡Œä¸»è¦ä»‹ç» Docker CE åœ¨ CentOSä¸Šçš„å®‰è£…ã€‚</p><h1 id="1-CentOSå®‰è£…Docker"><a href="#1-CentOSå®‰è£…Docker" class="headerlink" title="1.CentOSå®‰è£…Docker"></a>1.CentOSå®‰è£…Docker</h1><p>Docker CE æ”¯æŒ 64 ä½ç‰ˆæœ¬ CentOS 7ï¼Œå¹¶ä¸”è¦æ±‚å†…æ ¸ç‰ˆæœ¬ä¸ä½äº 3.10ï¼Œ CentOS 7 æ»¡è¶³æœ€ä½å†…æ ¸çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨CentOS 7å®‰è£…Dockerã€‚</p><h2 id="1-1-å¸è½½ï¼ˆå¯é€‰ï¼‰"><a href="#1-1-å¸è½½ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="1.1.å¸è½½ï¼ˆå¯é€‰ï¼‰"></a>1.1.å¸è½½ï¼ˆå¯é€‰ï¼‰</h2><p>å¦‚æœä¹‹å‰å®‰è£…è¿‡æ—§ç‰ˆæœ¬çš„Dockerï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¸è½½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-selinux \</span><br><span class="line">                  docker-engine-selinux \</span><br><span class="line">                  docker-engine \</span><br><span class="line">                  docker-ce</span><br></pre></td></tr></table></figure><h2 id="1-2-å®‰è£…docker"><a href="#1-2-å®‰è£…docker" class="headerlink" title="1.2.å®‰è£…docker"></a>1.2.å®‰è£…docker</h2><p>é¦–å…ˆéœ€è¦å¤§å®¶è™šæ‹Ÿæœºè”ç½‘ï¼Œå®‰è£…yumå·¥å…·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils \</span><br><span class="line">           device-mapper-persistent-data \</span><br><span class="line">           lvm2 --skip-broken</span><br></pre></td></tr></table></figure><p>ç„¶åæ›´æ–°æœ¬åœ°é•œåƒæºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">è®¾ç½®dockeré•œåƒæº</span></span><br><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">    </span><br><span class="line">sed -i &#x27;s/download.docker.com/mirrors.aliyun.com\/docker-ce/g&#x27; /etc/yum.repos.d/docker-ce.repo</span><br><span class="line"></span><br><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure><p>ç„¶åè¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker-ce</span><br></pre></td></tr></table></figure><p>docker-ceä¸ºç¤¾åŒºå…è´¹ç‰ˆæœ¬ã€‚ç¨ç­‰ç‰‡åˆ»ï¼Œdockerå³å¯å®‰è£…æˆåŠŸã€‚</p><h2 id="1-3-å¯åŠ¨docker"><a href="#1-3-å¯åŠ¨docker" class="headerlink" title="1.3.å¯åŠ¨docker"></a>1.3.å¯åŠ¨docker</h2><p>Dockeråº”ç”¨éœ€è¦ç”¨åˆ°å„ç§ç«¯å£ï¼Œé€ä¸€å»ä¿®æ”¹é˜²ç«å¢™è®¾ç½®ã€‚éå¸¸éº»çƒ¦ï¼Œå› æ­¤å»ºè®®å¤§å®¶ç›´æ¥å…³é—­é˜²ç«å¢™ï¼</p><p>å¯åŠ¨dockerå‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼</p><p>å¯åŠ¨dockerå‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼</p><p>å¯åŠ¨dockerå‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="comment"># ç¦æ­¢å¼€æœºå¯åŠ¨é˜²ç«å¢™</span></span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‘½ä»¤å¯åŠ¨dockerï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker  <span class="comment"># å¯åŠ¨dockeræœåŠ¡</span></span><br><span class="line"></span><br><span class="line">systemctl stop docker  <span class="comment"># åœæ­¢dockeræœåŠ¡</span></span><br><span class="line"></span><br><span class="line">systemctl restart docker  <span class="comment"># é‡å¯dockeræœåŠ¡</span></span><br></pre></td></tr></table></figure><p>ç„¶åè¾“å…¥å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹dockerç‰ˆæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker -v</span><br></pre></td></tr></table></figure><h2 id="1-4-é…ç½®é•œåƒåŠ é€Ÿ"><a href="#1-4-é…ç½®é•œåƒåŠ é€Ÿ" class="headerlink" title="1.4.é…ç½®é•œåƒåŠ é€Ÿ"></a>1.4.é…ç½®é•œåƒåŠ é€Ÿ</h2><p>dockerå®˜æ–¹é•œåƒä»“åº“ç½‘é€Ÿè¾ƒå·®ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®å›½å†…é•œåƒæœåŠ¡ï¼š</p><p>å‚è€ƒé˜¿é‡Œäº‘çš„é•œåƒåŠ é€Ÿæ–‡æ¡£ï¼š<a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><h1 id="2-CentOS7å®‰è£…DockerCompose"><a href="#2-CentOS7å®‰è£…DockerCompose" class="headerlink" title="2.CentOS7å®‰è£…DockerCompose"></a>2.CentOS7å®‰è£…DockerCompose</h1><h2 id="2-1-ä¸‹è½½"><a href="#2-1-ä¸‹è½½" class="headerlink" title="2.1.ä¸‹è½½"></a>2.1.ä¸‹è½½</h2><p>Linuxä¸‹éœ€è¦é€šè¿‡å‘½ä»¤ä¸‹è½½ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">curl -L https://get.daocloud.io/docker/compose/releases/download/1.8.0/run.sh &gt; /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><h2 id="2-2-ä¿®æ”¹æ–‡ä»¶æƒé™"><a href="#2-2-ä¿®æ”¹æ–‡ä»¶æƒé™" class="headerlink" title="2.2.ä¿®æ”¹æ–‡ä»¶æƒé™"></a>2.2.ä¿®æ”¹æ–‡ä»¶æƒé™</h2><p>ä¿®æ”¹æ–‡ä»¶æƒé™ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹æƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><h2 id="2-3-Baseè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š"><a href="#2-3-Baseè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š" class="headerlink" title="2.3.Baseè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š"></a>2.3.Baseè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¡¥å…¨å‘½ä»¤</span></span><br><span class="line">curl -L https://raw.githubusercontent.com/docker/compose/1.29.1/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™é‡Œå‡ºç°é”™è¯¯ï¼Œéœ€è¦ä¿®æ”¹è‡ªå·±çš„hostsæ–‡ä»¶ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;199.232.68.133 raw.githubusercontent.com&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><h1 id="3-Dockeré•œåƒä»“åº“"><a href="#3-Dockeré•œåƒä»“åº“" class="headerlink" title="3.Dockeré•œåƒä»“åº“"></a>3.Dockeré•œåƒä»“åº“</h1><p>æ­å»ºé•œåƒä»“åº“å¯ä»¥åŸºäºDockerå®˜æ–¹æä¾›çš„DockerRegistryæ¥å®ç°ã€‚</p><p>å®˜ç½‘åœ°å€ï¼š<a href="https://hub.docker.com/_/registry">https://hub.docker.com/_/registry</a></p><h2 id="3-1-ç®€åŒ–ç‰ˆé•œåƒä»“åº“"><a href="#3-1-ç®€åŒ–ç‰ˆé•œåƒä»“åº“" class="headerlink" title="3.1.ç®€åŒ–ç‰ˆé•œåƒä»“åº“"></a>3.1.ç®€åŒ–ç‰ˆé•œåƒä»“åº“</h2><p>Dockerå®˜æ–¹çš„Docker Registryæ˜¯ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬çš„Dockeré•œåƒä»“åº“ï¼Œå…·å¤‡ä»“åº“ç®¡ç†çš„å®Œæ•´åŠŸèƒ½ï¼Œä½†æ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢ã€‚</p><p>æ­å»ºæ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">    --restart=always \</span><br><span class="line">    --name registry\</span><br><span class="line">    -p 5000:5000 \</span><br><span class="line">    -v registry-data:/var/lib/registry \</span><br><span class="line">    registry</span><br></pre></td></tr></table></figure><p>å‘½ä»¤ä¸­æŒ‚è½½äº†ä¸€ä¸ªæ•°æ®å·registry-dataåˆ°å®¹å™¨å†…çš„/var/lib/registry ç›®å½•ï¼Œè¿™æ˜¯ç§æœ‰é•œåƒåº“å­˜æ”¾æ•°æ®çš„ç›®å½•ã€‚</p><p>è®¿é—®<a href="http://yourip:5000/v2/_catalog">http://YourIp:5000/v2/_catalog</a> å¯ä»¥æŸ¥çœ‹å½“å‰ç§æœ‰é•œåƒæœåŠ¡ä¸­åŒ…å«çš„é•œåƒ</p><h2 id="3-2-å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬"><a href="#3-2-å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬" class="headerlink" title="3.2.å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬"></a>3.2.å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬</h2><p>ä½¿ç”¨DockerComposeéƒ¨ç½²å¸¦æœ‰å›¾è±¡ç•Œé¢çš„DockerRegistryï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.0&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./registry-data:/var/lib/registry</span></span><br><span class="line">  <span class="attr">ui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">joxit/docker-registry-ui:static</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_TITLE=ä¼ æ™ºæ•™è‚²ç§æœ‰ä»“åº“</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_URL=http://registry:5000</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">registry</span></span><br></pre></td></tr></table></figure><h2 id="3-3-é…ç½®Dockerä¿¡ä»»åœ°å€"><a href="#3-3-é…ç½®Dockerä¿¡ä»»åœ°å€" class="headerlink" title="3.3.é…ç½®Dockerä¿¡ä»»åœ°å€"></a>3.3.é…ç½®Dockerä¿¡ä»»åœ°å€</h2><p>æˆ‘ä»¬çš„ç§æœé‡‡ç”¨çš„æ˜¯httpåè®®ï¼Œé»˜è®¤ä¸è¢«Dockerä¿¡ä»»ï¼Œæ‰€ä»¥éœ€è¦åšä¸€ä¸ªé…ç½®ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€è¦ä¿®æ”¹çš„æ–‡ä»¶</span></span><br><span class="line">vi /etc/docker/daemon.json</span><br><span class="line"><span class="comment"># æ·»åŠ å†…å®¹ï¼š</span></span><br><span class="line"><span class="string">&quot;insecure-registries&quot;</span>:[<span class="string">&quot;http://192.168.150.101:8080&quot;</span>]</span><br><span class="line"><span class="comment"># é‡åŠ è½½</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="comment"># é‡å¯docker</span></span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>docker</title>
      <link href="/2022/04/08/docker/"/>
      <url>/2022/04/08/docker/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»€ä¹ˆæ˜¯Dockerï¼Œç”¨å®ƒæ¥å¹²å˜›ï¼Œä¸ºä»€ä¹ˆè¦ç”¨å®ƒç­‰åŸºç¡€ä»‹ç»è½¬è½½è‡ªé˜®ä¸€å³°å¤§ä½¬çš„æ–‡ç« <a href="https://ruanyifeng.com/blog/2018/02/docker-tutorial.html">Docker å…¥é—¨æ•™ç¨‹</a></p><p>dockerçš„å®‰è£…å‚è€ƒ <a href="https://deimos.magi-verse.com/2022/04/08/Centos7InstallDocker/">Centos7ä¸‹å®‰è£…docker</a></p><h1 id="Dockerçš„ä½¿ç”¨"><a href="#Dockerçš„ä½¿ç”¨" class="headerlink" title="Dockerçš„ä½¿ç”¨"></a>Dockerçš„ä½¿ç”¨</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker  # å¯åŠ¨dockeræœåŠ¡</span><br><span class="line">systemctl stop docker  # åœæ­¢dockeræœåŠ¡</span><br><span class="line">systemctl restart docker  # é‡å¯dockeræœåŠ¡</span><br></pre></td></tr></table></figure><p>é•œåƒåç§°:[repository]:[tag]     e.g: mysql:5.7</p><p>é•œåƒç›¸å…³å‘½ä»¤ï¼š e.g: docker pull redis ï¼Œdocker rmi redis</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220411190306000.png" alt="image-20220411190306000"></p><p>å®¹å™¨ç›¸å…³å‘½ä»¤ï¼ˆåŸºæœ¬éƒ½æ˜¯æœ›æ–‡ç”Ÿä¹‰ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run  å®¹å™¨å  #åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªå®¹å™¨</span><br><span class="line">docker pause å®¹å™¨å/unpause å®¹å™¨å</span><br><span class="line">docker stop  å®¹å™¨å/start å®¹å™¨å</span><br><span class="line">docker rm å®¹å™¨å</span><br><span class="line">docker logs å®¹å™¨å -f(è·Ÿè¸ªæ—¥å¿—è¾“å‡º)</span><br><span class="line">docker ps #æŸ¥çœ‹æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨åŠçŠ¶æ€ -a(æŸ¥çœ‹å…¨éƒ¨å®¹å™¨)</span><br><span class="line">docker exec #è¿›å…¥å®¹å™¨æ‰§è¡Œå‘½ä»¤</span><br></pre></td></tr></table></figure><h1 id="å®¹å™¨è¿è¡Œ"><a href="#å®¹å™¨è¿è¡Œ" class="headerlink" title="å®¹å™¨è¿è¡Œ"></a>å®¹å™¨è¿è¡Œ</h1><p><code>docker run --name å®¹å™¨å -p ç«¯å£æ˜ å°„ -d     é•œåƒå</code></p><p>-dï¼šåå°è¿è¡Œ</p><p>-pï¼šç«¯å£æ˜ å°„  80:80 å®¿ä¸»ç«¯å£ï¼šå®¹å™¨ç«¯å£</p><p>è¿›å…¥å®¹å™¨<code>docker exec -it å®¹å™¨å bash</code></p><p>-itï¼šç»™å½“å‰è¿›å…¥çš„å®¹å™¨åˆ›å»ºä¸€ä¸ªæ ‡å‡†è¾“å…¥ã€è¾“å‡ºç»ˆç«¯ã€å…è®¸æˆ‘ä»¬ä¸å®¹å™¨äº¤äº’</p><p>bashï¼šè¿›å…¥å®¹å™¨åæ‰§è¡Œçš„å‘½ä»¤ï¼Œbashæ˜¯ä¸€ä¸ªlinuxç»ˆç«¯äº¤äº’å‘½ä»¤</p><p>ä½†æ˜¯åœ¨å®¹å™¨å†…ä¿®æ”¹æ–‡ä»¶æ˜¯ä¸æ¨èçš„</p><p><strong>é€€å‡ºå®¹å™¨ä¸”ä¸å…³é—­å®¹å™¨: Ctrl + p + q</strong> </p><p>è¡¥å……ï¼šè¿è¡Œmysqlå®¹å™¨æ—¶è¦åœ¨å‘½ä»¤åŠ ä¸Š-e MYSQL_ROOT_PASSWORD=ä½ çš„å¯†ç  å¦åˆ™è¿è¡Œå¤±è´¥</p><h1 id="æ•°æ®å·"><a href="#æ•°æ®å·" class="headerlink" title="æ•°æ®å·"></a>æ•°æ®å·</h1><p>æ•°æ®å·volumeæ˜¯ä¸€ä¸ªè™šæ‹Ÿç›®å½•ï¼ŒæŒ‡å‘å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿä¸­çš„æŸä¸ªç›®å½•</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220413141158915.png" alt="image-20220413141158915"></p><p><code>docker volume command</code></p><p>å¸¸ç”¨æ•°æ®å·å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker volume create  #åˆ›å»ºä¸€ä¸ªvolume</span><br><span class="line">docker volume inspect #æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªvolumeä¿¡æ¯</span><br><span class="line">docker volume ls   #åˆ—å‡ºæ‰€æœ‰volume</span><br><span class="line">docker volume prune #åˆ é™¤æœªä½¿ç”¨çš„volume</span><br><span class="line">docker volume rm #åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šçš„volume</span><br><span class="line">docker inspect æ•°æ®å·å  #è·å–å®¹å™¨/é•œåƒçš„å…ƒæ•°æ®</span><br></pre></td></tr></table></figure><h3 id="æŒ‚è½½æ•°æ®å·"><a href="#æŒ‚è½½æ•°æ®å·" class="headerlink" title="æŒ‚è½½æ•°æ®å·"></a>æŒ‚è½½æ•°æ®å·</h3><p>åœ¨åˆ›å»ºå®¹å™¨æ—¶å¯ä»¥é€šè¿‡-vå‚æ•°æ¥å°†æ•°æ®å·æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„æŸä¸ªç›®å½•(æ•°æ®å·ä¼šè‡ªåŠ¨åˆ›å»º)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --name å®¹å™¨å -v å®¿ä¸»æœºæ–‡ä»¶(æ•°æ®å·): å®¹å™¨å†…æ–‡ä»¶</span><br><span class="line">docker run --name mn -v html:/usr/share/nginx/html </span><br></pre></td></tr></table></figure><p>å½“å®¹å™¨æŒ‚è½½äº†æ•°æ®å·ï¼Œå³å¯åœ¨å®¹å™¨å¤–ä¿®æ”¹å®¹å™¨å†…å®¹(å®ƒä»¬æ˜¯åŒå‘ç»‘å®š)</p><p>åœ¨å®¿ä¸»æœºæ•°æ®å·çš„ç›®å½•é»˜è®¤æ˜¯ var/lib/docker/volumes/xxx/â€¦/   ä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®š</p><p>æƒ³çŸ¥é“å®¹å™¨å†…çš„æ–‡ä»¶ä½ç½®å¯ä»¥åˆ°dockerhubå®˜æ–¹æ–‡æ¡£æŸ¥æ‰¾</p><p><strong>docker volume inspect å®¹å™¨å #æŸ¥çœ‹æ•°æ®å·ä½ç½®</strong></p><p><strong>åœ¨cdåˆ°è¯¥ç›®å½• vimä¿®æ”¹æ–‡ä»¶</strong></p><h1 id="Dockerfileè‡ªå®šä¹‰é•œåƒ"><a href="#Dockerfileè‡ªå®šä¹‰é•œåƒ" class="headerlink" title="Dockerfileè‡ªå®šä¹‰é•œåƒ"></a>Dockerfileè‡ªå®šä¹‰é•œåƒ</h1><ul><li>é•œåƒæ˜¯å°†åº”ç”¨ç¨‹åºåŠå…¶éœ€è¦çš„ç³»ç»Ÿå‡½æ•°åº“ã€ç¯å¢ƒã€é…ç½®ã€ä¾èµ–æ‰“åŒ…è€Œæˆ</li></ul><p>é•œåƒæ˜¯åˆ†å±‚ç»“æ„ï¼ŒåŒ…æ‹¬åŸºç¡€é•œåƒBaseImageã€å…¥å£Entrypintã€å…¶ä»–ä¾èµ–å’Œå®‰è£…ç¨‹åº</p><p>åŸºç¡€é•œåƒå¯ä»¥æ˜¯æ“ä½œç³»ç»Ÿã€ä¹Ÿå¯ä»¥æ˜¯åˆ«äººåˆ¶ä½œå¥½çš„é•œåƒ</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220416160456909.png" alt="image-20220416160456909"></p><p>å…¶ä»–è¯­æ³•ï¼Œæ–‡æ¡£ï¼š<a href="https://blog.csdn.net/qq_42896653/article/details/122010894">Dockerfile å‚è€ƒæ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></p><p>dockerfileæ–‡ä»¶ç¤ºä¾‹ï¼š</p><p><img src="/2022/04/08/docker/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220503223603507.png" alt="image-20220503223603507"></p><p><strong>å°†ä¸€ä¸ªJavaé¡¹ç›®æ„å»ºæˆé•œåƒï¼š</strong></p><ul><li><p>æ–°å»ºä¸€ä¸ªå·¥ä½œç›®å½•ï¼Œç„¶ååœ¨é‡Œé¢æ–°å»ºDockerfileæ–‡ä»¶</p></li><li><p>å°†Javaé¡¹ç›®æ‰“åŒ…æˆjaråŒ…å¹¶æ”¾åˆ°ç›®å½•é‡Œ</p></li><li><p>ç¼–å†™Dockerfileæ–‡ä»¶(Javaé¡¹ç›®ä¸€èˆ¬éœ€è¦æŒ‡å®šjdkç‰ˆæœ¬)</p></li><li><p>docker build -t æ„å»ºå¥½çš„é•œåƒå Dockerfileæ‰€åœ¨çš„ç›®å½• </p><p>e.g: docker build -t javaweb:1.0 .            #æ³¨æ„è¿™ä¸ª.è¡¨ç¤ºæ‰€éœ€çš„Dockerfileæ‰€åœ¨çš„ç›®å½•</p></li><li><p>ä½¿ç”¨docker runåˆ›å»ºå®¹å™¨å¹¶è¿è¡Œ</p></li></ul><h1 id="DockerCompose"><a href="#DockerCompose" class="headerlink" title="DockerCompose"></a>DockerCompose</h1><ul><li><p>Compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p></li><li><p>Composeæ–‡ä»¶æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œé€šè¿‡æŒ‡ä»¤å®šä¹‰é›†ç¾¤ä¸­çš„æ¯ä¸ªå®¹å™¨å¦‚ä½•è¿è¡Œï¼Œå½¢å¼å¦‚ä¸‹å›¾(ä¸¤ç§æ–¹å¼)ï¼š</p></li><li><p>DockerComposeçš„å®‰è£…å‚è€ƒ <a href="https://deimos.magi-verse.com/2022/04/08/Centos7InstallDocker/">Centos7ä¸‹å®‰è£…docker</a></p></li><li><p>Compose ä½¿ç”¨çš„ä¸‰ä¸ªæ­¥éª¤ï¼š</p><p>ä½¿ç”¨ Dockerfile å®šä¹‰åº”ç”¨ç¨‹åºçš„ç¯å¢ƒã€‚</p><p>ä½¿ç”¨ docker-compose.yml å®šä¹‰æ„æˆåº”ç”¨ç¨‹åºçš„æœåŠ¡ï¼Œè¿™æ ·å®ƒä»¬å¯ä»¥åœ¨éš”ç¦»ç¯å¢ƒä¸­ä¸€èµ·è¿è¡Œã€‚</p><p>æœ€åï¼Œæ‰§è¡Œ docker-compose up å‘½ä»¤æ¥å¯åŠ¨å¹¶è¿è¡Œæ•´ä¸ªåº”ç”¨ç¨‹åºã€‚</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220419144135241.png" alt="image-20220419144135241"></p><p>è¿™é‡Œè¦æ±‚ç‰ˆæœ¬æœ€å¥½å’Œè£…å¥½çš„DockerComposeç‰ˆæœ¬å¯¹åº” <strong>æŸ¥çœ‹ç‰ˆæœ¬ docker-compose version</strong></p><p>dockercomposeé‡Œçš„æœåŠ¡ä¹‹é—´éƒ½å¯ä»¥ç”¨æœåŠ¡åè®¿é—®</p><p>æ³¨æ„ï¼š</p><p>mysqlæŒ‚è½½æ•°æ®å·æ—¶æŒ‡å®šçš„è·¯å¾„ $PWD å’Œ . çš„åŒºåˆ«</p><p>WARNING: The PWD variable is not set. Defaulting to a blank string.</p><h3 id><a href="#" class="headerlink" title></a></h3><p><strong>è¯•ç€å°†ä¹‹å‰å†™çš„å¾®æœåŠ¡é¡¹ç›®ç”¨DockerComposeéƒ¨ç½²</strong></p><p><img src="/2022/04/08/docker/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220422135137678.png" alt="image-20220422135137678"></p><p>æ¯ä¸ªå¾®æœåŠ¡æœ‰å®ƒçš„jaråŒ…å’ŒDockerfileï¼Œè€Œdocker-compose.ymlåˆ™ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨æ„å»ºé•œåƒ</p><p>å¾®æœåŠ¡å¯¹åº”çš„dockerfileï¼š</p><p><img src="/2022/04/08/docker/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220503224728913.png" alt="image-20220503224728913"></p><p>docker-compose.ymlç¤ºä¾‹ï¼š</p><p><img src="/2022/04/08/docker/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220422135418552.png" alt="image-20220422135418552"></p><h1 id="ä½¿ç”¨docker-composeéƒ¨ç½²nginx"><a href="#ä½¿ç”¨docker-composeéƒ¨ç½²nginx" class="headerlink" title="ä½¿ç”¨docker-composeéƒ¨ç½²nginx"></a>ä½¿ç”¨docker-composeéƒ¨ç½²nginx</h1><h3 id="step1ï¼šåˆ›å»ºä¸€ä¸ªnginxçš„å·¥ä½œç›®å½•"><a href="#step1ï¼šåˆ›å»ºä¸€ä¸ªnginxçš„å·¥ä½œç›®å½•" class="headerlink" title="step1ï¼šåˆ›å»ºä¸€ä¸ªnginxçš„å·¥ä½œç›®å½•"></a>step1ï¼šåˆ›å»ºä¸€ä¸ªnginxçš„å·¥ä½œç›®å½•</h3><p>ã€€ã€€æš‚å®šç›®å½•ä¸º nginxpath</p><h3 id="step2ï¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„nginxå®¹å™¨"><a href="#step2ï¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„nginxå®¹å™¨" class="headerlink" title="step2ï¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„nginxå®¹å™¨"></a>step2ï¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„nginxå®¹å™¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name nginx-demo -d nginx</span><br></pre></td></tr></table></figure><h3 id="step3ï¼šå¤åˆ¶ç›¸å…³çš„é…ç½®æ–‡ä»¶"><a href="#step3ï¼šå¤åˆ¶ç›¸å…³çš„é…ç½®æ–‡ä»¶" class="headerlink" title="step3ï¼šå¤åˆ¶ç›¸å…³çš„é…ç½®æ–‡ä»¶"></a>step3ï¼šå¤åˆ¶ç›¸å…³çš„é…ç½®æ–‡ä»¶</h3><p>docker cp å‘½ä»¤ç”¨äºåœ¨å®¹å™¨å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹(åŒå‘)</p><p>ä¸¤ä¸ªè·¯å¾„ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€è¡¨ç¤º</p><p>å°†nginx-demoå®¹å™¨çš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°å½“å‰ç›®å½•        æ³¨æ„ . è¡¨ç¤ºå½“å‰ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /nginxpath</span><br><span class="line">docker cp nginx-demo:/etc/nginx/nginx.conf .</span><br><span class="line">docker cp nginx-demo:/etc/nginx/conf.d/default.conf .</span><br><span class="line">docker cp nginx-demo:/usr/share/nginx/html .</span><br></pre></td></tr></table></figure><p>ç›®å½•ç»“æ„ä¸ºï¼š</p><p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤åˆ¶ä»£ç "></a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nginxpath</span><br><span class="line">â”œâ”€â”€ conf.d</span><br><span class="line">â”‚   â”œâ”€â”€ default.conf</span><br><span class="line">â”œâ”€â”€ html</span><br><span class="line">â”‚   â”œâ”€â”€ 50x.html</span><br><span class="line">â”‚   â””â”€â”€ index.html</span><br><span class="line">â””â”€â”€ nginx.conf</span><br></pre></td></tr></table></figure><p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤åˆ¶ä»£ç "></a></p><h3 id="step4ï¼šç¼–å†™docker-compose-ymlæ–‡ä»¶"><a href="#step4ï¼šç¼–å†™docker-compose-ymlæ–‡ä»¶" class="headerlink" title="step4ï¼šç¼–å†™docker-compose.ymlæ–‡ä»¶"></a>step4ï¼šç¼–å†™docker-compose.ymlæ–‡ä»¶</h3><p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹confç”¨æ¥å­˜æ”¾nginx.confæ–‡ä»¶</p><p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤åˆ¶ä»£ç "></a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> 1 version: &quot;3.0&quot;</span><br><span class="line"> 2 </span><br><span class="line"> 3 services:</span><br><span class="line"> 4   ngnix:                                          #æœåŠ¡åç§°ï¼Œåç§°å¯è‡ªå®šä¹‰</span><br><span class="line"> 5     container_name: nginx-compose              #å®¹å™¨åç§°ï¼Œå¯è‡ªå®šä¹‰</span><br><span class="line"> 6     image: nginx                                   # é•œåƒåç§°</span><br><span class="line"> 7     restart: always</span><br><span class="line"> 8     ports:                                     # å®¹å™¨å’ŒæœåŠ¡å™¨å¯¹åº”çš„ç«¯å£æ˜ å°„ï¼Œæ¯æ¬¡æ–°å¢ä¸€ä¸ªç«™ç‚¹ä¹‹åä¸€å®šè¦åœ¨è¿™é‡ŒæŠŠå¯¹åº”çš„ç«¯å£æ˜ å°„åŠ ä¸Šï¼Œä¸ç„¶è‚¯å®šä¼š404</span><br><span class="line"> 9       - 80:80</span><br><span class="line">10       - 8080:8080</span><br><span class="line">11       - 8081:8081</span><br><span class="line">12       - 8082:8082</span><br><span class="line">13     privileged: true</span><br><span class="line">14     volumes:</span><br><span class="line">15       - /home/install/softs/04.nginx/conf.d:/etc/nginx/conf.d</span><br><span class="line">16       - /home/install/softs/04.nginx/conf/nginx.conf:/etc/nginx/nginx.conf</span><br><span class="line">17       - /home/install/softs/04.nginx/logs:/var/log/nginx</span><br><span class="line">18       - /home/install/softs/04.nginx/html:/usr/share/nginx/html</span><br><span class="line">19       - /etc/letsencrypt:/etc/letsencrypt</span><br><span class="line">20       - /etc/localtime:/etc/localtime</span><br></pre></td></tr></table></figure><p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤åˆ¶ä»£ç "></a></p><p>ç›®å½•ç»“æ„ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nginxpath</span><br><span class="line">â”œâ”€â”€ conf.d #é…ç½®æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚ â”œâ”€â”€ default.conf #é»˜è®¤çš„é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ html #é™æ€æ–‡ä»¶èµ„æº</span><br><span class="line">â”‚ â”œâ”€â”€ 50x.html #é”™è¯¯é¡µé¢</span><br><span class="line">â”‚ â””â”€â”€ index.html #é¦–é¡µ</span><br><span class="line">â”œâ”€â”€ conf #è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚ â””â”€â”€ nginx.conf #è‡ªå®šä¹‰é…ç½®æ–‡ä»¶</span><br><span class="line">â””â”€â”€ docker-compose.yml #docker-composeé…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="step5ï¼šè¿è¡Œdocker-composeæŸ¥çœ‹ç»“æœ"><a href="#step5ï¼šè¿è¡Œdocker-composeæŸ¥çœ‹ç»“æœ" class="headerlink" title="step5ï¼šè¿è¡Œdocker-composeæŸ¥çœ‹ç»“æœ"></a>step5ï¼šè¿è¡Œdocker-composeæŸ¥çœ‹ç»“æœ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="endï¼šåˆ é™¤-nginx-demoé•œåƒ"><a href="#endï¼šåˆ é™¤-nginx-demoé•œåƒ" class="headerlink" title="endï¼šåˆ é™¤ nginx-demoé•œåƒ"></a>endï¼šåˆ é™¤ nginx-demoé•œåƒ</h3><h1 id="Dokceré•œåƒä»“åº“"><a href="#Dokceré•œåƒä»“åº“" class="headerlink" title="Dokceré•œåƒä»“åº“"></a>Dokceré•œåƒä»“åº“</h1><p>é•œåƒä»“åº“(Docker Registry)ï¼š</p><ul><li>å…¬å…±ä»“åº“ï¼šæˆ‘ä»¬æ¥è§¦è¿‡çš„dockerhubå°±æ˜¯ä¸€ä¸ªå…¬å…±çš„é•œåƒä»“åº“ï¼Œå›½å†…çš„æœ‰ç½‘æ˜“äº‘é•œåƒæœåŠ¡ã€DaoCloudã€é˜¿é‡Œäº‘é•œåƒæœåŠ¡ç­‰</li><li>ç”¨æˆ·è¿˜å¯ä»¥åœ¨æœ¬åœ°æ­å»ºç§æœ‰Docker Registryã€‚</li></ul><h2 id="ç®€åŒ–ç‰ˆé•œåƒä»“åº“"><a href="#ç®€åŒ–ç‰ˆé•œåƒä»“åº“" class="headerlink" title="ç®€åŒ–ç‰ˆé•œåƒä»“åº“"></a>ç®€åŒ–ç‰ˆé•œåƒä»“åº“</h2><p>Dockerå®˜æ–¹çš„Docker Registryæ˜¯ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬çš„Dockeré•œåƒä»“åº“ï¼Œå…·å¤‡ä»“åº“ç®¡ç†çš„å®Œæ•´åŠŸèƒ½ï¼Œä½†æ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢ã€‚</p><p>æ­å»ºæ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">    --restart=always \</span><br><span class="line">    --name registry\</span><br><span class="line">    -p 5000:5000 \</span><br><span class="line">    -v registry-data:/var/lib/registry \</span><br><span class="line">    registry</span><br></pre></td></tr></table></figure><p>å‘½ä»¤ä¸­æŒ‚è½½äº†ä¸€ä¸ªæ•°æ®å·r egistry-dataåˆ°å®¹å™¨å†…çš„/var/lib/registry ç›®å½•ï¼Œè¿™æ˜¯ç§æœ‰é•œåƒåº“å­˜æ”¾æ•°æ®çš„ç›®å½•ã€‚</p><p>è®¿é—®<a href="http://yourip:5000/v2/_catalog">http://YourIp:5000/v2/_catalog</a> å¯ä»¥æŸ¥çœ‹å½“å‰ç§æœ‰é•œåƒæœåŠ¡ä¸­åŒ…å«çš„é•œåƒ</p><h2 id="å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬"><a href="#å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬" class="headerlink" title="å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬"></a>å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬</h2><p>ä½¿ç”¨DockerComposeéƒ¨ç½²å¸¦æœ‰å›¾è±¡ç•Œé¢çš„DockerRegistryï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.0&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./registry-data:/var/lib/registry</span></span><br><span class="line">  <span class="attr">ui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">joxit/docker-registry-ui:static</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_TITLE=ä¼ æ™ºæ•™è‚²ç§æœ‰ä»“åº“</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REGISTRY_URL=http://registry:5000</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">registry</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®Dockerä¿¡ä»»åœ°å€"><a href="#é…ç½®Dockerä¿¡ä»»åœ°å€" class="headerlink" title="é…ç½®Dockerä¿¡ä»»åœ°å€"></a>é…ç½®Dockerä¿¡ä»»åœ°å€</h2><p>æˆ‘ä»¬çš„ç§æœé‡‡ç”¨çš„æ˜¯httpåè®®ï¼Œé»˜è®¤ä¸è¢«Dockerä¿¡ä»»ï¼Œæ‰€ä»¥éœ€è¦åšä¸€ä¸ªé…ç½®jsonæ ¼å¼ï¼š</p><p>æ³¨æ„ipåœ°å€</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€è¦ä¿®æ”¹çš„æ–‡ä»¶</span></span><br><span class="line">vi /etc/docker/daemon.json</span><br><span class="line"><span class="comment"># æ·»åŠ å†…å®¹ï¼š</span></span><br><span class="line"><span class="string">&quot;insecure-registries&quot;</span>:[<span class="string">&quot;http://192.168.150.101:8080&quot;</span>]</span><br><span class="line"><span class="comment"># é‡åŠ è½½</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="comment"># é‡å¯docker</span></span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="æ¨é€ã€æ‹‰å–é•œåƒ"><a href="#æ¨é€ã€æ‹‰å–é•œåƒ" class="headerlink" title="æ¨é€ã€æ‹‰å–é•œåƒ"></a>æ¨é€ã€æ‹‰å–é•œåƒ</h2><p>æ¨é€é•œåƒåˆ°ç§æœ‰é•œåƒæœåŠ¡å¿…é¡»å…ˆtagï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>â‘  é‡æ–°tagæœ¬åœ°é•œåƒï¼Œåç§°å‰ç¼€ä¸ºç§æœ‰ä»“åº“çš„åœ°å€ï¼š192.168.150.101:8080/</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag nginx:latest 192.168.150.101:8080/nginx:1.0 </span><br></pre></td></tr></table></figure><p>â‘¡ æ¨é€é•œåƒ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push 192.168.150.101:8080/nginx:1.0 </span><br></pre></td></tr></table></figure><p>â‘¢ æ‹‰å–é•œåƒ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull 192.168.150.101:8080/nginx:1.0 </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git</title>
      <link href="/2022/04/06/Git/"/>
      <url>/2022/04/06/Git/</url>
      
        <content type="html"><![CDATA[<h1 id="Gitæœ€ç®€å•çš„ä½¿ç”¨æµç¨‹"><a href="#Gitæœ€ç®€å•çš„ä½¿ç”¨æµç¨‹" class="headerlink" title="Gitæœ€ç®€å•çš„ä½¿ç”¨æµç¨‹"></a>Gitæœ€ç®€å•çš„ä½¿ç”¨æµç¨‹</h1><p>å®‰è£…å’Œéƒ¨ç½²åœ¨å„ç§ç¼–è¯‘è½¯ä»¶ä¸Šçš„è¿‡ç¨‹å°±ä¸å†èµ˜è¿°äº†ï¼Œç™¾åº¦éƒ½æœ‰ç›¸åº”çš„æ•™ç¨‹ï¼Œè¿™é‡Œé»˜è®¤å®‰è£…å¥½äº†gitã€‚</p><p>åœ¨å½“å‰æ–‡ä»¶å¤¹å³é”®æ‰“å¼€Git Bashï¼š</p><p>git init å‘½ä»¤ç”¨äºåœ¨ç›®å½•ä¸­åˆ›å»ºæ–°çš„ Git ä»“åº“</p><p>å¤åˆ¶è‡ªå·±çš„ä»“åº“åªéœ€ git clone <a href="https://github.com/dullandmeanless/dullandmeanless.github.io.git">https://github.com/dullandmeanless/dullandmeanless.github.io.git</a></p><p>å¤åˆ¶åˆ«äººçš„ä»“åº“å…ˆforkåˆ°è‡ªå·±çš„ä»“åº“ä¸­ï¼Œä¿®æ”¹å®Œå†git requestå‘ä»“åº“åŸä¸»äººå‘è¯·æ±‚</p><p>git add <filename></filename></p><p>æƒ³è¦æ’¤å›æœ¬æ¬¡addï¼Œå¯ä»¥git reset  head <filename> </filename></p><p>git commit -m <message></message></p><p>æ‰§è¡Œcommitåï¼Œè¿˜æ²¡æ‰§è¡Œpushæ—¶ï¼Œæƒ³è¦æ’¤é”€è¿™æ¬¡çš„commitï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>è§£å†³æ–¹æ¡ˆï¼š ä½¿ç”¨å‘½ä»¤ï¼šgit reset â€“soft HEAD^ (â€“softè¡¨ç¤ºä¸åˆ é™¤å·¥ä½œç©ºé—´çš„æ”¹åŠ¨ä»£ç ï¼Œâ€“hard åˆ é™¤å·¥ä½œç©ºé—´çš„æ”¹åŠ¨ä»£ç ã€^è¡¨ç¤ºä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ŒHEAD~2è¡¨ç¤ºæ’¤å›ä¸Šä¸¤ä¸ªç‰ˆæœ¬çš„commit)</p><p>å¦å¤–ä¸€ç‚¹ï¼Œå¦‚æœcommitæ³¨é‡Šå†™é”™äº†ï¼Œå…ˆè¦æ”¹ä¸€ä¸‹æ³¨é‡Šï¼Œæœ‰å…¶ä»–æ–¹æ³•ä¹Ÿèƒ½å®ç°ï¼Œå¦‚ï¼šgit commit â€“amend è¿™æ—¶å€™ä¼šè¿›å…¥vimç¼–è¾‘å™¨ï¼Œä¿®æ”¹å®Œæˆä½ è¦çš„æ³¨é‡Šåä¿å­˜å³å¯ã€‚</p><p>git push</p><h1 id="forkå’Œcloneçš„åŒºåˆ«-fetchä¸pullçš„åŒºåˆ«"><a href="#forkå’Œcloneçš„åŒºåˆ«-fetchä¸pullçš„åŒºåˆ«" class="headerlink" title="forkå’Œcloneçš„åŒºåˆ«,fetchä¸pullçš„åŒºåˆ«"></a>forkå’Œcloneçš„åŒºåˆ«,fetchä¸pullçš„åŒºåˆ«</h1><p>forkï¼šåœ¨githubé¡µé¢ï¼Œç‚¹å‡»forkæŒ‰é’®ã€‚å°†åˆ«äººçš„ä»“åº“å¤åˆ¶ä¸€ä»½åˆ°è‡ªå·±çš„ä»“åº“ã€‚</p><p>cloneï¼šå°†githubä¸­çš„ä»“åº“å…‹éš†åˆ°è‡ªå·±æœ¬åœ°ç”µè„‘ä¸­</p><p>é—®é¢˜ï¼špull requestçš„ä½œç”¨</p><p>æ¯”å¦‚åœ¨ä»“åº“çš„ä¸»äººï¼ˆAï¼‰æ²¡æœ‰æŠŠæˆ‘ä»¬æ·»åŠ ä¸ºé¡¹ç›®åˆä½œè€…çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å°†Açš„æŸä¸ªä»“åº“åä¸ºâ€œaâ€çš„ä»“åº“cloneåˆ°è‡ªå·±çš„ç”µè„‘ä¸­ï¼Œåœ¨è‡ªå·±çš„ç”µè„‘è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬æ²¡åŠæ³•é€šè¿‡pushå°†ä»£ç è´¡çŒ®åˆ°Bä¸­ã€‚</p><p>æ‰€ä»¥è¦æƒ³å°†ä½ çš„ä»£ç è´¡çŒ®åˆ°Bä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p><ol><li>åœ¨Açš„ä»“åº“ä¸­forké¡¹ç›®a ï¼ˆæ­¤æ—¶æˆ‘ä»¬è‡ªå·±çš„githubå°±æœ‰ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„ä»“åº“aï¼Œä½†æ˜¯URLä¸åŒï¼‰</li><li>å°†æˆ‘ä»¬ä¿®æ”¹çš„ä»£ç pushåˆ°è‡ªå·±githubä¸­çš„ä»“åº“Bä¸­</li><li>pull request ï¼Œä¸»äººå°±ä¼šæ”¶åˆ°è¯·æ±‚ï¼Œå¹¶å†³å®šè¦ä¸è¦æ¥å—ä½ çš„ä»£ç </li><li>ä¹Ÿå¯ä»¥å¯ä»¥ç”³è¯·ä¸ºé¡¹ç›®açš„contributorï¼Œè¿™æ ·å¯ä»¥ç›´æ¥push</li></ol><p>(2) forkäº†åˆ«äººçš„é¡¹ç›®åˆ°è‡ªå·±çš„repositoryä¹‹åï¼Œåˆ«äººçš„é¡¹ç›®æ›´æ–°äº†ï¼Œæˆ‘ä»¬forkçš„é¡¹ç›®æ€ä¹ˆæ›´æ–°ï¼Ÿ</p><p>ç­”ï¼šé¦–å…ˆfetchç½‘ä¸Šçš„æ›´æ–°åˆ°è‡ªå·±çš„é¡¹ç›®ä¸Šï¼Œç„¶åå†åˆ¤æ–­ã€mergeã€‚è¿™é‡Œå°±æ¶‰åŠäº†ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œpullå’Œfetchæœ‰å•¥åŒºåˆ«ã€‚</p><p> ï¼ˆ3ï¼‰fetch+mergeä¸pullæ•ˆæœä¸€æ ·ã€‚ä½†æ˜¯è¦å¤šç”¨fetch+mergeï¼Œè¿™æ ·å¯ä»¥æ£€æŸ¥fetchä¸‹æ¥çš„æ›´æ–°æ˜¯å¦åˆé€‚ã€‚pullç›´æ¥åŒ…å«äº†è¿™ä¸¤æ­¥æ“ä½œï¼Œå¦‚æœä½ è§‰å¾—ç½‘ä¸Šçš„æ›´æ–°æ²¡æœ‰é—®é¢˜ï¼Œé‚£ç›´æ¥pullä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p> git revert å’Œ git resetçš„åŒºåˆ«</p><ul><li>git revert ç”¨ä¸€æ¬¡æ–°çš„commitæ¥å›æ»šä¹‹å‰çš„commitï¼Œæ­¤æ¬¡æäº¤ä¹‹å‰çš„commitéƒ½ä¼šè¢«ä¿ç•™ï¼›</li><li>git reset å›åˆ°æŸæ¬¡æäº¤ï¼Œæäº¤åŠä¹‹å‰çš„commitéƒ½ä¼šè¢«ä¿ç•™ï¼Œä½†æ˜¯æ­¤commit idä¹‹åçš„ä¿®æ”¹éƒ½ä¼šè¢«åˆ é™¤</li></ul><h1 id="å¦‚ä½•æ’¤é”€-Git-æ“ä½œï¼Ÿ"><a href="#å¦‚ä½•æ’¤é”€-Git-æ“ä½œï¼Ÿ" class="headerlink" title="å¦‚ä½•æ’¤é”€ Git æ“ä½œï¼Ÿ"></a>å¦‚ä½•æ’¤é”€ Git æ“ä½œï¼Ÿ</h1><p>è½¬è½½è‡ª<a href="https://ruanyifeng.com/blog/2019/12/git-undo.html%EF%BC%8C%E5%9C%A8%E4%B8%8A%E7%BD%91%E5%AD%A6%E4%B9%A0Git%E7%9A%84%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%97%B6%EF%BC%8C%E5%B1%85%E7%84%B6%E5%8F%88%E6%89%BE%E5%88%B0%E4%BA%86%E9%98%AE%E4%B8%80%E5%B3%B0%E5%A4%A7%E4%BD%AC%E7%9A%84%E6%96%87%E7%AB%A0%EF%BC%8C%E7%94%B1%E4%BA%8E%E4%BB%96%E5%86%99%E5%BE%97%E5%AE%9E%E5%9C%A8%E6%98%AF%E6%B5%85%E6%98%BE%E6%98%93%E6%87%82%EF%BC%8C%E6%88%91%E4%B8%AA%E4%BA%BA%E5%86%8D%E5%8E%BB%E6%80%BB%E7%BB%93%E8%BF%99%E9%83%A8%E5%88%86%E6%93%8D%E4%BD%9C%E4%B9%9F%E6%B2%A1%E6%9C%89%E6%84%8F%E4%B9%89%EF%BC%8C%E8%BF%99%E9%87%8C%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8(%E6%9C%89%E5%88%A0%E6%94%B9)%EF%BC%9A">https://ruanyifeng.com/blog/2019/12/git-undo.htmlï¼Œåœ¨ä¸Šç½‘å­¦ä¹ Gitçš„ç›¸å…³çŸ¥è¯†æ—¶ï¼Œå±…ç„¶åˆæ‰¾åˆ°äº†é˜®ä¸€å³°å¤§ä½¬çš„æ–‡ç« ï¼Œç”±äºä»–å†™å¾—å®åœ¨æ˜¯æµ…æ˜¾æ˜“æ‡‚ï¼Œæˆ‘ä¸ªäººå†å»æ€»ç»“è¿™éƒ¨åˆ†æ“ä½œä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼Œè¿™é‡Œç›´æ¥å¼•ç”¨(æœ‰åˆ æ”¹)ï¼š</a></p><h1 id="Gitå¸¸ç”¨æŒ‡ä»¤"><a href="#Gitå¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="Gitå¸¸ç”¨æŒ‡ä»¤"></a>Gitå¸¸ç”¨æŒ‡ä»¤</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">git init                                                  # åˆå§‹åŒ–æœ¬åœ°gitä»“åº“ï¼ˆåˆ›å»ºæ–°ä»“åº“ï¼‰</span><br><span class="line">git config --global user.name &quot;xxx&quot;                       # é…ç½®ç”¨æˆ·å</span><br><span class="line">git config --global user.email &quot;xxx@xxx.com&quot;              # é…ç½®é‚®ä»¶</span><br><span class="line">git config --global color.ui true                         # git statusç­‰å‘½ä»¤è‡ªåŠ¨ç€è‰²</span><br><span class="line">git config --global color.status auto</span><br><span class="line">git config --global color.diff auto</span><br><span class="line">git config --global color.branch auto</span><br><span class="line">git config --global color.interactive auto</span><br><span class="line">git config --global --unset http.proxy                    # remove  proxy configuration on git</span><br><span class="line">git clone git+ssh://git@192.168.53.168/VT.git             # cloneè¿œç¨‹ä»“åº“</span><br><span class="line">git status                                                # æŸ¥çœ‹å½“å‰ç‰ˆæœ¬çŠ¶æ€ï¼ˆæ˜¯å¦ä¿®æ”¹ï¼‰</span><br><span class="line">git add xyz                                               # æ·»åŠ xyzæ–‡ä»¶è‡³index</span><br><span class="line">git add .                                                 # å¢åŠ å½“å‰å­ç›®å½•ä¸‹æ‰€æœ‰æ›´æ”¹è¿‡çš„æ–‡ä»¶è‡³index</span><br><span class="line">git commit -m &#x27;xxx&#x27;                                       # æäº¤</span><br><span class="line">git commit --amend -m &#x27;xxx&#x27;                               # åˆå¹¶ä¸Šä¸€æ¬¡æäº¤ï¼ˆç”¨äºåå¤ä¿®æ”¹ï¼‰</span><br><span class="line">git commit -am &#x27;xxx&#x27;                                      # å°†addå’Œcommitåˆä¸ºä¸€æ­¥</span><br><span class="line">git rm xxx                                                # åˆ é™¤indexä¸­çš„æ–‡ä»¶</span><br><span class="line">git rm -r *                                               # é€’å½’åˆ é™¤</span><br><span class="line">git log                                                   # æ˜¾ç¤ºæäº¤æ—¥å¿—</span><br><span class="line">git log -1                                                # æ˜¾ç¤º1è¡Œæ—¥å¿— -nä¸ºnè¡Œ</span><br><span class="line">git log -5</span><br><span class="line">git log --stat                                            # æ˜¾ç¤ºæäº¤æ—¥å¿—åŠç›¸å…³å˜åŠ¨æ–‡ä»¶</span><br><span class="line">git log -p -m</span><br><span class="line">git show dfb02e6e4f2f7b573337763e5c0013802e392818         # æ˜¾ç¤ºæŸä¸ªæäº¤çš„è¯¦ç»†å†…å®¹</span><br><span class="line">git show dfb02                                            # å¯åªç”¨commitidçš„å‰å‡ ä½</span><br><span class="line">git show HEAD                                             # æ˜¾ç¤ºHEADæäº¤æ—¥å¿—</span><br><span class="line">git show HEAD^                                            # æ˜¾ç¤ºHEADçš„çˆ¶ï¼ˆä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼‰çš„æäº¤æ—¥å¿— ^^ä¸ºä¸Šä¸¤ä¸ªç‰ˆæœ¬ ^5ä¸ºä¸Š5ä¸ªç‰ˆæœ¬</span><br><span class="line">git tag                                                   # æ˜¾ç¤ºå·²å­˜åœ¨çš„tag</span><br><span class="line">git tag -a v2.0 -m &#x27;xxx&#x27;                                  # å¢åŠ v2.0çš„tag</span><br><span class="line">git show v2.0                                             # æ˜¾ç¤ºv2.0çš„æ—¥å¿—åŠè¯¦ç»†å†…å®¹</span><br><span class="line">git log v2.0                                              # æ˜¾ç¤ºv2.0çš„æ—¥å¿—</span><br><span class="line">git diff                                                  # æ˜¾ç¤ºæ‰€æœ‰æœªæ·»åŠ è‡³indexçš„å˜æ›´</span><br><span class="line">git diff --cached                                         # æ˜¾ç¤ºæ‰€æœ‰å·²æ·»åŠ indexä½†è¿˜æœªcommitçš„å˜æ›´</span><br><span class="line">git diff HEAD^                                            # æ¯”è¾ƒä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„å·®å¼‚</span><br><span class="line">git diff HEAD -- ./lib                                    # æ¯”è¾ƒä¸HEADç‰ˆæœ¬libç›®å½•çš„å·®å¼‚</span><br><span class="line">git diff origin/master..master                            # æ¯”è¾ƒè¿œç¨‹åˆ†æ”¯masterä¸Šæœ‰æœ¬åœ°åˆ†æ”¯masterä¸Šæ²¡æœ‰çš„</span><br><span class="line">git diff origin/master..master --stat                     # åªæ˜¾ç¤ºå·®å¼‚çš„æ–‡ä»¶ï¼Œä¸æ˜¾ç¤ºå…·ä½“å†…å®¹</span><br><span class="line">git remote add origin git+ssh://git@192.168.53.168/VT.git # å¢åŠ è¿œç¨‹å®šä¹‰ï¼ˆç”¨äºpush/pull/fetchï¼‰</span><br><span class="line">git branch                                                # æ˜¾ç¤ºæœ¬åœ°åˆ†æ”¯</span><br><span class="line">git branch --contains 50089                               # æ˜¾ç¤ºåŒ…å«æäº¤50089çš„åˆ†æ”¯</span><br><span class="line">git branch -a                                             # æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯</span><br><span class="line">git branch -r                                             # æ˜¾ç¤ºæ‰€æœ‰åŸåˆ›åˆ†æ”¯</span><br><span class="line">git branch --merged                                       # æ˜¾ç¤ºæ‰€æœ‰å·²åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯</span><br><span class="line">git branch --no-merged                                    # æ˜¾ç¤ºæ‰€æœ‰æœªåˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯</span><br><span class="line">git branch -m master master_copy                          # æœ¬åœ°åˆ†æ”¯æ”¹å</span><br><span class="line">git checkout -b master_copy                               # ä»å½“å‰åˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯master_copyå¹¶æ£€å‡º</span><br><span class="line">git checkout -b master master_copy                        # ä¸Šé¢çš„å®Œæ•´ç‰ˆ</span><br><span class="line">git checkout features/performance                         # æ£€å‡ºå·²å­˜åœ¨çš„features/performanceåˆ†æ”¯</span><br><span class="line">git checkout --track hotfixes/BJVEP933                    # æ£€å‡ºè¿œç¨‹åˆ†æ”¯hotfixes/BJVEP933å¹¶åˆ›å»ºæœ¬åœ°è·Ÿè¸ªåˆ†æ”¯</span><br><span class="line">git checkout v2.0                                         # æ£€å‡ºç‰ˆæœ¬v2.0</span><br><span class="line">git checkout -b devel origin/develop                      # ä»è¿œç¨‹åˆ†æ”¯developåˆ›å»ºæ–°æœ¬åœ°åˆ†æ”¯develå¹¶æ£€å‡º</span><br><span class="line">git checkout -- README                                    # æ£€å‡ºheadç‰ˆæœ¬çš„READMEæ–‡ä»¶ï¼ˆå¯ç”¨äºä¿®æ”¹é”™è¯¯å›é€€ï¼‰</span><br><span class="line">git merge origin/master                                   # åˆå¹¶è¿œç¨‹masteråˆ†æ”¯è‡³å½“å‰åˆ†æ”¯</span><br><span class="line">git cherry-pick ff44785404a8e                             # åˆå¹¶æäº¤ff44785404a8eçš„ä¿®æ”¹</span><br><span class="line">git push origin master                                    # å°†å½“å‰åˆ†æ”¯pushåˆ°è¿œç¨‹masteråˆ†æ”¯</span><br><span class="line">git push origin :hotfixes/BJVEP933                        # åˆ é™¤è¿œç¨‹ä»“åº“çš„hotfixes/BJVEP933åˆ†æ”¯</span><br><span class="line">git push --tags                                           # æŠŠæ‰€æœ‰tagæ¨é€åˆ°è¿œç¨‹ä»“åº“</span><br><span class="line">git fetch                                                 # è·å–æ‰€æœ‰è¿œç¨‹åˆ†æ”¯ï¼ˆä¸æ›´æ–°æœ¬åœ°åˆ†æ”¯ï¼Œå¦éœ€mergeï¼‰</span><br><span class="line">git fetch --prune                                         # è·å–æ‰€æœ‰åŸåˆ›åˆ†æ”¯å¹¶æ¸…é™¤æœåŠ¡å™¨ä¸Šå·²åˆ æ‰çš„åˆ†æ”¯</span><br><span class="line">git pull origin master                                    # è·å–è¿œç¨‹åˆ†æ”¯masterå¹¶mergeåˆ°å½“å‰åˆ†æ”¯</span><br><span class="line">git mv README README2                                     # é‡å‘½åæ–‡ä»¶READMEä¸ºREADME2</span><br><span class="line">git reset --hard HEAD                                     # å°†å½“å‰ç‰ˆæœ¬é‡ç½®ä¸ºHEADï¼ˆé€šå¸¸ç”¨äºmergeå¤±è´¥å›é€€ï¼‰</span><br><span class="line">git rebase</span><br><span class="line">git branch -d hotfixes/BJVEP933                           # åˆ é™¤åˆ†æ”¯hotfixes/BJVEP933ï¼ˆæœ¬åˆ†æ”¯ä¿®æ”¹å·²åˆå¹¶åˆ°å…¶ä»–åˆ†æ”¯ï¼‰</span><br><span class="line">git branch -D hotfixes/BJVEP933                           # å¼ºåˆ¶åˆ é™¤åˆ†æ”¯hotfixes/BJVEP933</span><br><span class="line">git ls-files                                              # åˆ—å‡ºgit indexåŒ…å«çš„æ–‡ä»¶</span><br><span class="line">git show-branch                                           # å›¾ç¤ºå½“å‰åˆ†æ”¯å†å²</span><br><span class="line">git show-branch --all                                     # å›¾ç¤ºæ‰€æœ‰åˆ†æ”¯å†å²</span><br><span class="line">git whatchanged                                           # æ˜¾ç¤ºæäº¤å†å²å¯¹åº”çš„æ–‡ä»¶ä¿®æ”¹</span><br><span class="line">git revert dfb02e6e4f2f7b573337763e5c0013802e392818       # æ’¤é”€æäº¤dfb02e6e4f2f7b573337763e5c0013802e392818</span><br><span class="line">git ls-tree HEAD                                          # å†…éƒ¨å‘½ä»¤ï¼šæ˜¾ç¤ºæŸä¸ªgitå¯¹è±¡</span><br><span class="line">git rev-parse v2.0                                        # å†…éƒ¨å‘½ä»¤ï¼šæ˜¾ç¤ºæŸä¸ªrefå¯¹äºçš„SHA1 HASH</span><br><span class="line">git reflog                                                # æ˜¾ç¤ºæ‰€æœ‰æäº¤ï¼ŒåŒ…æ‹¬å­¤ç«‹èŠ‚ç‚¹</span><br><span class="line">git show HEAD@&#123;5&#125;</span><br><span class="line">git show master@&#123;yesterday&#125;                               # æ˜¾ç¤ºmasteråˆ†æ”¯æ˜¨å¤©çš„çŠ¶æ€</span><br><span class="line">git log --pretty=format:&#x27;%h %s&#x27; --graph                   # å›¾ç¤ºæäº¤æ—¥å¿—</span><br><span class="line">git show HEAD~3</span><br><span class="line">git show -s --pretty=raw 2be7fcb476</span><br><span class="line">git stash                                                 # æš‚å­˜å½“å‰ä¿®æ”¹ï¼Œå°†æ‰€æœ‰è‡³ä¸ºHEADçŠ¶æ€</span><br><span class="line">git stash list                                            # æŸ¥çœ‹æ‰€æœ‰æš‚å­˜</span><br><span class="line">git stash show -p stash@&#123;0&#125;                               # å‚è€ƒç¬¬ä¸€æ¬¡æš‚å­˜</span><br><span class="line">git stash apply stash@&#123;0&#125;                                 # åº”ç”¨ç¬¬ä¸€æ¬¡æš‚å­˜</span><br><span class="line">git grep &quot;delete from&quot;                                    # æ–‡ä»¶ä¸­æœç´¢æ–‡æœ¬â€œdelete fromâ€</span><br><span class="line">git grep -e &#x27;#define&#x27; --and -e SORT_DIRENT                # æ¸…ç†ä¸å¿…è¦çš„æ–‡ä»¶å¹¶ä¼˜åŒ–æœ¬åœ°å­˜å‚¨åº“</span><br><span class="line">git gc</span><br><span class="line">git fsck</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¤šçº¿ç¨‹ä¸é«˜å¹¶å‘</title>
      <link href="/2022/03/29/Multithreading/"/>
      <url>/2022/03/29/Multithreading/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿ç¨‹ä¸è¿›ç¨‹"><a href="#çº¿ç¨‹ä¸è¿›ç¨‹" class="headerlink" title="çº¿ç¨‹ä¸è¿›ç¨‹"></a>çº¿ç¨‹ä¸è¿›ç¨‹</h1><h3 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h3><ul><li>ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯åŠ¨æ€çš„ã€å¹¶å‘çš„ã€æš‚æ—¶çš„ã€</li><li>ç¨‹åºç”±æŒ‡ä»¤å’Œæ•°æ®ç»„æˆï¼Œä½†æ˜¯è¿™äº›æŒ‡ä»¤è¦è¿è¡Œï¼Œæ•°æ®è¦è¯»å†™ï¼Œå°±å¿…é¡»å°†æŒ‡ä»¤åŠ è½½åˆ°cpuï¼Œæ•°æ®åŠ è½½è‡³å†…å­˜ã€‚åœ¨æŒ‡ä»¤è¿è¡Œè¿‡ç¨‹ä¸­è¿˜éœ€è¦ç”¨åˆ°ç£ç›˜ï¼Œç½‘ç»œç­‰è®¾å¤‡ï¼Œè¿›ç¨‹å°±æ˜¯ç”¨æ¥åŠ è½½æŒ‡ä»¤ã€ç®¡ç†å†…å­˜ã€ç®¡ç†IOçš„ </li><li>å½“ä¸€ä¸ªæŒ‡ä»¤è¢«è¿è¡Œï¼Œä»ç£ç›˜åŠ è½½è¿™ä¸ªç¨‹åºçš„ä»£ç åˆ°å†…å­˜ï¼Œè¿™æ—¶å€™å°±å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹</li><li>è¿›ç¨‹å°±å¯ä»¥è§†ä¸ºç¨‹åºçš„ä¸€ä¸ªå®ä¾‹ï¼Œå¤§éƒ¨åˆ†ç¨‹åºéƒ½å¯ä»¥è¿è¡Œå¤šä¸ªå®ä¾‹è¿›ç¨‹ï¼ˆä¾‹å¦‚è®°äº‹æœ¬ï¼Œæµè§ˆå™¨ç­‰ï¼‰ï¼Œéƒ¨åˆ†åªå¯ä»¥è¿è¡Œä¸€ä¸ªå®ä¾‹è¿›ç¨‹ï¼ˆä¾‹å¦‚360å®‰å…¨å«å£«ï¼‰</li><li>è¿›ç¨‹æ˜¯æ‹¥æœ‰èµ„æºçš„ç‹¬ç«‹å•ä½ã€è¿›ç¨‹æ˜¯ç‹¬ç«‹è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½</li></ul><h3 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h3><ul><li>ä¸€ä¸ªè¿›ç¨‹ä¹‹å†…å¯ä»¥åˆ†ä¸ºä¸€åˆ°å¤šä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯ç³»ç»Ÿç‹¬ç«‹è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½</li><li>ä¸€ä¸ªçº¿ç¨‹å°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤æµï¼Œå°†æŒ‡ä»¤æµä¸­çš„ä¸€æ¡æ¡æŒ‡ä»¤ä»¥ä¸€å®šçš„é¡ºåºäº¤ç»™ CPU æ‰§è¡Œ</li><li>Java ä¸­ï¼Œçº¿ç¨‹ä½œä¸ºæœ€å°è°ƒåº¦å•ä½ï¼Œè¿›ç¨‹ä½œä¸ºèµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚ åœ¨ windows ä¸­è¿›ç¨‹æ˜¯ä¸æ´»åŠ¨çš„ï¼Œåªæ˜¯ä½œ ä¸ºçº¿ç¨‹çš„å®¹å™¨ï¼ˆè¿™é‡Œæ„Ÿè§‰è¦å­¦äº†è®¡ç®—æœºç»„æˆåŸç†ä¹‹åä¼šæ›´æœ‰æ„Ÿè§‰å§ï¼ï¼‰</li></ul><h3 id="äºŒè€…å¯¹æ¯”"><a href="#äºŒè€…å¯¹æ¯”" class="headerlink" title="äºŒè€…å¯¹æ¯”"></a>äºŒè€…å¯¹æ¯”</h3><ul><li> è°ƒåº¦</li></ul><p>  çº¿ç¨‹è°ƒåº¦å¿«ï¼Œéœ€è¦ç©ºé—´å°ã€‚</p><p>   è¿›ç¨‹å› æ‹¥æœ‰èµ„æºï¼Œè°ƒåº¦æ—¶å› è´Ÿæ‹…è¿‡é‡è€Œç¼“æ…¢ã€‚</p><ul><li><p>å¹¶å‘æ€§</p><p> åœ¨å¼•å…¥çº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œä¸ä»…è¿›ç¨‹ä¹‹é—´å¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹ä¹‹é—´äº¦å¯å¹¶å‘æ‰§è¡Œã€‚</p></li><li><p>æ‹¥æœ‰èµ„æº</p><p>  è¿›ç¨‹æ˜¯èµ„æºçš„æ‹¥æœ‰è€…</p></li><li><p>ç³»ç»Ÿå¼€é”€</p><p> è¿›ç¨‹åˆ‡æ¢çš„å¼€é”€è¿œè¿œå¤§äºçº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œçº¿ç¨‹çš„ åˆ‡æ¢çœå»äº†èµ„æºçš„å›æ”¶ã€‚</p></li></ul><h2 id="å¹¶è¡Œä¸å¹¶å‘"><a href="#å¹¶è¡Œä¸å¹¶å‘" class="headerlink" title="å¹¶è¡Œä¸å¹¶å‘"></a>å¹¶è¡Œä¸å¹¶å‘</h2><h3 id="å¹¶å‘"><a href="#å¹¶å‘" class="headerlink" title="å¹¶å‘"></a>å¹¶å‘</h3><p>åœ¨å•æ ¸ cpu ä¸‹ï¼Œçº¿ç¨‹å®é™…è¿˜æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚æ“ä½œç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç»„ä»¶å«åš<strong>ä»»åŠ¡è°ƒåº¦å™¨</strong>ï¼Œå°† cpu çš„æ—¶é—´ç‰‡ï¼ˆwindows ä¸‹æ—¶é—´ç‰‡æœ€å°çº¦ä¸º 15 æ¯«ç§’ï¼‰åˆ†ç»™ä¸åŒçš„ç¨‹åºä½¿ç”¨ï¼Œåªæ˜¯ç”±äº cpu åœ¨çº¿ç¨‹é—´ï¼ˆæ—¶é—´ç‰‡å¾ˆçŸ­ï¼‰çš„åˆ‡æ¢éå¸¸å¿«ï¼Œäººç±»æ„Ÿè§‰æ˜¯<strong>åŒæ—¶è¿è¡Œ</strong>çš„ï¼ˆ<strong>é€»è¾‘</strong>ä¸ŠåŒæ—¶å‘ç”Ÿï¼‰ ã€‚ä¸€èˆ¬ä¼šå°†è¿™ç§çº¿ç¨‹è½®æµä½¿ç”¨ CPU çš„åšæ³•ç§°ä¸ºå¹¶å‘ï¼ˆconcurrentï¼‰</p><p><img src="https://gitee.com/gu_chun_bo/picture/raw/master/image/20200305194534-433138.png" alt="1583408729416"></p><h3 id="å¹¶è¡Œ"><a href="#å¹¶è¡Œ" class="headerlink" title="å¹¶è¡Œ"></a>å¹¶è¡Œ</h3><p>å¤šæ ¸ cpuä¸‹ï¼Œæ¯ä¸ªæ ¸ï¼ˆcoreï¼‰ éƒ½å¯ä»¥è°ƒåº¦è¿è¡Œçº¿ç¨‹ï¼Œè¿™æ—¶å€™çº¿ç¨‹å¯ä»¥æ˜¯å¹¶è¡Œçš„ï¼Œä¸åŒçš„çº¿ç¨‹åŒæ—¶ä½¿ç”¨ä¸åŒçš„cpuåœ¨æ‰§è¡Œï¼ˆ<strong>ç‰©ç†</strong>ä¸ŠåŒæ—¶å‘ç”Ÿï¼‰ã€‚</p><p><img src="https://gitee.com/gu_chun_bo/picture/raw/master/image/20200305194655-483025.png" alt="1583408812725"></p><h3 id="äºŒè€…å¯¹æ¯”-1"><a href="#äºŒè€…å¯¹æ¯”-1" class="headerlink" title="äºŒè€…å¯¹æ¯”"></a>äºŒè€…å¯¹æ¯”</h3><p>å¼•ç”¨ Rob Pike çš„ä¸€æ®µæè¿°ï¼šå¹¶å‘ï¼ˆconcurrentï¼‰æ˜¯åŒä¸€æ—¶é—´åº”å¯¹ï¼ˆdealing withï¼‰å¤šä»¶äº‹æƒ…çš„èƒ½åŠ›ï¼Œå¹¶è¡Œï¼ˆparallelï¼‰æ˜¯åŒä¸€æ—¶é—´åŠ¨æ‰‹åšï¼ˆdoingï¼‰å¤šä»¶äº‹æƒ…çš„èƒ½åŠ›</p><ul><li>å®¶åº­ä¸»å¦‡åšé¥­ã€æ‰“æ‰«å«ç”Ÿã€ç»™å­©å­å–‚å¥¶ï¼Œå¥¹ä¸€ä¸ªäººè½®æµäº¤æ›¿åšè¿™å¤šä»¶äº‹ï¼Œè¿™æ—¶å°±æ˜¯å¹¶å‘</li><li>é›‡äº†3ä¸ªä¿å§†ï¼Œä¸€ä¸ªä¸“åšé¥­ã€ä¸€ä¸ªä¸“æ‰“æ‰«å«ç”Ÿã€ä¸€ä¸ªä¸“å–‚å¥¶ï¼Œäº’ä¸å¹²æ‰°ï¼Œè¿™æ—¶æ˜¯å¹¶è¡Œ</li><li>å®¶åº­ä¸»å¦‡é›‡äº†ä¸ªä¿å§†ï¼Œå¥¹ä»¬ä¸€èµ·è¿™äº›äº‹ï¼Œè¿™æ—¶æ—¢æœ‰å¹¶å‘ï¼Œä¹Ÿæœ‰å¹¶è¡Œï¼ˆè¿™æ—¶ä¼šäº§ç”Ÿç«äº‰ï¼Œä¾‹å¦‚é”…åªæœ‰ä¸€å£ï¼Œä¸€ ä¸ªäººç”¨é”…æ—¶ï¼Œå¦ä¸€ä¸ªäººå°±å¾—ç­‰å¾…ï¼‰</li></ul><h1 id="åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ"><a href="#åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ"></a>åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ</h1><p>ä»¥è°ƒç”¨æ–¹çš„è§’åº¦è®²ï¼Œå¦‚æœéœ€è¦ç­‰å¾…ç»“æœè¿”å›æ‰èƒ½ç»§ç»­è¿è¡Œçš„è¯å°±æ˜¯åŒæ­¥ï¼Œå¦‚æœä¸éœ€è¦ç­‰å¾…å°±æ˜¯å¼‚æ­¥</p><h4 id="1-è®¾è®¡"><a href="#1-è®¾è®¡" class="headerlink" title="1) è®¾è®¡"></a>1) è®¾è®¡</h4><p>å¤šçº¿ç¨‹å¯ä»¥ä½¿æ–¹æ³•çš„æ‰§è¡Œå˜æˆå¼‚æ­¥çš„ï¼Œæ¯”å¦‚è¯´è¯»å–ç£ç›˜æ–‡ä»¶æ—¶ï¼Œå‡è®¾è¯»å–æ“ä½œèŠ±è´¹äº†5ç§’ï¼Œå¦‚æœæ²¡æœ‰çº¿ç¨‹çš„è°ƒåº¦æœºåˆ¶ï¼Œè¿™ä¹ˆcpuåªèƒ½ç­‰5ç§’ï¼Œå•¥éƒ½ä¸èƒ½åšã€‚</p><h4 id="2-ç»“è®º"><a href="#2-ç»“è®º" class="headerlink" title="2) ç»“è®º"></a>2) ç»“è®º</h4><ul><li>æ¯”å¦‚åœ¨é¡¹ç›®ä¸­ï¼Œè§†é¢‘æ–‡ä»¶éœ€è¦è½¬æ¢æ ¼å¼ç­‰æ“ä½œæ¯”è¾ƒè´¹æ—¶ï¼Œè¿™æ—¶å¼€ä¸€ä¸ªæ–°çº¿ç¨‹å¤„ç†è§†é¢‘è½¬æ¢ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹</li><li>tomcat çš„å¼‚æ­¥ servlet ä¹Ÿæ˜¯ç±»ä¼¼çš„ç›®çš„ï¼Œè®©ç”¨æˆ·çº¿ç¨‹å¤„ç†è€—æ—¶è¾ƒé•¿çš„æ“ä½œï¼Œé¿å…é˜»å¡ tomcat çš„å·¥ä½œçº¿ç¨‹</li><li>ui ç¨‹åºä¸­ï¼Œå¼€çº¿ç¨‹è¿›è¡Œå…¶ä»–æ“ä½œï¼Œé¿å…é˜»å¡ ui çº¿ç¨‹</li></ul><h1 id="Javaçº¿ç¨‹"><a href="#Javaçº¿ç¨‹" class="headerlink" title="Javaçº¿ç¨‹"></a>Javaçº¿ç¨‹</h1><p>æ–¹æ³•ä¸€ï¼Œç›´æ¥ä½¿ç”¨Threadï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ„é€ æ–¹æ³•çš„å‚æ•°æ˜¯ç»™çº¿ç¨‹æŒ‡å®šåå­—ï¼Œï¼Œæ¨èç»™çº¿ç¨‹èµ·ä¸ªåå­—</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="string">&quot;t1&quot;</span>) &#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="comment">// run æ–¹æ³•å†…å®ç°äº†è¦æ‰§è¡Œçš„ä»»åŠ¡</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line"> log.debug(<span class="string">&quot;hello&quot;</span>);&#125;&#125;;</span><br><span class="line">t1.start();</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼Œä½¿ç”¨ Runnable é…åˆ Thread</p><p>æŠŠã€çº¿ç¨‹ã€‘å’Œã€ä»»åŠ¡ã€‘ï¼ˆè¦æ‰§è¡Œçš„ä»£ç ï¼‰åˆ†å¼€ï¼ŒThread ä»£è¡¨çº¿ç¨‹ï¼ŒRunnable å¯è¿è¡Œçš„ä»»åŠ¡ï¼ˆçº¿ç¨‹è¦æ‰§è¡Œçš„ä»£ç ï¼‰Test2.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä»»åŠ¡å¯¹è±¡</span></span><br><span class="line"><span class="type">Runnable</span> <span class="variable">task2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line"> log.debug(<span class="string">&quot;hello&quot;</span>);&#125;&#125;;</span><br><span class="line"><span class="comment">// å‚æ•°1 æ˜¯ä»»åŠ¡å¯¹è±¡; å‚æ•°2 æ˜¯çº¿ç¨‹åå­—ï¼Œæ¨èç»™çº¿ç¨‹èµ·ä¸ªåå­—</span></span><br><span class="line"><span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(task2, <span class="string">&quot;t2&quot;</span>);</span><br><span class="line">t2.start();</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨(åŒ¿åå†…éƒ¨ç±»)ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                xx&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis</title>
      <link href="/2022/03/28/Redis/"/>
      <url>/2022/03/28/Redis/</url>
      
        <content type="html"><![CDATA[<h1 id="Redisæ˜¯ä¸€æ¬¾key-valueå­˜å‚¨ç»“æ„çš„å†…å­˜çº§NoSQLæ•°æ®åº“"><a href="#Redisæ˜¯ä¸€æ¬¾key-valueå­˜å‚¨ç»“æ„çš„å†…å­˜çº§NoSQLæ•°æ®åº“" class="headerlink" title="Redisæ˜¯ä¸€æ¬¾key-valueå­˜å‚¨ç»“æ„çš„å†…å­˜çº§NoSQLæ•°æ®åº“"></a>Redisæ˜¯ä¸€æ¬¾key-valueå­˜å‚¨ç»“æ„çš„å†…å­˜çº§NoSQLæ•°æ®åº“</h1><h2 id="windowsç‰ˆæœ¬"><a href="#windowsç‰ˆæœ¬" class="headerlink" title="windowsç‰ˆæœ¬"></a>windowsç‰ˆæœ¬</h2><p>åœ¨å…¶å®‰è£…ç›®å½•ä¸­æ‰“å¼€å‘½ä»¤è¡Œå¯åŠ¨æœåŠ¡ç«¯ï¼š<br><code>redis-server.exe redis.windows.conf</code></p><p>åœ¨æ–°çš„å‘½ä»¤çª—å£å¯åŠ¨å®¢æˆ·ç«¯ï¼š<code>redis-cli</code> å¼€å§‹è¿›è¡Œæ•°æ®åº“æ“ä½œ</p><p>set name value        â†’       set name zzw</p><p>get name                     â†’          zzw</p><p>hset key field value      â†’       hset keya a1 zzw</p><p>hget key field               â†’        hget keya a1             â†’       zzw</p><h2 id="Spring-Bootæ•´åˆRedis"><a href="#Spring-Bootæ•´åˆRedis" class="headerlink" title="Spring Bootæ•´åˆRedis"></a>Spring Bootæ•´åˆRedis</h2><p>æ·»åŠ ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶æ·»åŠ æ“ä½œRedisæ¥å£å¯¹è±¡ RedisTemplateï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line">    <span class="type">ValueOperations</span> <span class="variable">ops</span> <span class="operator">=</span> redisTemplate.opsForValue(); </span><br><span class="line">    ops.set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;value&quot;</span>);       </span><br><span class="line">    ops.get(<span class="string">&quot;name&quot;</span>);                </span><br></pre></td></tr></table></figure><h3 id="åœ¨å®¢æˆ·ç«¯æ“ä½œredisæ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼"><a href="#åœ¨å®¢æˆ·ç«¯æ“ä½œredisæ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼" class="headerlink" title="åœ¨å®¢æˆ·ç«¯æ“ä½œredisæ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼"></a>åœ¨å®¢æˆ·ç«¯æ“ä½œredisæ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼</h3><h3 id="åœ¨SpringBootä¸­æ“ä½œç”¨RedisTemplateæ˜¯ä»¥å¯¹è±¡çš„å½¢å¼"><a href="#åœ¨SpringBootä¸­æ“ä½œç”¨RedisTemplateæ˜¯ä»¥å¯¹è±¡çš„å½¢å¼" class="headerlink" title="åœ¨SpringBootä¸­æ“ä½œç”¨RedisTemplateæ˜¯ä»¥å¯¹è±¡çš„å½¢å¼"></a>åœ¨SpringBootä¸­æ“ä½œç”¨RedisTemplateæ˜¯ä»¥å¯¹è±¡çš„å½¢å¼</h3><h3 id="è¦æƒ³ä¿æŒä¸€è‡´-ä½¿ç”¨StringRedisTemplateæ¥å£å¯¹è±¡-å¸¸ç”¨"><a href="#è¦æƒ³ä¿æŒä¸€è‡´-ä½¿ç”¨StringRedisTemplateæ¥å£å¯¹è±¡-å¸¸ç”¨" class="headerlink" title="è¦æƒ³ä¿æŒä¸€è‡´ ä½¿ç”¨StringRedisTemplateæ¥å£å¯¹è±¡(å¸¸ç”¨)"></a>è¦æƒ³ä¿æŒä¸€è‡´ ä½¿ç”¨StringRedisTemplateæ¥å£å¯¹è±¡(å¸¸ç”¨)</h3><h1 id="jedis"><a href="#jedis" class="headerlink" title="jedis"></a>jedis</h1><p><strong>jedis</strong>å°±æ˜¯åŸºäºjavaè¯­è¨€çš„rediså®¢æˆ·ç«¯ï¼Œé›†æˆäº†redisçš„å‘½ä»¤æ“ä½œï¼Œæä¾›äº†è¿æ¥æ± ç®¡ç†ã€‚</p><p>redis-cliæ˜¯rediså®˜æ–¹æä¾›çš„å®¢æˆ·ç«¯ï¼Œå¯ä»¥çœ‹ä½œä¸€ä¸ªshellç¨‹åºï¼Œå®ƒå¯ä»¥å‘é€å‘½ä»¤å¯¹redisè¿›è¡Œæ“ä½œã€‚<br>å¯¹äºjedisåŒç†æ˜¯ä½¿ç”¨javaè¯­è¨€æ“ä½œredisï¼ŒåŒæ–¹éƒ½éµå¾ªredisæä¾›çš„åè®®ï¼ŒæŒ‰ç…§åè®®å¼€å‘å¯¹åº”çš„å®¢æˆ·ç«¯ã€‚</p><p>æ·»åŠ ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;redis.clients&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jedis&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  data:</span><br><span class="line">    redis:</span><br><span class="line">      host: localhost</span><br><span class="line">      port: <span class="number">6379</span></span><br><span class="line">      client-type: jedis</span><br></pre></td></tr></table></figure><h3 id="ä¸lettcusçš„åŒºåˆ«"><a href="#ä¸lettcusçš„åŒºåˆ«" class="headerlink" title="ä¸lettcusçš„åŒºåˆ«"></a>ä¸lettcusçš„åŒºåˆ«</h3><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220329160216629.png" alt="image-20220329160216629"></p><p>jedisç›´è¿ï¼Œæœ¬è´¨æ˜¯å®šä¹‰ä¸€ä¸ªtcpè¿æ¥ï¼Œç„¶åä½¿ç”¨socketæŠ€æœ¯è¿›è¡Œé€šä¿¡</p><p>jedisçš„ç®€å•ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.ç”Ÿæˆä¸€ä¸ªjediså¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è´Ÿè´£å’ŒæŒ‡å®šRedisèŠ‚ç‚¹è¿›è¡Œé€šä¿¡</span></span><br><span class="line">   <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;119.23.226.29&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">   <span class="comment">//å¸¦å¯†ç éœ€è¦æ‰§è¡Œè®¤è¯æ–¹æ³•</span></span><br><span class="line">   <span class="comment">//jedis.auth(&quot;123456&quot;);</span></span><br><span class="line">   <span class="comment">//2.jedisæ‰§è¡Œsetæ“ä½œ</span></span><br><span class="line">   jedis.set(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">   <span class="comment">//3.jedisæ‰§è¡Œgetæ“ä½œï¼Œvalue=&quot;world&quot;</span></span><br><span class="line">   <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> jedis.get(<span class="string">&quot;hello&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Mongodb(Windows)</title>
      <link href="/2022/03/28/Mongodb/"/>
      <url>/2022/03/28/Mongodb/</url>
      
        <content type="html"><![CDATA[<h1 id="Mongodbæ˜¯ä¸€ä¸ªå¼€æºã€é«˜æ€§èƒ½ã€æ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“"><a href="#Mongodbæ˜¯ä¸€ä¸ªå¼€æºã€é«˜æ€§èƒ½ã€æ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“" class="headerlink" title="Mongodbæ˜¯ä¸€ä¸ªå¼€æºã€é«˜æ€§èƒ½ã€æ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“"></a>Mongodbæ˜¯ä¸€ä¸ªå¼€æºã€é«˜æ€§èƒ½ã€æ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“</h1><p>å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆï¼š<a href="https://docs.mongoing.com/">https://docs.mongoing.com/</a></p><p>å¯åŠ¨æœåŠ¡ç«¯åœ¨binç›®å½•å‘½ä»¤è¡Œè¾“å…¥ï¼šmongod â€“dbpath=..\data\db         æŒ‡å®šå­˜æ”¾ä½ç½®</p><p>å¯åŠ¨mongodbæœåŠ¡æ—¶éœ€è¦å…ˆç¡®å®šæ•°æ®åº“æ–‡ä»¶å­˜æ”¾çš„ä½ç½®ï¼Œå¦åˆ™ç³»ç»Ÿä¸ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå¯åŠ¨ä¼šä¸æˆåŠŸã€‚</p><p>å®¢æˆ·ç«¯å¯åŠ¨ï¼š mogo â€“host=127.0.0.1 â€“port=27017     é»˜è®¤ç«¯å£æ˜¯27017</p><p>å½“æ³¨å†Œåˆ°æœ¬åœ°æœåŠ¡åå°±ä¸ç”¨é‚£ä¹ˆéº»çƒ¦(ä¼šé»˜è®¤ä¸€ç›´å¯åŠ¨) é€šè¿‡net start /stop æœåŠ¡å æˆ‘è¿™é‡Œæ˜¯Mongodb å¯åŠ¨ï¼Œå³net start Mongodb</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\mongodb\bin&gt;mongod --dbpath &quot;D:\mongodb\data\db&quot; --logpath &quot;D:\mongodb\data\log\mongodb.log&quot; --serviceName &quot;Mongodb&quot; --serviceDisplayName &quot;Mongodb&quot; --install</span><br></pre></td></tr></table></figure><p>å¯è§†åŒ–å·¥å…· <strong>Robo3T</strong></p><p>æ³¨æ„ mongod å’Œ mongo çš„åŒºåˆ«</p><p>ã€€ã€€å‰è€…æ˜¯å¯ç”¨MongoDBè¿›ç¨‹ï¼Œåè€…æ˜¯å¯¹MongoDBè¿›è¡Œè¿æ¥æ“ä½œ</p><h1 id="Mongodbçš„åŸºæœ¬ä½¿ç”¨"><a href="#Mongodbçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Mongodbçš„åŸºæœ¬ä½¿ç”¨"></a>Mongodbçš„åŸºæœ¬ä½¿ç”¨</h1><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.mongoing.com/mongodb-crud-operations">https://docs.mongoing.com/mongodb-crud-operations</a></p><h3 id="æ ¸å¿ƒæ¦‚å¿µï¼š"><a href="#æ ¸å¿ƒæ¦‚å¿µï¼š" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µï¼š"></a>æ ¸å¿ƒæ¦‚å¿µï¼š</h3><ul><li><p>åº“<DataBase></DataBase></p><p>  mongodbä¸­çš„åº“å°±ç±»ä¼¼äºä¼ ç»Ÿå…³ç³»å‹<strong>æ•°æ®åº“</strong>ä¸­åº“çš„æ¦‚å¿µï¼Œç”¨æ¥é€šè¿‡ä¸åŒåº“éš”ç¦»ä¸åŒåº”ç”¨æ•°æ®ã€‚ mongodbä¸­å¯ä»¥å»ºç«‹å¤šä¸ªæ•°æ®åº“ã€‚æ¯ä¸€ä¸ªåº“éƒ½æœ‰è‡ªå·±çš„é›†åˆå’Œæƒé™ï¼Œä¸åŒçš„æ•°æ®åº“ä¹Ÿæ”¾ç½®åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚é»˜è®¤çš„æ•°æ®åº“ä¸ºâ€testâ€ï¼Œæ•°æ®åº“å­˜å‚¨åœ¨å¯åŠ¨æŒ‡å®šçš„dataç›®å½•ä¸­ã€‚</p></li><li><p>é›†åˆ<collection></collection></p><p>é›†åˆå°±æ˜¯ MongoDB æ–‡æ¡£ç»„ï¼Œç±»ä¼¼äº RDBMS (å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ:Relational Database Management System)ä¸­çš„<strong>è¡¨</strong>çš„æ¦‚å¿µã€‚<br>é›†åˆå­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œä¸€ä¸ªåº“ä¸­å¯ä»¥åˆ›å»ºå¤šä¸ªé›†åˆã€‚æ¯ä¸ªé›†åˆæ²¡æœ‰å›ºå®šçš„ç»“æ„ï¼Œè¿™æ„å‘³ç€ä½ åœ¨å¯¹é›†åˆå¯ä»¥æ’å…¥ä¸åŒæ ¼å¼å’Œç±»å‹çš„æ•°æ®ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ’å…¥é›†åˆçš„æ•°æ®éƒ½ä¼šæœ‰ä¸€å®šçš„å…³è”æ€§ã€‚</p></li><li><p>æ–‡æ¡£<Document></Document></p><p>æ–‡æ¡£é›†åˆä¸­ä¸€æ¡æ¡è®°å½•ï¼Œæ˜¯ä¸€ç»„**é”®å€¼(**key-value)å¯¹(å³BSON)ã€‚MongoDBçš„æ–‡æ¡£ä¸éœ€è¦è®¾ç½®ç›¸åŒçš„å­—æ®µï¼Œå¹¶ä¸”ç›¸åŒçš„å­—æ®µä¸éœ€è¦ç›¸åŒçš„æ•°æ®ç±»å‹ï¼Œè¿™ä¸å…³ç³»å‹æ•°æ®åº“æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œä¹Ÿæ˜¯MongoDBéå¸¸çªå‡ºçš„ç‰¹ç‚¹ã€‚</p></li><li><p>æ–‡æ¡£ç¤ºä¾‹ï¼š{â€œnameâ€:â€zzwâ€,â€siteâ€:â€<a href="https://deimos.magi-verse.com/&quot;%7D">https://deimos.magi-verse.com/&quot;}</a></p></li></ul><h3 id="åŸºæœ¬ä½¿ç”¨ï¼š"><a href="#åŸºæœ¬ä½¿ç”¨ï¼š" class="headerlink" title="åŸºæœ¬ä½¿ç”¨ï¼š"></a>åŸºæœ¬ä½¿ç”¨ï¼š</h3><p>åˆ›å»ºæ•°æ®åº“ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> use åº“å; <span class="operator">/</span><span class="operator">/</span>åˆ›å»ºå¹¶ä½¿ç”¨ï¼Œå½“åº“ä¸­æ²¡æœ‰æ•°æ®æ—¶é»˜è®¤ä¸æ˜¾ç¤ºè¿™ä¸ªåº“</span><br></pre></td></tr></table></figure><p>åˆ é™¤æ•°æ®åº“ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨å½“å‰åº“ä¸­ <span class="operator">&gt;</span> db.dropDatabase();</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰æ‰€åœ¨åº“ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹åº“ä¸­æ‰€æœ‰é›†åˆï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="keyword">show</span> collection<span class="operator">/</span>tables; </span><br></pre></td></tr></table></figure><p>åˆ›å»ºé›†åˆï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.createCollection(&quot;é›†åˆåç§°&quot;,[options])</span><br><span class="line">optionså¯ä»¥æ˜¯ä»¥ä¸‹å‚æ•°ï¼šcappedã€sizeã€max</span><br></pre></td></tr></table></figure><p>åˆ é™¤é›†åˆï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">drop</span>();</span><br></pre></td></tr></table></figure><h3 id="å¢åŠ æ–‡æ¡£"><a href="#å¢åŠ æ–‡æ¡£" class="headerlink" title="å¢åŠ æ–‡æ¡£"></a>å¢åŠ æ–‡æ¡£</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">insert</span><span class="operator">/</span>save(&#123;&quot;name&quot;:&quot;springboot&quot;&#125;);</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">insert</span>([&#123;&quot;name&quot;:&quot;springboot&quot;&#125;,&#123;&quot;name&quot;:&quot;springcloud&quot;&#125;]);</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢æ–‡æ¡£"><a href="#æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="æŸ¥è¯¢æ–‡æ¡£"></a>æŸ¥è¯¢æ–‡æ¡£</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(); <span class="operator">/</span><span class="operator">/</span>æŸ¥è¯¢å…¨éƒ¨</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find().pretty(); <span class="operator">/</span><span class="operator">/</span>ä»¥æ ¼å¼åŒ–çš„æ–¹å¼æ˜¾ç¤º</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(&#123;name:&quot;xxxx&quot;&#125;); <span class="operator">/</span><span class="operator">/</span>æŸ¥è¯¢æ¡ä»¶</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(&#123;æ•°ç»„:&#123;$size:<span class="number">3</span>&#125;&#125;); <span class="operator">/</span><span class="operator">/</span>æŒ‰ç…§æ•°ç»„é•¿åº¦æŸ¥è¯¢</span><br></pre></td></tr></table></figure><ul><li>æ›´å¤šæ ¼å¼ï¼š</li></ul><p><img src="/2022/03/28/Mongodb/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220505210511917.png" alt="image-20220505210511917"></p><ul><li><p>AND</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(&#123;æ¡ä»¶<span class="number">1</span>,æ¡ä»¶<span class="number">2</span>&#125;); <span class="operator">/</span><span class="operator">/</span>ç›¸åŒå­—æ®µåšå¤šæ¬¡æŸ¥è¯¢ï¼Œåªå·®æœ€åä¸€ä¸ªæ¡ä»¶</span><br></pre></td></tr></table></figure></li><li><p>OR</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(&#123;$<span class="keyword">or</span>:[&#123;æ¡ä»¶&#125;]&#125;);</span><br></pre></td></tr></table></figure></li><li><p>æ’åº</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find().sort(&#123;å­—æ®µ:<span class="number">1</span>,å­—æ®µ<span class="number">2</span>:<span class="number">-1</span>&#125;); <span class="operator">/</span><span class="operator">/</span><span class="number">1</span>è¡¨ç¤ºå‡åºï¼Œ<span class="number">-1</span>è¡¨ç¤ºé™åº</span><br></pre></td></tr></table></figure></li><li><p>åˆ†é¡µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find().<span class="keyword">skip</span>(èµ·å§‹æ¡æ•°).limit(<span class="keyword">rows</span>);</span><br></pre></td></tr></table></figure></li><li><p>æ¨¡ç³ŠæŸ¥è¯¢(ç±»ä¼¼mysqlä¸­çš„  % â†’ / ) </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(&#123;name:<span class="operator">/</span>å¼ <span class="operator">/</span>&#125;); <span class="operator">/</span><span class="operator">/</span>æ³¨æ„æ²¡æœ‰åŒå¼•å·</span><br><span class="line">ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥è¿‘ä¼¼å®ç°æ¨¡ç³ŠæŸ¥è¯¢</span><br></pre></td></tr></table></figure></li><li><p>æ€»æ¡æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find().<span class="built_in">count</span>();</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(æ¡ä»¶).<span class="built_in">count</span>(); <span class="operator">/</span><span class="operator">/</span>ç¬¦åˆæ¡ä»¶çš„æ€»æ¡æ•°</span><br></pre></td></tr></table></figure></li><li><p>å»é‡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">distinct</span>(å­—æ®µ)</span><br><span class="line">å°†å»é‡åçš„å­—æ®µä»¥æ•°ç»„å½¢å¼è¿”å›</span><br></pre></td></tr></table></figure></li><li><p>æŒ‡å®šè¿”å›å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.find(&#123;æ¡ä»¶&#125;,&#123;å­—æ®µ:<span class="number">1</span>,å­—æ®µ:<span class="number">0</span>&#125;);</span><br><span class="line"><span class="number">1</span>è¡¨ç¤ºè¿”å›ï¼Œ<span class="number">0</span>è¡¨ç¤ºä¸è¿”å›ï¼Œæ³¨æ„å®ƒä»¬ä¸èƒ½åŒæ—¶ä½¿ç”¨</span><br></pre></td></tr></table></figure></li></ul><h3 id="åˆ é™¤æ–‡æ¡£"><a href="#åˆ é™¤æ–‡æ¡£" class="headerlink" title="åˆ é™¤æ–‡æ¡£"></a>åˆ é™¤æ–‡æ¡£</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.remove(&#123;æ¡ä»¶&#125;); </span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.remove(&#123;&#125;);  <span class="operator">/</span><span class="operator">/</span>åˆ é™¤æ‰€æœ‰æ–‡æ¡£</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ–‡æ¡£"><a href="#ä¿®æ”¹æ–‡æ¡£" class="headerlink" title="ä¿®æ”¹æ–‡æ¡£"></a>ä¿®æ”¹æ–‡æ¡£</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">update</span>(&#123;name:&quot;è¦ä¿®æ”¹çš„&quot;&#125;,&#123;$<span class="keyword">set</span>:&#123;name:&quot;ä¿®æ”¹æˆ&quot;&#125;&#125;);   <span class="operator">/</span><span class="operator">/</span>æ”¹ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">update</span>(&#123;name:&quot;è¦ä¿®æ”¹çš„&quot;&#125;,&#123;$<span class="keyword">set</span>:&#123;name:&quot;ä¿®æ”¹æˆ&quot;&#125;&#125;,&#123;multi:<span class="literal">true</span>&#125;);   <span class="operator">/</span><span class="operator">/</span>æ”¹æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.<span class="keyword">update</span>(&#123;name:&quot;è¦ä¿®æ”¹çš„&quot;&#125;,&#123;$<span class="keyword">set</span>:&#123;name:&quot;ä¿®æ”¹æˆ&quot;&#125;&#125;,&#123;upsert:<span class="literal">true</span>&#125;);  <span class="operator">/</span><span class="operator">/</span>æ²¡æœ‰æ¡ä»¶ç¬¦åˆæ—¶æ’å…¥è¯¥æ•°æ®</span><br><span class="line"><span class="operator">&gt;</span> db.é›†åˆ.updatemany</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220329163400255.png" alt="image-20220329163400255"></p><h2 id="typeæ“ä½œç¬¦"><a href="#typeæ“ä½œç¬¦" class="headerlink" title="$typeæ“ä½œç¬¦"></a>$typeæ“ä½œç¬¦</h2><p>$typeæ“ä½œç¬¦æ˜¯åŸºäºBSONç±»å‹æ¥æ£€ç´¢é›†åˆä¸­åŒ¹é…çš„æ•°æ®ç±»å‹å¹¶è¿”å›</p><p><img src="/2022/03/28/Mongodb/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220505213920285.png" alt="image-20220505213920285"></p><p>åœ¨æ–‡æ¡£æŸ¥è¯¢æ—¶å¯ä»¥ç”¨$typeæŸ¥è¯¢ç±»å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.é›†åˆ.find(&#123;key:&#123;$type:2&#125;&#125;); //æŸ¥è¯¢é›†åˆä¸­keyä¸ºStringçš„æ•°æ®</span><br><span class="line">æˆ–</span><br><span class="line">&gt; db.é›†åˆ.find(&#123;key:&#123;$type:&#x27;String&#x27;&#125;&#125;); //æŸ¥è¯¢é›†åˆä¸­keyä¸ºStringçš„æ•°æ®</span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•<index></index></h2><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.mongoing.com/indexes">https://docs.mongoing.com/indexes</a></p><p>ç´¢å¼•æ˜¯ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ªæ˜“äºè¯»å–çš„æ•°æ®é›†åˆä¸­ï¼Œç´¢å¼•æ˜¯å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§ç»“æ„ã€‚</p><h1 id="Spring-Bootæ•´åˆMongodb"><a href="#Spring-Bootæ•´åˆMongodb" class="headerlink" title="Spring Bootæ•´åˆMongodb"></a>Spring Bootæ•´åˆMongodb</h1><p>æ·»åŠ ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶æ·»åŠ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  data:</span><br><span class="line">    mongodb:</span><br><span class="line">      uri: mongodb:<span class="comment">//localhost/test    æŒ‡å®šæ•°æ®åº“å</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶æ·»åŠ æ“ä½œmongodbçš„æ¥å£å¯¹è±¡MongoTemplate</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> MongoTemplate mt;</span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">       book b=<span class="keyword">new</span> <span class="title class_">book</span>();</span><br><span class="line">       b.setId(<span class="number">2</span>);b.setName(<span class="string">&quot;è¥¿æ¸¸è®°&quot;</span>);b.setPublishTime(<span class="number">1222</span>);b.setUuid(<span class="string">&quot;1234&quot;</span>);</span><br><span class="line">           mt.save(b);&#125;</span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">       List&lt;book&gt; all = mt.findAll(book.class);</span><br><span class="line">       System.out.println(all);&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloud</title>
      <link href="/2021/10/03/SpringCloud/"/>
      <url>/2021/10/03/SpringCloud/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul><li><p><strong>å•ä½“æ¶æ„</strong>ï¼šå°†ä¸šåŠ¡çš„æ‰€æœ‰åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å¼€å‘ï¼Œæ‰“æˆä¸€ä¸ªåŒ…éƒ¨ç½²ã€‚</p><p><strong>ä¼˜ç‚¹ï¼š</strong>æ¶æ„ç®€å•ï¼Œéƒ¨ç½²æˆæœ¬ä½  </p><p><strong>ç¼ºç‚¹ï¼š</strong>è€¦åˆåº¦é«˜ï¼ˆç»´æŠ¤å›°éš¾ã€å‡çº§å›°éš¾ï¼‰</p></li><li><p><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šæ ¹æ®ä¸šåŠ¡åŠŸèƒ½å¯¹ç³»ç»Ÿåšæ‹†åˆ†ï¼Œæ¯ä¸ªä¸šåŠ¡åŠŸèƒ½æ¨¡å—ä½œä¸ºç‹¬ç«‹é¡¹ç›®å¼€å‘ï¼Œç§°ä¸ºä¸€ä¸ªæœåŠ¡ã€‚</p><p><strong>ä¼˜ç‚¹ï¼š</strong>é™ä½æœåŠ¡è€¦åˆï¼Œæœ‰åˆ©äºæœåŠ¡å‡çº§å’Œæ‹“å±•</p><p><strong>ç¼ºç‚¹ï¼š</strong>æœåŠ¡è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚</p></li></ul><p>å¾®æœåŠ¡çš„æ¶æ„ç‰¹å¾ï¼š</p><ul><li><p>å•ä¸€èŒè´£ï¼šå¾®æœåŠ¡æ‹†åˆ†ç²’åº¦æ›´å°ï¼Œæ¯ä¸€ä¸ªæœåŠ¡éƒ½å¯¹åº”å”¯ä¸€çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œåšåˆ°å•ä¸€èŒè´£</p></li><li><p>è‡ªæ²»ï¼šå›¢é˜Ÿç‹¬ç«‹ã€æŠ€æœ¯ç‹¬ç«‹ã€æ•°æ®ç‹¬ç«‹ï¼Œç‹¬ç«‹éƒ¨ç½²å’Œäº¤ä»˜</p></li><li><p>é¢å‘æœåŠ¡ï¼šæœåŠ¡æä¾›ç»Ÿä¸€æ ‡å‡†çš„æ¥å£ï¼Œä¸è¯­è¨€å’ŒæŠ€æœ¯æ— å…³</p></li><li><p>éš”ç¦»æ€§å¼ºï¼šæœåŠ¡è°ƒç”¨åšå¥½éš”ç¦»ã€å®¹é”™ã€é™çº§ï¼Œé¿å…å‡ºç°çº§è”é—®é¢˜</p></li></ul><p>SpringCloud æ˜¯ç›®å‰å›½å†…ä½¿ç”¨æœ€å¹¿æ³›çš„å¾®æœåŠ¡æ¡†æ¶ã€‚å®˜ç½‘åœ°å€ï¼š<a href="https://spring.io/projects/spring-cloud%E3%80%82">https://spring.io/projects/spring-cloudã€‚</a></p><p>SpringCloud é›†æˆäº†å„ç§å¾®æœåŠ¡åŠŸèƒ½ç»„ä»¶ï¼Œå¹¶åŸºäº SpringBoot å®ç°äº†è¿™äº›ç»„ä»¶çš„è‡ªåŠ¨è£…é…ï¼Œä»è€Œæä¾›äº†è‰¯å¥½çš„å¼€ç®±å³ç”¨ä½“éªŒã€‚</p><h1 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h1><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220323213604059.png" alt="image-20220323213604059"></p><p>æ³¨æ„Spring Cloudå’ŒSpring Boot æœ‰ç‰ˆæœ¬å…¼å®¹å…³ç³»(æˆªæ­¢2022.04)</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220419163420334.png" alt="image-20220419163420334"></p><h1 id="åˆ›å»ºSpring-Cloudé¡¹ç›®"><a href="#åˆ›å»ºSpring-Cloudé¡¹ç›®" class="headerlink" title="åˆ›å»ºSpring Cloudé¡¹ç›®"></a>åˆ›å»ºSpring Cloudé¡¹ç›®</h1><p>æ³¨æ„åœ¨çˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶è®¾ç½®å¥½Spring Cloudçš„ç‰ˆæœ¬ï¼Œä¹‹ååœ¨è¯¥çˆ¶å·¥ç¨‹ä¸‹çš„å¾®æœåŠ¡åªéœ€å¼•ç”¨å³å¯(çœå»é‡å¤é…ç½®çš„ä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚mybatisã€mysqlã€lombok)</p><p>æ¯”å¦‚ä¸€ä¸ªçˆ¶å·¥ç¨‹testcloudï¼Œä¾èµ–é…ç½®åœ¨<dependencyManagement>&lt;/<dependencyManagement>é‡Œé¢    (lombokåœ¨å¤–é¢)</dependencyManagement></dependencyManagement></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;artifactId&gt;testcloud&lt;/artifactId&gt;  #çˆ¶å·¥ç¨‹å</span><br><span class="line">&lt;groupId&gt;com&lt;/groupId&gt;              </span><br><span class="line">&lt;version&gt;1.0&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">&lt;packaging&gt;pom&lt;/packaging&gt;   #ç”¨pomæ ¼å¼æ‰“åŒ… é»˜è®¤æ˜¯jar</span><br><span class="line">&lt;modules&gt;                      #æŒ‚è½½çš„æ¨¡å—</span><br><span class="line">    &lt;module&gt;testServer&lt;/module&gt;</span><br><span class="line">    &lt;module&gt;å…¶ä»–å¾®æœåŠ¡&lt;/module&gt;</span><br><span class="line">&lt;/modules&gt;</span><br><span class="line"></span><br><span class="line">&lt;parent&gt;         #ä¹Ÿæ˜¯é€šè¿‡æŒ‡å®šå¤«å·¥ç¨‹ æ¥ç¡®å®šSpring Bootç‰ˆæœ¬</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.6.4&lt;/version&gt;</span><br><span class="line">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;/parent&gt;</span><br></pre></td></tr></table></figure><p>åœ¨å­å·¥ç¨‹ä¸­testServerçš„pomä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent&gt; #æŒ‡å®šçˆ¶å·¥ç¨‹</span><br><span class="line">    &lt;artifactId&gt;testcloud&lt;/artifactId&gt;</span><br><span class="line">    &lt;groupId&gt;com&lt;/groupId&gt;</span><br><span class="line">    &lt;version&gt;1.0&lt;/version&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line">&lt;artifactId&gt;testServer&lt;/artifactId&gt; #è‡ªå·±çš„å·¥ç¨‹å</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå¦‚æœä¸åœ¨çˆ¶å·¥ç¨‹é…ç½®å¥½ï¼Œé‚£æ¯ä¸ªå­å·¥ç¨‹å¯èƒ½éƒ½ä¼šé‡å¤é…ç½®ä¸€äº›ä¸œè¥¿å¦‚Spring Cloudç‰ˆæœ¬ï¼Œä¸æ˜¯ä¸å¯ä»¥ï¼Œå°±æ˜¯åç»­å¾®æœåŠ¡å¤šèµ·æ¥ï¼Œä¾èµ–å˜å¤šï¼Œä¸å¥½ç®¡ç†</p><h1 id="Eureka"><a href="#Eureka" class="headerlink" title="Eureka"></a>Eureka</h1><p>Eurekaç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220323214259865.png" alt="image-20220323214259865"></p><p>åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œä¸¤è€…éƒ½åœ¨çˆ¶å·¥ç¨‹ä¸‹</p><p><strong>order-service å¦‚ä½•å¾—çŸ¥ user-service å®ä¾‹åœ°å€ï¼Ÿ</strong></p><ul><li>user-service æœåŠ¡å®ä¾‹å¯åŠ¨åï¼Œå°†è‡ªå·±çš„ä¿¡æ¯æ³¨å†Œåˆ° eureka-server(EurekaæœåŠ¡ç«¯)ï¼Œå«åš<strong>æœåŠ¡æ³¨å†Œ</strong></li><li>eureka-server ä¿å­˜æœåŠ¡åç§°åˆ°æœåŠ¡å®ä¾‹åœ°å€åˆ—è¡¨çš„æ˜ å°„å…³ç³»</li><li>order-service æ ¹æ®æœåŠ¡åç§°ï¼Œæ‹‰å–å®ä¾‹åœ°å€åˆ—è¡¨ï¼Œè¿™ä¸ªå«<strong>æœåŠ¡å‘ç°</strong>æˆ–æœåŠ¡æ‹‰å–</li></ul><p><strong>order-service å¦‚ä½•ä»å¤šä¸ª user-service å®ä¾‹ä¸­é€‰æ‹©å…·ä½“çš„å®ä¾‹ï¼Ÿ</strong></p><p>order-serviceä»å®ä¾‹åˆ—è¡¨ä¸­åˆ©ç”¨<strong>è´Ÿè½½å‡è¡¡ç®—æ³•</strong>é€‰ä¸­ä¸€ä¸ªå®ä¾‹åœ°å€ï¼Œå‘è¯¥å®ä¾‹åœ°å€å‘èµ·è¿œç¨‹è°ƒç”¨</p><p><strong>order-service å¦‚ä½•å¾—çŸ¥æŸä¸ª user-service å®ä¾‹æ˜¯å¦ä¾ç„¶å¥åº·ï¼Œæ˜¯ä¸æ˜¯å·²ç»å®•æœºï¼Ÿ</strong></p><ul><li>user-service ä¼š<strong>æ¯éš”ä¸€æ®µæ—¶é—´(é»˜è®¤30ç§’)å‘ eureka-server å‘èµ·è¯·æ±‚</strong>ï¼ŒæŠ¥å‘Šè‡ªå·±çŠ¶æ€ï¼Œç§°ä¸º<strong>å¿ƒè·³</strong></li><li>å½“è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å‘é€å¿ƒè·³æ—¶ï¼Œeureka-server ä¼šè®¤ä¸ºå¾®æœåŠ¡å®ä¾‹æ•…éšœï¼Œå°†è¯¥å®ä¾‹ä»æœåŠ¡åˆ—è¡¨ä¸­å‰”é™¤</li><li>order-service æ‹‰å–æœåŠ¡æ—¶ï¼Œå°±èƒ½å°†æ•…éšœå®ä¾‹æ’é™¤äº†</li></ul><h1 id="EurekaServeræœåŠ¡ç«¯é…ç½®ï¼š"><a href="#EurekaServeræœåŠ¡ç«¯é…ç½®ï¼š" class="headerlink" title="EurekaServeræœåŠ¡ç«¯é…ç½®ï¼š"></a>EurekaServeræœåŠ¡ç«¯é…ç½®ï¼š</h1><ul><li><p>å¼•å…¥ä¾èµ–  <code>spring-cloud-starter-netflix-eureka-server</code></p></li><li><p>åœ¨å¯åŠ¨ç±»æ·»åŠ @EnableEurekaServeræ³¨è§£</p></li><li><p>åœ¨é…ç½®æ–‡ä»¶ç¼–å†™ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: <span class="number">10086</span></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: eureka-server <span class="comment">//åœ¨æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åç§°</span></span><br><span class="line"></span><br><span class="line">eureka:</span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http:<span class="comment">//$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span></span><br><span class="line"><span class="comment">//http://127.0.0.1:10086/eureka</span></span><br><span class="line">    register-with-eureka: <span class="literal">true</span> <span class="comment">//æ˜¯å¦æ³¨å†Œè‡ªå·±</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="EurekaClientå®¢æˆ·ç«¯é…ç½®ï¼š"><a href="#EurekaClientå®¢æˆ·ç«¯é…ç½®ï¼š" class="headerlink" title="EurekaClientå®¢æˆ·ç«¯é…ç½®ï¼š"></a>EurekaClientå®¢æˆ·ç«¯é…ç½®ï¼š</h1><ul><li>å¼•å…¥ä¾èµ–   <code>spring-cloud-starter-netflix-eureka-client</code></li><li>åœ¨å¯åŠ¨ç±»æ·»åŠ @EnableEurekaServeræ³¨è§£(å¯ä¸åŠ ï¼Œè¯¦æƒ…å‚è€ƒ<a href="https://blog.csdn.net/sunxy24/article/details/105686511">https://blog.csdn.net/sunxy24/article/details/105686511</a>)</li><li>åœ¨é…ç½®æ–‡ä»¶ç¼–å†™ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: <span class="number">8080</span></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: orderservice <span class="comment">//åœ¨æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åç§°</span></span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    prefer-ip-address: <span class="literal">true</span></span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http:<span class="comment">//127.0.0.1:10086/eureka</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æœåŠ¡è¿œç¨‹è°ƒç”¨"><a href="#æœåŠ¡è¿œç¨‹è°ƒç”¨" class="headerlink" title="æœåŠ¡è¿œç¨‹è°ƒç”¨"></a>æœåŠ¡è¿œç¨‹è°ƒç”¨</h1><p>åœ¨æœåŠ¡è°ƒç”¨ç±»çš„å¯åŠ¨ç±»æ·»åŠ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@LoadBalanced</span> <span class="comment">//è´Ÿè½½å‡è¡¡</span></span><br><span class="line"><span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/03/SpringCloud/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220419233747818.png" alt="image-20220419233747818"></p><h1 id="Ribbonè´Ÿè½½å‡è¡¡"><a href="#Ribbonè´Ÿè½½å‡è¡¡" class="headerlink" title="Ribbonè´Ÿè½½å‡è¡¡"></a>Ribbonè´Ÿè½½å‡è¡¡</h1><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220323233535532.png" alt="image-20220323233535532"></p><p>é»˜è®¤è´Ÿè½½å‡è¡¡æ˜¯ZoneAvoidanceRuleï¼Œè½®è¯¢</p><p>é€šè¿‡å®šä¹‰IRuleå®ç°å¯ä»¥ä¿®æ”¹è´Ÿè´£å‡è¡¡è§„åˆ™ï¼Œè¦åœ¨RestTemplateä¸Šæ·»åŠ **@LoadBalanced**</p><p>ä»£ç æ–¹å¼ï¼Œåœ¨æœåŠ¡è°ƒç”¨ç±»çš„å¯åŠ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–°çš„IRuleï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> IRule <span class="title function_">randomRule</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RandomRule</span>();</span><br><span class="line">&#125;   <span class="comment">//ä¸åŒç­–ç•¥å¯¹åº”ä¸åŒçš„ç±»å</span></span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶æ–¹å¼ï¼šåœ¨æœåŠ¡è°ƒç”¨ç±»çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">userservice(è°ƒç”¨çš„æœåŠ¡åç§°):</span><br><span class="line">   ribbon:</span><br><span class="line">      NFLoadBBalancerRuleClassName: com.netflix.loadbalancer.RandonRule </span><br></pre></td></tr></table></figure><p>Ribboné»˜è®¤é‡‡ç”¨æ‡’åŠ è½½ï¼Œå³åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶é‡‡å–åˆ›å»ºLoadBalanceClient</p><p>é¥¥é¥¿åŠ è½½åˆ™ä¼šåœ¨é¡¹ç›®å¯åŠ¨æ—¶åˆ›å»ºï¼Œé™ä½ç¬¬ä¸€æ¬¡è®¿é—®çš„è€—æ—¶ï¼Œé€šè¿‡åœ¨æœåŠ¡è°ƒç”¨ç±»çš„é…ç½®æ–‡ä»¶æ·»åŠ é…ç½®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ribbon:</span><br><span class="line">  eager-load:</span><br><span class="line">    enabled: <span class="literal">true</span></span><br><span class="line">    clients: userservice  #æŒ‡å®šå¯¹æœåŠ¡åç§°ä¸ºuserserviceé¥¥é¥¿åŠ è½½</span><br></pre></td></tr></table></figure><h1 id="Nacosæ³¨å†Œä¸­å¿ƒ"><a href="#Nacosæ³¨å†Œä¸­å¿ƒ" class="headerlink" title="Nacosæ³¨å†Œä¸­å¿ƒ"></a>Nacosæ³¨å†Œä¸­å¿ƒ</h1><p>åœ¨nacosçš„binæ–‡ä»¶ç›®å½•ä¸‹å‘½ä»¤è¡Œè¾“å…¥ï¼š<code>startup.cmd -m standalone</code>å•æœºå¯åŠ¨nacos é»˜è®¤ç«¯å£8848</p><p>åœ¨çˆ¶å·¥ç¨‹ä¸­æ·»åŠ spring-cloud-alibabaç®¡ç†ä¾èµ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">2.2</span><span class="number">.5</span>.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">    &lt;scope&gt;<span class="keyword">import</span>&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åœ¨å®¢æˆ·ç«¯æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p><strong>å¦å¤–ï¼ŒNacos é›†ç¾¤é»˜è®¤é‡‡ç”¨APæ–¹å¼(å¯ç”¨æ€§)ï¼Œå½“é›†ç¾¤ä¸­å­˜åœ¨éä¸´æ—¶å®ä¾‹æ—¶ï¼Œé‡‡ç”¨CPæ¨¡å¼(ä¸€è‡´æ€§)ï¼›è€Œ Eureka é‡‡ç”¨APæ–¹å¼ï¼Œä¸å¯åˆ‡æ¢ã€‚</strong></p><h3 id="NacosæœåŠ¡åˆ†çº§å­˜å‚¨-æœåŠ¡â†’é›†ç¾¤â†’å®ä¾‹"><a href="#NacosæœåŠ¡åˆ†çº§å­˜å‚¨-æœåŠ¡â†’é›†ç¾¤â†’å®ä¾‹" class="headerlink" title="NacosæœåŠ¡åˆ†çº§å­˜å‚¨ æœåŠ¡â†’é›†ç¾¤â†’å®ä¾‹"></a>NacosæœåŠ¡åˆ†çº§å­˜å‚¨ æœåŠ¡â†’é›†ç¾¤â†’å®ä¾‹</h3><p>åœ¨å®¢æˆ·ç«¯æ·»åŠ nacosåœ°å€ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">springï¼š</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      server-addr: localhost:<span class="number">8848</span></span><br><span class="line">      discoveryï¼š</span><br><span class="line">        cluster-nameï¼šGuangZhou <span class="comment">//é…ç½®é›†ç¾¤åç§°</span></span><br></pre></td></tr></table></figure><p>é…ç½®è´Ÿè½½å‡è¡¡è§„åˆ™,ä¹Ÿæœ‰ä¸¤ç§æ–¹æ³•ï¼Œé…ç½®æ–‡ä»¶å’Œå®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> IRule <span class="title function_">iRule</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//é»˜è®¤ä¸ºè½®è¯¢è§„åˆ™ï¼Œè¿™é‡Œè‡ªå®šä¹‰ä¸ºéšæœºè§„åˆ™</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">NacosRule</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">userservice:      <span class="comment">//è¦åšé…ç½®çš„å¾®æœåŠ¡åç§°</span></span><br><span class="line">  ribbon:</span><br><span class="line">    NFLoadBalancerRuleClassName: com.alibaba.cloud.nacos.ribbon.NacosRule <span class="comment">//é›†ç¾¤ä¼˜å…ˆ ç„¶åéšæœº</span></span><br></pre></td></tr></table></figure><h3 id="Nacosæ§åˆ¶å°å¯ä»¥æ§åˆ¶å®ä¾‹çš„æƒé‡å€¼-0-1"><a href="#Nacosæ§åˆ¶å°å¯ä»¥æ§åˆ¶å®ä¾‹çš„æƒé‡å€¼-0-1" class="headerlink" title="Nacosæ§åˆ¶å°å¯ä»¥æ§åˆ¶å®ä¾‹çš„æƒé‡å€¼(0-1)"></a>Nacosæ§åˆ¶å°å¯ä»¥æ§åˆ¶å®ä¾‹çš„æƒé‡å€¼(0-1)</h3><h2 id="ç¯å¢ƒéš”ç¦»-namespace"><a href="#ç¯å¢ƒéš”ç¦»-namespace" class="headerlink" title="ç¯å¢ƒéš”ç¦»-namespace"></a>ç¯å¢ƒéš”ç¦»-namespace</h2><p>åœ¨Nacosæ§åˆ¶å°åˆ›å»ºnamespaceï¼Œç”¨æ¥éš”ç¦»ä¸åŒç¯å¢ƒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      server-addr: localhost:<span class="number">8848</span></span><br><span class="line">      discovery:</span><br><span class="line">        cluster-name: HZ</span><br><span class="line">        namespace: 492a7d5d-237b-46a1-a99a-fa8e98e4b0f9 # å‘½åç©ºé—´ID</span><br></pre></td></tr></table></figure><p>ä¸åŒnamespaceä¸‹çš„æœåŠ¡ä¸å¯è§</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220326152043273.png" alt="image-20220326152043273"></p><p>æœåŠ¡æ³¨å†Œåˆ°Naocsæ—¶ï¼Œå¯ä»¥é€‰æ‹©æ³¨å†Œä¸ºä¸´æ—¶æˆ–éä¸´æ—¶å®ä¾‹ï¼Œåœ¨é…ç½®æ–‡ä»¶æ·»åŠ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      discovery:</span><br><span class="line">        ephemeral: <span class="literal">false</span> /è®¾ç½®ä¸ºéä¸´æ—¶å®ä¾‹</span><br></pre></td></tr></table></figure><p>Nacos çš„æœåŠ¡å®ä¾‹åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><ul><li><p><strong>ä¸´æ—¶å®ä¾‹</strong>ï¼šå¦‚æœå®ä¾‹å®•æœºè¶…è¿‡ä¸€å®šæ—¶é—´ï¼Œä¼šä»æœåŠ¡åˆ—è¡¨å‰”é™¤ï¼Œ<strong>é»˜è®¤çš„ç±»å‹</strong>ã€‚</p></li><li><p>éä¸´æ—¶å®ä¾‹ï¼šå¦‚æœå®ä¾‹å®•æœºï¼Œä¸ä¼šä»æœåŠ¡åˆ—è¡¨å‰”é™¤ï¼Œä¹Ÿå¯ä»¥å«æ°¸ä¹…å®ä¾‹ã€‚</p></li></ul><h1 id="Nacosé…ç½®ç®¡ç†"><a href="#Nacosé…ç½®ç®¡ç†" class="headerlink" title="Nacosé…ç½®ç®¡ç†"></a>Nacosé…ç½®ç®¡ç†</h1><p>åœ¨nacosæ§åˆ¶å°æ–°å»ºé…ç½®(æ³¨æ„å‘½åç©ºé—´) æ ¼å¼ä¸º name-profile.yaml</p><p>æ·»åŠ nacosçš„configä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>nacos åœ°å€å¿…é¡»æ”¾åœ¨ä¼˜å…ˆçº§æœ€é«˜çš„ bootstrap.yml æ–‡ä»¶ã€‚</p><p>æ·»åŠ bootstrap.ymlï¼Œé…ç½®ï¼šæœåŠ¡åç§°ã€å¼€å‘ç¯å¢ƒã€æ–‡ä»¶åç¼€åï¼Œä¸‰è€…æŒ‡å®šåœ¨Nacosä¸­çš„é…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: userservice # æœåŠ¡åç§°</span><br><span class="line">  profiles:</span><br><span class="line">    active: dev #å¼€å‘ç¯å¢ƒï¼Œè¿™é‡Œæ˜¯dev </span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      server-addr: localhost:<span class="number">8848</span> # Nacosåœ°å€</span><br><span class="line">      config:</span><br><span class="line">        file-extension: yaml # æ–‡ä»¶åç¼€å</span><br></pre></td></tr></table></figure><h2 id="é…ç½®çƒ­æ›´æ–°"><a href="#é…ç½®çƒ­æ›´æ–°" class="headerlink" title="é…ç½®çƒ­æ›´æ–°"></a>é…ç½®çƒ­æ›´æ–°</h2><ul><li> æ–¹å¼ä¸€ï¼šåœ¨@Valueæ³¨å…¥çš„å˜é‡æ‰€åœ¨çš„ç±»ä¸Šæ·»åŠ æ³¨è§£@RefreshScope</li><li>æ–¹å¼äºŒï¼šæŠŠé…ç½®æ³¨å†Œåˆ°ä¸€ä¸ªBeanå¯¹è±¡é‡Œé¢<img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220328210934981.png" alt="image-20220328210934981"></li></ul><p>æ³¨æ„è¦å’Œé…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ä¸€ä¸€å¯¹åº”</p><h2 id="å¤šç¯å¢ƒé…ç½®å…±äº«"><a href="#å¤šç¯å¢ƒé…ç½®å…±äº«" class="headerlink" title="å¤šç¯å¢ƒé…ç½®å…±äº«"></a>å¤šç¯å¢ƒé…ç½®å…±äº«</h2><p>é€šè¿‡ä¸‹é¢çš„ä¸¤ç§æ–¹å¼æ¥æŒ‡å®šï¼š</p><ul><li><p>extension-configs</p></li><li><p>shared-configs</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring: </span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      config:</span><br><span class="line">        file-extension: yaml # æ–‡ä»¶åç¼€å</span><br><span class="line">        extends-configs: # å¤šå¾®æœåŠ¡é—´å…±äº«çš„é…ç½®åˆ—è¡¨</span><br><span class="line">          - dataId: common.yaml # è¦å…±äº«çš„é…ç½®æ–‡ä»¶id</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring: </span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      config:</span><br><span class="line">        file-extension: yaml # æ–‡ä»¶åç¼€å</span><br><span class="line">        shared-configs: # å¤šå¾®æœåŠ¡é—´å…±äº«çš„é…ç½®åˆ—è¡¨</span><br><span class="line">          - dataId: common.yaml # è¦å…±äº«çš„é…ç½®æ–‡ä»¶id</span><br></pre></td></tr></table></figure></li></ul><p>é…ç½®ä¼˜å…ˆçº§ï¼šæœåŠ¡å-profile.yamlâ†’æœåŠ¡å.yamlâ†’æœ¬åœ°é…ç½®</p><h1 id="Feignä»£æ›¿RestTemplateè¿œç¨‹è°ƒç”¨"><a href="#Feignä»£æ›¿RestTemplateè¿œç¨‹è°ƒç”¨" class="headerlink" title="Feignä»£æ›¿RestTemplateè¿œç¨‹è°ƒç”¨"></a>Feignä»£æ›¿RestTemplateè¿œç¨‹è°ƒç”¨</h1><p>å¼•å…¥ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è¦è¿›è¡Œè¿œç¨‹è°ƒç”¨çš„<strong>å¯åŠ¨ç±»</strong>æ·»åŠ æ³¨è§£</p><p><code>@EnableFeignClients</code></p><p>ç¼–å†™Feignå®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(&quot;userservice&quot;)</span> <span class="comment">//è¦è¿œç¨‹è°ƒç”¨çš„æœåŠ¡åç§°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserClient</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span> <span class="comment">//è¯·æ±‚çš„è·¯å¾„</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å®ç°ä¸šåŠ¡é€»è¾‘æ—¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserClient userClient;</span><br><span class="line"></span><br><span class="line">xxx</span><br><span class="line"></span><br><span class="line">userClient.findById(id); <span class="comment">//ç›´æ¥è°ƒç”¨æ¥å£é‡Œçš„æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p><strong>Feigné›†åˆäº†Ribbon ï¼Œé»˜è®¤å®ç°è´Ÿè½½å‡è¡¡</strong></p><h2 id><a href="#" class="headerlink" title></a></h2><h2 id="é…ç½®Feignæ—¥å¿—"><a href="#é…ç½®Feignæ—¥å¿—" class="headerlink" title="é…ç½®Feignæ—¥å¿—"></a>é…ç½®Feignæ—¥å¿—</h2><p>è€Œæ—¥å¿—çš„çº§åˆ«åˆ†ä¸ºå››ç§ï¼š</p><ul><li>NONEï¼šä¸è®°å½•ä»»ä½•æ—¥å¿—ä¿¡æ¯ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚</li><li>BASICï¼šä»…è®°å½•è¯·æ±‚çš„æ–¹æ³•ï¼ŒURLä»¥åŠå“åº”çŠ¶æ€ç å’Œæ‰§è¡Œæ—¶é—´</li><li>HEADERSï¼šåœ¨BASICçš„åŸºç¡€ä¸Šï¼Œé¢å¤–è®°å½•äº†è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯</li><li>FULLï¼šè®°å½•æ‰€æœ‰è¯·æ±‚å’Œå“åº”çš„æ˜ç»†ï¼ŒåŒ…æ‹¬å¤´ä¿¡æ¯ã€è¯·æ±‚ä½“ã€å…ƒæ•°æ®</li></ul><p>é…ç½®æ–‡ä»¶æ–¹å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">feign:</span><br><span class="line">  client:</span><br><span class="line">    config:</span><br><span class="line">      <span class="keyword">default</span>:       #<span class="keyword">default</span>é»˜è®¤ä¸ºå…¨å±€é…ç½®ï¼Œå¦‚æœå†™æœåŠ¡åç§°ï¼Œåˆ™é’ˆå¯¹è¯¥æœåŠ¡åç§°è¿›è¡Œé…ç½®</span><br><span class="line">        loggerLevel: BASIC #æ—¥å¿—çº§åˆ« none basic header full</span><br></pre></td></tr></table></figure><p>javaä»£ç æ–¹å¼ï¼Œé¦–å…ˆå£°æ˜ä¸€ä¸ªBeanï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignClientConfiguration</span> &#123;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="keyword">public</span> Logger.Level <span class="title function_">feignLogLevel</span><span class="params">()</span>&#123;</span><br><span class="line">          <span class="keyword">return</span> Logger.Level.BASIC;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¨å±€é…ç½®ï¼Œ<strong>å¯åŠ¨ç±»</strong>æ·»åŠ æ³¨é‡Š<code>@EnableFeignClients(defaultConfiguration = FeignClientConfiguration.class)</code></p><p>å±€éƒ¨é…ç½®ï¼Œ<strong>å¯åŠ¨ç±»</strong>æ·»åŠ æ³¨é‡Š<code>@FeignClient(value =&quot;æœåŠ¡åç§°&quot; ,configuration = FeignClientConfiguration)</code></p><h2 id="Feignçš„æ€§èƒ½ä¼˜åŒ–"><a href="#Feignçš„æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="Feignçš„æ€§èƒ½ä¼˜åŒ–"></a>Feignçš„æ€§èƒ½ä¼˜åŒ–</h2><p>Feignåº•å±‚çš„å®¢æˆ·ç«¯å®ç°ï¼š</p><ul><li><p>URLConnectionï¼šé»˜è®¤å®ç°ï¼Œä¸æ”¯æŒè¿æ¥æ± </p></li><li><p>Apache HeepClientï¼šæ”¯æŒè¿æ¥æ± </p></li><li><p>OKHttpï¼šæ”¯æŒè¿æ¥æ±  </p></li></ul><h3 id="Feignæ·»åŠ HttpClientçš„æ”¯æŒï¼š"><a href="#Feignæ·»åŠ HttpClientçš„æ”¯æŒï¼š" class="headerlink" title="Feignæ·»åŠ HttpClientçš„æ”¯æŒï¼š"></a>Feignæ·»åŠ HttpClientçš„æ”¯æŒï¼š</h3><p>æ·»åŠ ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.github.openfeign&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;feign-httpclient&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶é…ç½®è¿æ¥æ± ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">feign:</span><br><span class="line">  httpclient:</span><br><span class="line">    enable: <span class="literal">true</span> #å¼€å…³</span><br><span class="line">    max-connections: <span class="number">200</span>  #æœ€å¤§è¿æ¥æ•°</span><br><span class="line">    max-connections-per-route: <span class="number">50</span> #å•ä¸ªè·¯å¾„æœ€å¤§è¿æ¥æ•°    </span><br></pre></td></tr></table></figure><h2 id="æŠ½å–FeignClient"><a href="#æŠ½å–FeignClient" class="headerlink" title="æŠ½å–FeignClient"></a>æŠ½å–FeignClient</h2><p>åˆ›å»ºä¸€ä¸ªmoduleï¼Œfeign-apiï¼Œå¼•å…¥feignçš„ä¾èµ–</p><p>é‡Œé¢æœ‰clientã€pojoã€DefaultConfiguration(javaä»£ç å½¢å¼)</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220401201204884.png" alt="image-20220401201204884"></p><p>å½“å®šä¹‰çš„FeignClientä¸åœ¨<strong>SpringBootAplicationå¯åŠ¨ç±»</strong>çš„æ‰«æåŒ…èŒƒå›´æ—¶ï¼Œè¿™äº›FeignClientæ— æ³•ä½¿ç”¨</p><p>è§£å†³æ–¹æ³•ä¸€ï¼šæŒ‡å®šFeignClientæ‰€åœ¨åŒ…</p><p>å¯åŠ¨ç±»æ·»åŠ æ³¨è§£<code>@EnableFeignClients(basePackages = &quot;åŒ…å&quot;)</code></p><p>è§£å†³æ–¹æ³•äºŒï¼šæŒ‡å®šFeignClientå­—èŠ‚ç </p><p>å¯åŠ¨ç±»æ·»åŠ æ³¨è§£<code>@EnableFeignClients(clients =&#123;UserClient.class&#125;)</code></p><h1 id="ç»Ÿä¸€ç½‘å…³Gateway"><a href="#ç»Ÿä¸€ç½‘å…³Gateway" class="headerlink" title="ç»Ÿä¸€ç½‘å…³Gateway"></a>ç»Ÿä¸€ç½‘å…³Gateway</h1><p>ç½‘å…³åŠŸèƒ½ï¼š</p><ul><li>èº«ä»½éªŒè¯å’Œæƒé™æ ¡éªŒ</li><li>æœåŠ¡è·¯ç”±ã€è´Ÿè½½å‡è¡¡</li><li>è¯·æ±‚é™æµ</li></ul><p>åœ¨ SpringCloud ä¸­ç½‘å…³çš„å®ç°åŒ…æ‹¬ä¸¤ç§ï¼š</p><ul><li>gateway</li><li>zuul</li></ul><p>Zuul æ˜¯åŸºäº Servlet å®ç°ï¼Œå±äºé˜»å¡å¼ç¼–ç¨‹ã€‚è€Œ Spring Cloud Gateway åˆ™æ˜¯åŸºäº Spring5 ä¸­æä¾›çš„WebFluxï¼Œå±äºå“åº”å¼ç¼–ç¨‹çš„å®ç°ï¼Œå…·å¤‡æ›´å¥½çš„æ€§èƒ½ã€‚</p><p>æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--nacosæœåŠ¡æ³¨å†Œå‘ç°ä¾èµ–--&gt;</span><br><span class="line">     &lt;dependency&gt;</span><br><span class="line">         &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">         &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;</span><br><span class="line">     &lt;/dependency&gt;</span><br><span class="line">     &lt;!--ç½‘å…³gatewayä¾èµ–--&gt;</span><br><span class="line">     &lt;dependency&gt;</span><br><span class="line">         &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">         &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;</span><br><span class="line">     &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶ç¼–å†™è·¯ç”±é…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: gateway</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      server-addr: nacos:8848 # nacosåœ°å€</span><br><span class="line">    gateway:</span><br><span class="line">      routes:</span><br><span class="line">        - id: user-service # è·¯ç”±æ ‡ç¤ºï¼Œå¿…é¡»å”¯ä¸€</span><br><span class="line">          uri: lb://userservice # è·¯ç”±çš„ç›®æ ‡åœ°å€</span><br><span class="line">          predicates: # è·¯ç”±æ–­è¨€ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦ç¬¦åˆè§„åˆ™</span><br><span class="line">            - Path=/user/** # è·¯å¾„æ–­è¨€ï¼Œåˆ¤æ–­è·¯å¾„æ˜¯å¦æ˜¯ä»¥/userå¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™ç¬¦åˆ</span><br><span class="line">            - After=   #æ–­è¨€è§„åˆ™</span><br><span class="line">#         filters:     # è¿‡æ»¤å™¨ åªé’ˆå¯¹è¯¥è·¯ç”±</span><br><span class="line">        - id: order-service</span><br><span class="line">          uri: lb://orderservice</span><br><span class="line">          predicates:</span><br><span class="line">            - Path=/order/**</span><br><span class="line">#      default-filters:      #  é»˜è®¤è¿‡æ»¤å™¨,ä¼šå¯¹æ‰€æœ‰çš„è·¯ç”±è¯·æ±‚éƒ½ç”Ÿæ•ˆ</span><br><span class="line">#       - AddRequestHeader=Truth,Itcast is freaking awesome!</span><br></pre></td></tr></table></figure><p><img src="/2021/10/03/SpringCloud/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220420001323333.png" alt="image-20220420001323333"></p><h3 id="æ–­è¨€å·¥å‚"><a href="#æ–­è¨€å·¥å‚" class="headerlink" title="æ–­è¨€å·¥å‚"></a>æ–­è¨€å·¥å‚</h3><ul><li><p>åœ¨é…ç½®æ–‡ä»¶ä¸­å†™çš„æ–­è¨€è§„åˆ™åªæ˜¯å­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ç¬¦ä¸²ä¼šè¢«Predicate Factory(æ–­è¨€å·¥å‚)è¯»å–å¹¶å¤„ç†ï¼Œè½¬å˜ä¸ºè·¯ç”±åˆ¤æ–­çš„æ¡ä»¶</p></li><li><p>org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactoryç±»</p><p><img src="https://cdn.jsdelivr.net/gh/dullandmeanless/PicBed/img/image-20220407194237442.png" alt="image-20220407194237442"></p></li></ul><h2 id="è·¯ç”±è¿‡æ»¤å™¨GatewayFilter"><a href="#è·¯ç”±è¿‡æ»¤å™¨GatewayFilter" class="headerlink" title="è·¯ç”±è¿‡æ»¤å™¨GatewayFilter"></a>è·¯ç”±è¿‡æ»¤å™¨GatewayFilter</h2><p>å¯ä»¥å¯¹ç½‘å…³çš„è¯·æ±‚å’Œå¾®æœåŠ¡è¿”å›çš„å“åº”åšå¤„ç†</p><p>Springæä¾›äº†31ç§ä¸åŒçš„è·¯ç”±è¿‡æ»¤å™¨å·¥å‚,<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gatewayfilter-factories">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gatewayfilter-factories</a></p><p>å¦‚ä½•åœ¨é…ç½®æ–‡ä»¶é‡Œé…ç½®,å‚è€ƒä¸Šé¢çš„è·¯ç”±é…ç½®</p><h2 id="å…¨å±€è¿‡æ»¤å™¨GlobalFilter"><a href="#å…¨å±€è¿‡æ»¤å™¨GlobalFilter" class="headerlink" title="å…¨å±€è¿‡æ»¤å™¨GlobalFilter"></a>å…¨å±€è¿‡æ»¤å™¨GlobalFilter</h2><p>å¤„ç†ä¸€åˆ‡è¿›å…¥ç½‘å…³çš„è¯·æ±‚å’Œå¾®æœåŠ¡è¿”å›çš„å“åº”,GatewayFilteré€šè¿‡é…ç½®å®šä¹‰,GlobalFilterçš„é€»è¾‘éœ€è¦æ‰‹å†™ä»£ç å®ç°,å®šä¹‰æ–¹æ³•æ˜¯å®ç°GlobalFilteræ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilterChain;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GlobalFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.Ordered;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.reactive.ServerHttpRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.MultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.server.ServerWebExchange;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"><span class="comment">//orderè¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span></span><br><span class="line"><span class="comment">// @Order(-1)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthorizeFilter</span> <span class="keyword">implements</span> <span class="title class_">GlobalFilter</span>, Ordered &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–è¯·æ±‚å‚æ•°</span></span><br><span class="line">        <span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> exchange.getRequest();</span><br><span class="line">        MultiValueMap&lt;String, String&gt; params = request.getQueryParams();</span><br><span class="line">        <span class="comment">// 2.è·å–å‚æ•°ä¸­çš„ authorization å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">auth</span> <span class="operator">=</span> params.getFirst(<span class="string">&quot;authorization&quot;</span>);</span><br><span class="line">        <span class="comment">// 3.åˆ¤æ–­å‚æ•°å€¼æ˜¯å¦ç­‰äº admin</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;admin&quot;</span>.equals(auth)) &#123;</span><br><span class="line">            <span class="comment">// 4.æ˜¯ï¼Œæ”¾è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 5.å¦ï¼Œæ‹¦æˆª</span></span><br><span class="line">        <span class="comment">// 5.1.è®¾ç½®çŠ¶æ€ç </span></span><br><span class="line">        exchange.getResponse().setStatusCode(HttpStatus.UNAUTHORIZED);</span><br><span class="line">        <span class="comment">// 5.2.æ‹¦æˆªè¯·æ±‚</span></span><br><span class="line">        <span class="keyword">return</span> exchange.getResponse().setComplete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº</p><p>æ¯ä¸€ä¸ªè¿‡æ»¤å™¨éƒ½å¿…é¡»æŒ‡å®šä¸€ä¸ªintç±»å‹çš„orderå€¼,orderè¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</p><p>è·¯ç”±è¿‡æ»¤å™¨å’Œé»˜è®¤è¿‡æ»¤å™¨çš„orderç”±SpringæŒ‡å®š,é»˜è®¤æ˜¯æŒ‰ç…§å£°æ˜é¡ºåºä»1é€’å¢</p><p>å½“è¿‡æ»¤å™¨çš„orderå€¼ä¸€æ ·å€¼,ä¼šæŒ‰ç…§é»˜è®¤è¿‡æ»¤å™¨&gt;è·¯ç”±è¿‡æ»¤å™¨&gt;å…¨å±€è¿‡æ»¤å™¨çš„é¡ºåºæ‰§è¡Œ</p><h1 id="è·¨åŸŸé—®é¢˜å¤„ç†"><a href="#è·¨åŸŸé—®é¢˜å¤„ç†" class="headerlink" title="è·¨åŸŸé—®é¢˜å¤„ç†"></a>è·¨åŸŸé—®é¢˜å¤„ç†</h1><p>è·¨åŸŸé—®é¢˜:æµè§ˆå™¨ç¦æ­¢è¯·æ±‚çš„å‘èµ·è€…ä¸æœåŠ¡ç«¯å‘ç”Ÿè·¨åŸŸajaxè¯·æ±‚,è¯·æ±‚ä¼šè¢«æµè§ˆå™¨æ‹¦æˆª,å®ƒæ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ï¼Œæ˜¯æµè§ˆå™¨å¯¹javascriptæ–½åŠ çš„å®‰å…¨é™åˆ¶ã€‚</p><p>ä¾‹å¦‚ï¼šaé¡µé¢æƒ³è·å–bé¡µé¢èµ„æºï¼Œå¦‚æœaã€bé¡µé¢çš„åè®®ã€åŸŸåã€ç«¯å£ã€å­åŸŸåä¸åŒï¼Œæ‰€è¿›è¡Œçš„è®¿é—®è¡ŒåŠ¨éƒ½æ˜¯è·¨åŸŸçš„ï¼Œè€Œæµè§ˆå™¨ä¸ºäº†å®‰å…¨é—®é¢˜ä¸€èˆ¬éƒ½é™åˆ¶äº†è·¨åŸŸè®¿é—®ï¼Œä¹Ÿå°±æ˜¯ä¸å…è®¸è·¨åŸŸè¯·æ±‚èµ„æºã€‚æ³¨æ„ï¼šè·¨åŸŸé™åˆ¶è®¿é—®ï¼Œå…¶å®æ˜¯<strong>æµè§ˆå™¨çš„é™åˆ¶</strong>ã€‚ç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼ï¼</p><p> Gatewayç½‘å…³å¤„ç†è·¨åŸŸé‡‡ç”¨çš„åŒæ ·æ˜¯CORSæ–¹æ¡ˆ,å¹¶ä¸”åªéœ€è¦ç®€å•é…ç½®å³å¯å®ç°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    gateway:</span><br><span class="line">      globalcors:  # å…¨å±€çš„è·¨åŸŸå¤„ç†</span><br><span class="line">        add-to-simple-url-handler-mapping: true # è§£å†³optionè¯·æ±‚è¢«æ‹¦æˆªé—®é¢˜</span><br><span class="line">        cors-configurations:</span><br><span class="line">          &#x27;[/**]&#x27;:</span><br><span class="line">            allowedOrigins: #å…è®¸å“ªäº›ç½‘ç«™çš„è·¨åŸŸè¯·æ±‚</span><br><span class="line">              - &quot;http://www.baidu.com&quot;</span><br><span class="line">              - &quot;http://localhost:8090&quot;</span><br><span class="line">            allowedMethods: #å…è®¸çš„è·¨åŸŸajaxçš„è¯·æ±‚æ–¹å¼</span><br><span class="line">              - &quot;GET&quot;</span><br><span class="line">              - &quot;POST&quot;</span><br><span class="line">              - &quot;DELETE&quot;</span><br><span class="line">            allowedHeaders: &quot;*&quot; # å…è®¸åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦çš„ä¿¡æ¯</span><br><span class="line">            allowedCredentials: true # æ˜¯å¦å…è®¸æºå¸¦cookie</span><br><span class="line">            maxAge: 360000 #è¿™æ¬¡è·¨åŸŸæ£€æµ‹çš„æœ‰æ•ˆæœŸ</span><br></pre></td></tr></table></figure><h1 id="åŒæ­¥é€šè®¯å’Œå¼‚æ­¥é€šè®¯"><a href="#åŒæ­¥é€šè®¯å’Œå¼‚æ­¥é€šè®¯" class="headerlink" title="åŒæ­¥é€šè®¯å’Œå¼‚æ­¥é€šè®¯"></a>åŒæ­¥é€šè®¯å’Œå¼‚æ­¥é€šè®¯</h1><p><strong>å¾®æœåŠ¡é—´é€šè®¯æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ–¹å¼</strong></p><p>åŒæ­¥é€šè®¯ï¼šå°±åƒæ‰“ç”µè¯ï¼Œéœ€è¦å®æ—¶å“åº”ã€‚</p><p>å¼‚æ­¥é€šè®¯ï¼šå°±åƒå‘é‚®ä»¶ï¼Œä¸éœ€è¦é©¬ä¸Šå›å¤ã€‚</p><p>ä¹‹å‰å­¦ä¹ çš„ <strong>Feign è°ƒç”¨</strong>å°±å±äº<strong>åŒæ­¥æ–¹å¼</strong></p><p><strong>åŒæ­¥è°ƒç”¨çš„ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ—¶æ•ˆæ€§è¾ƒå¼ºï¼Œå¯ä»¥ç«‹å³å¾—åˆ°ç»“æœ</li></ul><p><strong>åŒæ­¥è°ƒç”¨çš„ç¼ºç‚¹ï¼š</strong></p><ul><li>è€¦åˆåº¦é«˜</li><li>æ€§èƒ½å’Œååèƒ½åŠ›ä¸‹é™</li><li>æœ‰é¢å¤–çš„èµ„æºæ¶ˆè€—</li><li>æœ‰çº§è”å¤±è´¥é—®é¢˜</li></ul><p>å¼‚æ­¥è°ƒç”¨åˆ™å¯ä»¥é¿å…ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬ä»¥è´­ä¹°å•†å“ä¸ºä¾‹ï¼Œç”¨æˆ·æ”¯ä»˜åéœ€è¦è°ƒç”¨è®¢å•æœåŠ¡å®Œæˆè®¢å•çŠ¶æ€ä¿®æ”¹ï¼Œè°ƒç”¨ç‰©æµæœåŠ¡ï¼Œä»ä»“åº“åˆ†é…å“åº”çš„åº“å­˜å¹¶å‡†å¤‡å‘è´§ã€‚åœ¨äº‹ä»¶æ¨¡å¼ä¸­ï¼Œæ”¯ä»˜æœåŠ¡æ˜¯äº‹ä»¶å‘å¸ƒè€…ï¼ˆpublisherï¼‰ï¼Œåœ¨æ”¯ä»˜å®Œæˆååªéœ€è¦å‘å¸ƒä¸€ä¸ªæ”¯ä»˜æˆåŠŸçš„äº‹ä»¶ï¼ˆeventï¼‰ï¼Œäº‹ä»¶ä¸­å¸¦ä¸Šè®¢å•idã€‚è®¢å•æœåŠ¡å’Œç‰©æµæœåŠ¡æ˜¯äº‹ä»¶è®¢é˜…è€…ï¼ˆConsumerï¼‰ï¼Œè®¢é˜…æ”¯ä»˜æˆåŠŸçš„äº‹ä»¶ï¼Œç›‘å¬åˆ°äº‹ä»¶åå®Œæˆè‡ªå·±ä¸šåŠ¡å³å¯ã€‚</p><p>ä¸ºäº†è§£é™¤äº‹ä»¶å‘å¸ƒè€…ä¸è®¢é˜…è€…ä¹‹é—´çš„è€¦åˆï¼Œä¸¤è€…å¹¶ä¸æ˜¯ç›´æ¥é€šä¿¡ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªä¸­é—´äººï¼ˆBrokerï¼‰ã€‚å‘å¸ƒè€…å‘å¸ƒäº‹ä»¶åˆ°Brokerï¼Œä¸å…³å¿ƒè°æ¥è®¢é˜…äº‹ä»¶ã€‚è®¢é˜…è€…ä»Brokerè®¢é˜…äº‹ä»¶ï¼Œä¸å…³å¿ƒè°å‘æ¥çš„æ¶ˆæ¯ã€‚</p><p><strong>å¼‚æ­¥è°ƒç”¨å¥½å¤„ï¼š</strong></p><ul><li>ååé‡æå‡ï¼šæ— éœ€ç­‰å¾…è®¢é˜…è€…å¤„ç†å®Œæˆï¼Œå“åº”æ›´å¿«é€Ÿ</li><li>æ•…éšœéš”ç¦»ï¼šæœåŠ¡æ²¡æœ‰ç›´æ¥è°ƒç”¨ï¼Œä¸å­˜åœ¨çº§è”å¤±è´¥é—®é¢˜</li><li>è°ƒç”¨é—´æ²¡æœ‰é˜»å¡ï¼Œä¸ä¼šé€ æˆæ— æ•ˆçš„èµ„æºå ç”¨</li><li>è€¦åˆåº¦æä½ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥çµæ´»æ’æ‹”ï¼Œå¯æ›¿æ¢</li><li>æµé‡å‰Šå³°ï¼šä¸ç®¡å‘å¸ƒäº‹ä»¶çš„æµé‡æ³¢åŠ¨å¤šå¤§ï¼Œéƒ½ç”± Broker æ¥æ”¶ï¼Œè®¢é˜…è€…å¯ä»¥æŒ‰ç…§è‡ªå·±çš„é€Ÿåº¦å»å¤„ç†äº‹ä»¶</li></ul><p><strong>å¼‚æ­¥è°ƒç”¨ç¼ºç‚¹ï¼š</strong></p><ul><li>æ¶æ„å¤æ‚äº†ï¼Œä¸šåŠ¡æ²¡æœ‰æ˜æ˜¾çš„æµç¨‹çº¿ï¼Œä¸å¥½ç®¡ç†</li><li>éœ€è¦ä¾èµ–äº Broker çš„å¯é ã€å®‰å…¨ã€æ€§èƒ½</li></ul><h2 id="RabbitMQæ¶ˆæ¯é˜Ÿåˆ—"><a href="#RabbitMQæ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="RabbitMQæ¶ˆæ¯é˜Ÿåˆ—"></a>RabbitMQæ¶ˆæ¯é˜Ÿåˆ—</h2><p>MQï¼Œä¸­æ–‡æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessageQueueï¼‰ï¼Œå­—é¢æ¥çœ‹å°±æ˜¯å­˜æ”¾æ¶ˆæ¯çš„é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯äº‹ä»¶é©±åŠ¨æ¶æ„ä¸­çš„ Broker</p><p>å‡ ç§å¸¸è§MQçš„å¯¹æ¯”ï¼š</p><table><thead><tr><th align="left"></th><th align="center"><strong>RabbitMQ</strong></th><th align="center"><strong>ActiveMQ</strong></th><th align="center"><strong>RocketMQ</strong></th><th align="center"><strong>Kafka</strong></th></tr></thead><tbody><tr><td align="left">å…¬å¸/ç¤¾åŒº</td><td align="center">Rabbit</td><td align="center">Apache</td><td align="center">é˜¿é‡Œ</td><td align="center">Apache</td></tr><tr><td align="left">å¼€å‘è¯­è¨€</td><td align="center">Erlang</td><td align="center">Java</td><td align="center">Java</td><td align="center">Scala&amp;Java</td></tr><tr><td align="left">åè®®æ”¯æŒ</td><td align="center">AMQPã€XMPPã€SMTPã€STOMP</td><td align="center">OpenWireã€STOMPã€RESTã€XMPPã€AMQP</td><td align="center">è‡ªå®šä¹‰åè®®</td><td align="center">è‡ªå®šä¹‰åè®®</td></tr><tr><td align="left">å¯ç”¨æ€§</td><td align="center">é«˜</td><td align="center">ä¸€èˆ¬</td><td align="center">é«˜</td><td align="center">é«˜</td></tr><tr><td align="left">å•æœºååé‡</td><td align="center">ä¸€èˆ¬</td><td align="center">å·®</td><td align="center">é«˜</td><td align="center">éå¸¸é«˜</td></tr><tr><td align="left">æ¶ˆæ¯å»¶è¿Ÿ</td><td align="center">å¾®ç§’çº§</td><td align="center">æ¯«ç§’çº§</td><td align="center">æ¯«ç§’çº§</td><td align="center">æ¯«ç§’ä»¥å†…</td></tr><tr><td align="left">æ¶ˆæ¯å¯é æ€§</td><td align="center">é«˜</td><td align="center">ä¸€èˆ¬</td><td align="center">é«˜</td><td align="center">ä¸€èˆ¬</td></tr></tbody></table><h1 id="Hystrix"><a href="#Hystrix" class="headerlink" title="Hystrix"></a>Hystrix</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.2.6.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@HystrixCommand(fallbackMethod = &quot;fallbackInfo&quot;)</span><br><span class="line">      public String findOrdersByUser(@PathVariable String id) &#123;</span><br><span class="line">            </span><br><span class="line">          &#125;</span><br><span class="line">      public String fallbackInfo(@PathVariable String id)&#123;</span><br><span class="line">    return &quot;æœåŠ¡ä¸å¯ç”¨ï¼Œè¯·ç¨åå†è¯•ï¼&quot;;</span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure><p> å¯åŠ¨ç±»æ·»åŠ æ³¨è§£@EnableCircuitBreaker</p>]]></content>
      
      
      
        <tags>
            
            <tag> Springã€Spring Cloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot å¼€å‘çŸ¥è¯†</title>
      <link href="/2021/10/03/SpringBoot-dev/"/>
      <url>/2021/10/03/SpringBoot-dev/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring Boot"></a>Spring Boot</h1><p>webç¯å¢ƒæ¨¡æ‹Ÿæµ‹è¯•</p><p>@SpringBootTest(webEnvironment = SrpingBootTest.Webvironment.***) å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ</p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220308145421445.png" alt="image-20220308145421445"></p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220308163200419.png" alt="image-20220308163200419"></p><p>ç”Ÿæˆéšæœºæ•°æ®</p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220308200357559.png" alt="image-20220308200357559"></p><p>@EnableCachingå¯ç”¨ç¼“å­˜</p><p>@Cacheable(value=â€â€,key=â€#â€)å°†å½“å‰æ•°æ®åŠ å…¥åˆ°ç¼“å­˜</p><p>Quartz</p><p>Quartzçš„é…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.MyQuartz;</span><br><span class="line"><span class="keyword">import</span> org.quartz.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuartzConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="comment">//å·¥ä½œæ˜ç»†</span></span><br><span class="line">    <span class="keyword">public</span> JobDetail <span class="title function_">jd</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//MyQuartzæ˜¯å…·ä½“å·¥ä½œ</span></span><br><span class="line">        <span class="keyword">return</span> JobBuilder.newJob(MyQuartz.class).storeDurably().build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="comment">//è§¦å‘å™¨å°†å·¥ä½œæ˜ç»†å’Œè°ƒåº¦å™¨ç»‘å®š </span></span><br><span class="line">    <span class="keyword">public</span> Trigger <span class="title function_">tri</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//è°ƒåº¦å™¨</span></span><br><span class="line">        ScheduleBuilder scheduleBuilder=CronScheduleBuilder.cronSchedule(<span class="string">&quot;0/5 * * * * ?&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> TriggerBuilder.newTrigger().forJob(jd()).withSchedule(scheduleBuilder).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Spring Task</p><p>@EnableScheduling å¼€å¯å®šæ—¶ä»»åŠ¡åŠŸèƒ½</p><p>åœ¨è¦æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„æ–¹æ³•ä¸Š@Scheduled(cron =â€â€)  åœ¨é…ç½®æ–‡ä»¶å¯ä»¥é…taskçš„ç›¸å…³é…ç½®</p><p>Spring Boot Admin ç›‘æ§</p><p>åœ¨Admin Serverä¸­çš„å¯åŠ¨ç±»é…ç½®@EnableAdminServer</p><p>å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶</p><p>management-endpoint-health-show-detailsï¼šalways</p><p>management-endpoint-ç«¯ç‚¹å-enabled-: t/fè®¾ç½®ç«¯ç‚¹å¯¹å¤–å¼€å‘ä¿¡æ¯</p><p>management-endpoints-web-exposure-include:â€*â€ å°†æ‰€æœ‰ç«¯ç‚¹æš´éœ²ç»™webç«¯</p><p>Admin ServeræœåŠ¡ç«¯é€šè¿‡actuatorä¸‹çš„å„ç§æ˜ å°„æ–¹æ³•è·å–ç«¯ç‚¹ä¿¡æ¯å¹¶å±•ç¤º</p><p>â€‹           jconsole</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ä¸ºinfoç«¯ç‚¹é…ç½®ä¿¡æ¯</p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220319153708822.png" alt="image-20220319153708822"></p><p>å†™ä¸€ä¸ªé…ç½®ç±»AppInfoContributorä¸ºinfoç«¯ç‚¹å¢æ·»æŒ‡æ ‡ä¿¡æ¯</p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220319153724076.png" alt="image-20220319153724076"></p><p>åŒç†ï¼Œå†™ä¸€ä¸ªé…ç½®ç±»AppHealthContributorä¸ºhealthç«¯ç‚¹å¢æ·»æŒ‡æ ‡ä¿¡æ¯</p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220319154526544.png" alt="image-20220319154526544"></p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220319160909206.png" alt="image-20220319160909206"></p><p>å³åœ¨è¿™æ·»åŠ å…·ä½“çš„ç›‘å¬</p><p><img src="/2021/10/03/SpringBoot-dev/Users\ZZW\AppData\Roaming\Typora\typora-user-images\image-20220319161116393.png" alt="image-20220319161116393"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot è¿ç»´çŸ¥è¯†</title>
      <link href="/2021/09/28/SpringBoot-om/"/>
      <url>/2021/09/28/SpringBoot-om/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Spring BootåŸºç¡€çŸ¥è¯†</title>
      <link href="/2021/09/26/SpringBoot-basic/"/>
      <url>/2021/09/26/SpringBoot-basic/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBootâ€”WebMvcConfigurerè¯¦è§£"><a href="#SpringBootâ€”WebMvcConfigurerè¯¦è§£" class="headerlink" title="SpringBootâ€”WebMvcConfigurerè¯¦è§£"></a>SpringBootâ€”WebMvcConfigurerè¯¦è§£</h1><h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><p>WebMvcConfigureré…ç½®ç±»å…¶å®æ˜¯<code>Spring</code>å†…éƒ¨çš„ä¸€ç§é…ç½®æ–¹å¼ï¼Œé‡‡ç”¨JavaBeançš„å½¢å¼æ¥ä»£æ›¿ä¼ ç»Ÿçš„<code>xml</code>é…ç½®æ–‡ä»¶å½¢å¼è¿›è¡Œé’ˆå¯¹æ¡†æ¶ä¸ªæ€§åŒ–å®šåˆ¶ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸€äº›Handlerï¼ŒInterceptor(æ‹¦æˆªå™¨)ï¼ŒViewResolver(è§†å›¾è§£æå™¨)ï¼ŒMessageConverterã€‚åŸºäºjava-basedæ–¹å¼çš„spring <a href="https://so.csdn.net/so/search?q=mvc&spm=1001.2101.3001.7020">mvc</a>é…ç½®ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª<strong>é…ç½®</strong>ç±»å¹¶å®ç°**<code>WebMvcConfigurer</code>** æ¥å£ï¼›æ–¹å¼ä¸€å®ç°WebMvcConfigureræ¥å£ï¼ˆæ¨èï¼‰ï¼Œæ–¹å¼äºŒç»§æ‰¿WebMvcConfigurationSupportç±»ï¼Œå…·ä½“å®ç°å¯çœ‹è¿™ç¯‡æ–‡ç« ã€‚<a href="https://blog.csdn.net/fmwind/article/details/82832758">https://blog.csdn.net/fmwind/article/details/82832758</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Javaç¬”è®°</title>
      <link href="/2021/09/23/java/"/>
      <url>/2021/09/23/java/</url>
      
        <content type="html"><![CDATA[<p>CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ<a href="https://baike.baidu.com/item/%E4%B8%80%E8%87%B4%E6%80%A7/9840083">ä¸€è‡´æ€§</a>ï¼ˆConsistencyï¼‰ã€<a href="https://baike.baidu.com/item/%E5%8F%AF%E7%94%A8%E6%80%A7/109628">å¯ç”¨æ€§</a>ï¼ˆAvailabilityï¼‰ã€<a href="https://baike.baidu.com/item/%E5%88%86%E5%8C%BA%E5%AE%B9%E9%94%99%E6%80%A7/23734073">åˆ†åŒºå®¹é”™æ€§</a>ï¼ˆPartition toleranceï¼‰ã€‚CAP åŸåˆ™æŒ‡çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ª<a href="https://baike.baidu.com/item/%E8%A6%81%E7%B4%A0/5261200">è¦ç´ </a>æœ€å¤šåªèƒ½åŒæ—¶å®ç°ä¸¤ç‚¹ï¼Œä¸å¯èƒ½ä¸‰è€…å…¼é¡¾ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HexoBlogå»ºç«™æµç¨‹</title>
      <link href="/2021/09/21/HexoBlog/"/>
      <url>/2021/09/21/HexoBlog/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo-GitHub-æ­å»ºä¸ªäººåšå®¢"><a href="#Hexo-GitHub-æ­å»ºä¸ªäººåšå®¢" class="headerlink" title="Hexo+GitHub æ­å»ºä¸ªäººåšå®¢"></a>Hexo+GitHub æ­å»ºä¸ªäººåšå®¢</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><ul><li>æœ€è¿‘çœ‹åˆ°äº†åŒå­¦å†™çš„ä¸ªäººç½‘ç«™<a href="https://magidrag0n.github.io/">https://magidrag0n.github.io/</a>  ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ„æ€ï¼Œä¾¿æ‰“ç®—è‡ªå·±ä¹Ÿå¼„ä¸€ä¸ªç©ç©ï¼Œè™½ç„¶å‚è€ƒäº†åŒå­¦å†™çš„æ•™ç¨‹<a href="https://magidrag0n.github.io/2020/07/16/HexoBlog-OnlineInTen/">https://magidrag0n.github.io/2020/07/16/HexoBlog-OnlineInTen/</a>   å’Œç½‘ä¸Šçš„æ•™ç¨‹ï¼Œä½†è¿˜æ˜¯è¸©äº†ä¸å°‘é›·ï¼Œè¿™é‡Œå†æ€»ç»“ä¸€ä¸‹æ•™ç¨‹ï¼Œæé†’è‡ªå·±ä¹Ÿæ–¹ä¾¿ä¸‹å¤§å®¶ã€‚</li></ul><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="GitHub-Pages-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#GitHub-Pages-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="GitHub Pages æ˜¯ä»€ä¹ˆï¼Ÿ"></a>GitHub Pages æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li><a href="https://link.zhihu.com/?target=https://help.github.com/en/articles/what-is-github-pages">What is GitHub Pages? - GitHub Help</a></li></ul><p>GitHub Pages æ˜¯ç”± GitHub å®˜æ–¹æä¾›çš„ä¸€ç§å…è´¹çš„é™æ€ç«™ç‚¹æ‰˜ç®¡æœåŠ¡ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨ GitHub ä»“åº“é‡Œæ‰˜ç®¡å’Œå‘å¸ƒè‡ªå·±çš„é™æ€ç½‘ç«™é¡µé¢ã€‚</p><h3 id="Hexo-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Hexo-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Hexo æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Hexo æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>å®˜ç½‘ï¼š<a href="https://link.zhihu.com/?target=https://hexo.io/zh-cn/">hexo.io</a></li></ul><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„é™æ€åšå®¢æ¡†æ¶ï¼Œå®ƒåŸºäº Node.js è¿è¡Œï¼Œå¯ä»¥å°†æˆ‘ä»¬æ’°å†™çš„ Markdown æ–‡æ¡£è§£ææ¸²æŸ“æˆé™æ€çš„ HTML ç½‘é¡µã€‚</p><h3 id="Hexo-GitHub-æ–‡ç« å‘å¸ƒåŸç†"><a href="#Hexo-GitHub-æ–‡ç« å‘å¸ƒåŸç†" class="headerlink" title="Hexo + GitHub æ–‡ç« å‘å¸ƒåŸç†"></a>Hexo + GitHub æ–‡ç« å‘å¸ƒåŸç†</h3><p>åœ¨æœ¬åœ°æ’°å†™ Markdown æ ¼å¼æ–‡ç« åï¼Œé€šè¿‡ Hexo è§£ææ–‡æ¡£ï¼Œæ¸²æŸ“ç”Ÿæˆå…·æœ‰ä¸»é¢˜æ ·å¼çš„ HTML é™æ€ç½‘é¡µï¼Œå†æ¨é€åˆ° GitHub ä¸Šå®Œæˆåšæ–‡çš„å‘å¸ƒã€‚</p><h3 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h3><p>Node.jsæ˜¯ä¸€ä¸ªè®©JavaScriptè¿è¡Œåœ¨æœåŠ¡ç«¯çš„å¼€å‘å¹³å°,ç”¨å®ƒå¯ä»¥æ–¹ä¾¿åœ°æ­å»ºå“åº”é€Ÿåº¦å¿«ã€æ˜“äºæ‰©å±•çš„ç½‘ç»œåº”ç”¨</p><h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><p>npm(Node Package Manager)å…¶å®å°±æ˜¯åŒ…ç®¡ç†å·¥å…·ï¼Œå¯¹Node.jsä¾èµ–çš„åŒ…è¿›è¡Œç®¡ç†ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºç”¨æ¥å®‰è£…/å¸è½½Node.jséœ€è¦è£…çš„ä¸œè¥¿ã€‚</p><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><ul><li><p>éœ€è¦ç”¨åˆ°Githubè´¦å·ã€node.jsã€npm</p></li><li><p>æ–°ç‰ˆçš„Node.jså·²è‡ªå¸¦npm</p><p>å®‰è£…å®Œæ¯•ååœ¨å‘½ä»¤è¡Œè¾“å…¥:node -vï¼Œæ£€æŸ¥æ˜¯å¦æˆåŠŸå®‰è£…ã€å‘½ä»¤è¡Œä¸­è¾“å…¥ npm -vï¼Œæ£€æŸ¥ npm åŒ…ç®¡ç†å™¨æ˜¯å¦å­˜åœ¨</p><p>å¦‚æœæ˜¾ç¤ºâ€™xxxâ€™ ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶æ—¶ã€‚è¯·å°†node.jsåŠ å…¥ç³»ç»Ÿå˜é‡ï¼Œæˆ–ç›´æ¥åœ¨å‘½ä»¤å‰åŠ ä¸Šnpxï¼Œnpx çš„åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯è¿è¡Œçš„æ—¶å€™ï¼Œä¼šåˆ°<code>node_modules/.bin</code>è·¯å¾„å’Œç¯å¢ƒå˜é‡<code>$PATH</code>é‡Œé¢ï¼Œæ£€æŸ¥å‘½ä»¤æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœæ¨¡å—å­˜åœ¨ï¼Œå°±ä½¿ç”¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¸´æ—¶ä¸‹è½½ï¼Œç”¨å®Œå°±åˆ é™¤ã€‚</p></li><li><p>å®‰è£…hexoåšå®¢æ¡†æ¶</p><p>é¦–å…ˆå°†å‘½ä»¤è¡Œå½“å‰æ–‡ä»¶å¤¹åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°çš„ç©ºæ–‡ä»¶å¤¹ (ä¸å»ºè®®ä¸­æ–‡) å½“ä¸­</p><p>ç„¶ååœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š<code>npm install -g hexo-cli</code></p></li><li><p>å®‰è£… Git æ¨é€å¥—ä»¶ï¼š</p><p>åœ¨ä½ åˆ›å¥½çš„æ”¾hexoæ¡†æ¶çš„æ–‡ä»¶å¤¹ä¸­æ‰“å¼€cmd(æ²¡ç‰¹åˆ«è¯´æ˜åæ–‡çš„æ‰€æœ‰æŒ‡ä»¤éƒ½æ˜¯åœ¨æ­¤è·¯å¾„æ‰§è¡Œ)ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥:<code>npm install --save hexo-deployer-git</code>ã€‚Tipsï¼šå®‰è£…å®Œæˆåä¼šæœ‰ä¸€é¡¹ Warning æé†’ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæ•¬è¯·å¿½ç•¥</p></li><li><h3 id="å¿«é€Ÿå¼€å§‹ï¼š"><a href="#å¿«é€Ÿå¼€å§‹ï¼š" class="headerlink" title="å¿«é€Ÿå¼€å§‹ï¼š"></a>å¿«é€Ÿå¼€å§‹ï¼š</h3><p>å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š</p><p><code>hexo init</code>  (æŠ¥é”™è¯·å°è¯•åœ¨å‰é¢åŠ npxï¼Œåé¢æ‰€æœ‰å…³äºhexoçš„å‘½ä»¤éƒ½å¯ä»¥åŠ npx)</p><p>æ­¤æ­¥éª¤ä¼šè‡ªåŠ¨å…‹éš†ä¸€ä¸ª Landscape çš„ä¸»é¢˜åšå®¢ï¼Œå¹¶ä¸”ä½ å°†åœ¨ä½ çš„åšå®¢ç›®å½•ä¸‹çœ‹åˆ°è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶</p><p>æ–°å»ºå®Œæˆåï¼ŒæŒ‡å®šæ–‡ä»¶å¤¹ç›®å½•ä¸‹æœ‰ï¼š</p><ul><li>node_modules: ä¾èµ–åŒ…</li><li>publicï¼šå­˜æ”¾ç”Ÿæˆçš„é¡µé¢</li><li>scaffoldsï¼šç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿</li><li>sourceï¼šç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç« </li><li>themesï¼šä¸»é¢˜</li><li>_config.yml: åšå®¢çš„é…ç½®æ–‡ä»¶</li></ul></li><li><h3 id="å¯åŠ¨æœ¬åœ°åšå®¢æœåŠ¡å™¨ï¼š"><a href="#å¯åŠ¨æœ¬åœ°åšå®¢æœåŠ¡å™¨ï¼š" class="headerlink" title="å¯åŠ¨æœ¬åœ°åšå®¢æœåŠ¡å™¨ï¼š"></a>å¯åŠ¨æœ¬åœ°åšå®¢æœåŠ¡å™¨ï¼š</h3><p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š</p><p><code>hexo generate</code>  # ç”Ÿæˆé™æ€é¡µé¢ï¼Œå¯ä»¥ç”¨hexo gç¼©å†™</p><p><code>hexo server</code>  # å¯åŠ¨é¢„è§ˆï¼Œå¯ä»¥ç”¨hexo sç¼©å†™</p><p>å°†ä¼šæç¤ºä½ ï¼š</p><p><code>INFO Start processing.</code><br><code>INFO Hexo is running at http://localhost:4000.Press Ctrl+C to stop.</code></p><p>è¡¨ç¤ºæˆ‘ä»¬çš„åšå®¢å·²ç»éƒ¨ç½²åˆ°æœ¬åœ°æœåŠ¡å™¨ä¸Šäº†ï¼Œæ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <a href="http://localhost:4000/">http://localhost:4000</a> ä¾¿å¯æŸ¥çœ‹ä½ çš„åšå®¢ï¼</p><p><img src="/2021/09/21/HexoBlog/3.jpg"></p><p>å…¶ä¸­çš„è‡ªå¸¦çš„åšæ–‡åŒ…å«äº†ä¸€äº›ç®€æ˜“çš„æ“ä½œæŒ‡ä»¤ä¸è®²è§£</p><p><strong>Tipsï¼š</strong>å¦‚æœå‡ºç°é¡µé¢åŠ è½½ä¸å‡ºæ¥ï¼Œå¯èƒ½æ˜¯ç«¯å£è¢«å ç”¨äº†ã€‚Ctrl+C å…³é—­æœåŠ¡å™¨ï¼Œè¿è¡Œ <code>hexo s -p 5000</code> æ›´æ”¹ç«¯å£å·åé‡è¯•ã€‚</p><h2 id="Hexo-çš„-Github-ä¸Šçº¿"><a href="#Hexo-çš„-Github-ä¸Šçº¿" class="headerlink" title="Hexo çš„ Github ä¸Šçº¿"></a>Hexo çš„ Github ä¸Šçº¿</h2><p>åˆšæ‰å»ºç«‹çš„ç½‘ç«™åªèƒ½åœ¨æœ¬åœ°æœåŠ¡å™¨ä¸­æŸ¥çœ‹ï¼Œå³ä¾¿æ‹¿å‡ºæ‰‹æœºè¾“å…¥ç›¸åŒç½‘å€äº¦æ˜¯ä¸èƒ½æŸ¥çœ‹çš„ã€‚æˆ‘ä»¬éœ€è¦è®©å¥½æœ‹å‹ä»¬çœ‹åˆ°æˆ‘ä»¬çš„ç½‘ç«™ï¼Œå°±éœ€è¦å°†åšå®¢æœåŠ¡å™¨ä»æœ¬åœ°å±€åŸŸæœåŠ¡å™¨æ¨é€åˆ°äº‘ç«¯æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨GitHub Pagesæ¥å®Œæˆï¼Œè®©æ‰€æœ‰äººéƒ½å¯ä»¥è®¿é—®ã€‚</p><ul><li><p>ä½¿ç”¨ä½ åˆšæ‰åˆ›å»ºçš„Githubè´¦æˆ·ï¼Œåœ¨ä¸»é¡µå³ä¸Šè§’æ‰¾åˆ°æ–°å»ºé¡¹ç›®<strong>New repository</strong></p><p><img src="https://cdn.jsdelivr.net/gh/MagiDrag0n/PicBed/img/guide1.png"></p><p>å¹¶å»ºç«‹ä¸€ä¸ªä¸ä½ åç§°ç›¸åŒå‰ç¼€çš„é¡¹ç›®å**(YourName.github.io)**</p><p>æ­¤å¤„å› ä¸ºæˆ‘å·²ç»åˆ›å»ºè¿‡æ‰€ä»¥ä¸èƒ½é‡å¤åˆ›å»ºï¼Œä½ å¯ç›´æ¥ç‚¹ <strong>Create repository</strong></p><p><img src="https://cdn.jsdelivr.net/gh/MagiDrag0n/PicBed/img/guide2.png"></p><p><img src="/2021/09/21/HexoBlog/2.png"></p><p>åœ¨åˆ›å»ºå¥½çš„ä»“åº“ä¸­ç‚¹å‡»Settingsï¼Œé€‰æ‹©Pagesï¼Œåœ¨Sourceä¸‹å¯ä»¥é€‰æ‹©ä½ Github Pagesæ‰€éœ€çš„èµ„æºä»å“ªé‡Œæ¥ã€‚æ³¨:å¦‚æœä¿®æ”¹æˆmainï¼Œåœ¨_config.ymlæ–‡ä»¶æœ«ç«¯è¦åŒæ­¥ä¿®æ”¹æˆbranch: mainã€‚</p></li><li><h3 id="é…ç½®Gitæ¨é€å¥—ä»¶"><a href="#é…ç½®Gitæ¨é€å¥—ä»¶" class="headerlink" title="é…ç½®Gitæ¨é€å¥—ä»¶"></a>é…ç½®Gitæ¨é€å¥—ä»¶</h3><p>æ‰“å¼€ä½ åˆ›å»ºçš„åšå®¢ç›®å½•æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°_config.ymlè¿™ä¸ªæ–‡ä»¶å¹¶æ‰“å¼€ç¼–è¾‘</p><p><img src="https://cdn.jsdelivr.net/gh/MagiDrag0n/PicBed/img/guide3.png"></p><p>åœ¨ä»£ç æœ«å°¾æ·»åŠ ï¼š</p><p><code>deploy:</code></p><p> <code>type: &#39;git&#39;</code></p><p> <code>repo: &quot;https://github.com/ä½ çš„åå­—/ä½ çš„åå­—.github.io.git&quot;</code></p><p> <code>branch: &quot;master&quot;</code></p><p><img src="https://cdn.jsdelivr.net/gh/MagiDrag0n/PicBed/img/guide4.png"></p><p>è‡³æ­¤Gitæ¨é€å¥—ä»¶å·²å‡†å¤‡å°±ç»ª</p><p>gitæœ‰æ—¶ä¼šæŠ½é£ï¼Œä¸Šä¼ ä¸åˆ°masteråˆ†æ”¯ï¼Œå¯ä»¥æ¢æˆmainåˆ†æ”¯ï¼Œå†ä¿®æ”¹GitHub Pagesä¸­çš„å¯¹åº”å†…å®¹</p></li></ul></li><li><p>ç¬¬ä¸€æ¬¡ä½¿ç”¨GItè¦å…ˆåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š</p><p><code>git config --global user.email &quot;you@example.com&quot;</code>  (ä½ çš„Githubé‚®ç®±)<br><code>git config --global user.name &quot;Your Name&quot;</code>  (ä½ çš„Githubåç§°)</p><p>ç„¶åè¾“å…¥<code>hexo deploy</code> éƒ¨ç½²æ–‡ç« ï¼Œä¹Ÿå¯ä»¥ç”¨ç¼©å†™hexo d</p><p>æ­¤æ—¶ä¼šå“—å•¦å•¦æµæ·Œä¸€è¡Œè¡Œæç¤ºï¼Œå¹¶ä¼šè®©ä½ è¾“å…¥ä½ çš„Githubåç§°ä¸å¯†ç </p><p>å½“æç¤ºç»“æŸæ—¶ï¼Œä¾¿å¯è¿›å…¥ç½‘é¡µ ä½ çš„åç§°.github.io æŸ¥çœ‹ä½ çš„åšå®¢å•¦ï¼</p><p>å¦‚æœè¾“å…¥hexo dæŠ¥é”™ï¼Œæœ‰å¯èƒ½æ˜¯å½“å‰ç½‘ç»œé“¾æ¥ä¸å¤ªå¥½ï¼Œå¯ä»¥å¤šè¯•å‡ æ¬¡å’Œæ¸…é™¤ä»£ç†æˆ–ç¿»å¢™</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><ul><li><h3 id="åšå®¢å†…å®¹çš„å€¡è®®"><a href="#åšå®¢å†…å®¹çš„å€¡è®®" class="headerlink" title="åšå®¢å†…å®¹çš„å€¡è®®"></a>åšå®¢å†…å®¹çš„å€¡è®®</h3></li></ul><p>ä¸èƒ½ä¼ æ’­å±å®³å›½å®¶å®‰å…¨ï¼Œæ³„éœ²å›½å®¶ç§˜å¯†ï¼Œé¢ è¦†å›½å®¶æ”¿æƒï¼Œç ´åå›½å®¶ç»Ÿä¸€çš„å†…å®¹ã€‚</p><p>ä¸èƒ½æ•£å¸ƒè°£è¨€ï¼Œæ‰°ä¹±ç¤¾ä¼šç§©åºï¼Œç ´åç¤¾ä¼šç¨³å®šã€‚</p><p>ä¸èƒ½æ•£å¸ƒæ·«ç§½ã€è‰²æƒ…ã€èµŒåšã€æš´åŠ›ã€å‡¶æ€ã€ææ€–æˆ–è€…æ•™å”†çŠ¯ç½ªã€‚</p><p>ä¸èƒ½ä¾®è¾±æˆ–è€…è¯½è°¤ä»–äººï¼Œä¾µå®³ä»–äººåˆæ³•æƒç›Šã€‚</p><p>â€”â€”ã€Šäº’è”ç½‘ä¿¡æ¯æœåŠ¡ç®¡ç†åŠæ³•ã€‹èŠ‚é€‰</p><h4 id="æˆ‘ä»¬è¦çº¦æŸè‡ªå·±çš„è¡Œä¸ºï¼Œå› ä¸ºè¿™å…³ä¹æ‰€æœ‰äººçš„äº’è”ç½‘è‡ªç”±ã€‚"><a href="#æˆ‘ä»¬è¦çº¦æŸè‡ªå·±çš„è¡Œä¸ºï¼Œå› ä¸ºè¿™å…³ä¹æ‰€æœ‰äººçš„äº’è”ç½‘è‡ªç”±ã€‚" class="headerlink" title="æˆ‘ä»¬è¦çº¦æŸè‡ªå·±çš„è¡Œä¸ºï¼Œå› ä¸ºè¿™å…³ä¹æ‰€æœ‰äººçš„äº’è”ç½‘è‡ªç”±ã€‚"></a><strong>æˆ‘ä»¬è¦çº¦æŸè‡ªå·±çš„è¡Œä¸ºï¼Œå› ä¸ºè¿™å…³ä¹æ‰€æœ‰äººçš„äº’è”ç½‘è‡ªç”±ã€‚</strong></h4><ul><li><h3 id="åšå®¢è®¿é—®åœ°å€"><a href="#åšå®¢è®¿é—®åœ°å€" class="headerlink" title="åšå®¢è®¿é—®åœ°å€"></a>åšå®¢è®¿é—®åœ°å€</h3><p><a href="https://localhost:4000/">https://localhost:4000</a>  (æœ¬åœ°æœåŠ¡å™¨å¼€å¯å¯è®¿é—®)</p><p><a href>YourName.github.io</a>  (éšæ—¶éšåœ°è®¿é—®æœ€è¿‘ä¸€æ¬¡æ¨é€ç‰ˆæœ¬çš„åšå®¢)</p></li><li><h3 id="å¸¸ç”¨HexoæŒ‡ä»¤"><a href="#å¸¸ç”¨HexoæŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨HexoæŒ‡ä»¤"></a>å¸¸ç”¨HexoæŒ‡ä»¤</h3><p><code>hexo clean</code>  (æ¸…é™¤ç¼“å­˜)</p><p><code>hexo g</code>  (è¿­ä»£åšå®¢å†…å®¹ï¼Œæ¯æ¬¡ç¼–è¾‘åæ“ä½œ)</p><p><code>hexo d</code>  (æ¨é€è‡³githubæœåŠ¡å™¨)</p><p><code>hexo new page &quot;XXX&quot;</code>  (æ–°å»ºä¸€ä¸ªåä¸ºXXXçš„é¡µé¢)</p><p><code>hexo new &quot;title&quot;</code>  (æ–°å»ºä¸€ä¸ªåä¸ºtitleçš„æ–‡ç« )</p></li></ul></li></ul>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
